import{a as j,u as d,A as i,h as u,c as z,r as h,l as R,j as l,I as L,B as V,n as J,T as K,i as M,o as Q}from"./index-Cux8sda1.js";import{M as W}from"./modal-BR27MEf1.js";import{F as X}from"./form-C3mZZqBW.js";import{A as Y}from"./workerSelect-N9ju4zO7.js";import"./seq-BPRV6kik.js";import{o as Z}from"./alertSlice-XeBTN8B3.js";import"./constsMonthList-CnI754jh.js";import{u as ss}from"./index.esm-DQmSsb0O.js";const k=j("classSlice/createClassType",async a=>{const{request:s}=d();return await s(`${i}Class/class_types/`,"POST",JSON.stringify(a),u())}),q=j("classSlice/getClassTypes",async a=>{const{request:s}=d();return await s(`${i}Class/class_types/?branch=${a}`,"GET",null,u())}),D=j("classSlice/updateClassType",async({id:a,data:s})=>{const{request:e}=d();return await e(`${i}Class/class_types/${a}/`,"PATCH",JSON.stringify(s),u())}),E=j("classSlice/getClassTypeNumber",async a=>{const{request:s}=d();return await s(`${i}Class/class_number_list/`,"GET",null,u())}),B=j("classSlice/classItem",async({id:a,branchId:s})=>{const{request:e}=d();return await e(`${i}Class/class_number/${a}/?branch=${s}`,"GET",null,u())}),$=j("classSlice/updateClassItem",async({idClass:a,res:s})=>{const{request:e}=d();return await e(`${i}Class/class_number_update/${a}/`,"PUT",JSON.stringify(s),u())}),A=j("classSlice/createColor",async a=>{const{request:s}=d();return await s(`${i}Class/class_colors/`,"POST",JSON.stringify(a),u())}),O=j("classSlice/getColor",async()=>{const{request:a}=d();return await a(`${i}Class/class_colors/`,"GET",null,u())}),P=j("classSlice/updateColor",async({id:a,res:s})=>{const{request:e}=d();return await e(`${i}Class/class_colors/${a}/`,"PATCH",JSON.stringify(s),u())}),G=j("classSlice/fetchClassSubjects",async()=>{const{request:a}=d();return await a(`${i}Subjects/subject/`,"GET",null,u())}),F=j("classSlice/getClassNewNumberList",async({branchId:a,id:s})=>{const{request:e}=d();return await e(`${i}Class/class_number_subject_list?branch=${a}&id=${s}`,"GET",null,u())}),es={loading:!1,error:!1,classData:[],classTypeNumber:[],classItems:[],color:[],subjects:[],classNewItems:[]},U=z({name:"classSlice",initialState:es,reducers:{onDelete:(a,s)=>{a.color=a.color.filter(e=>e.id!==s.payload.id)},onDeleteTypes:(a,s)=>{a.classData=a.classData.filter(e=>e.id!==s.payload.id)},onChangeClassStatus:(a,s)=>{a.classNewItems=a.classNewItems.map(e=>e.id===s.payload.id?{...e,status:!e.status}:e)},onUpdateClass:(a,s)=>{a.classItems=a.classItems.map(e=>e.id===s.payload.id?{...e,price:s.payload.price,curriculum_hours:s.payload.curriculum_hours,subjects:s.payload.subjects}:e)}},extraReducers:a=>a.addCase(q.pending,s=>{s.loading=!0,s.error=!1}).addCase(q.fulfilled,(s,e)=>{s.classData=e.payload,s.loading=!1,s.error=!1}).addCase(q.rejected,s=>{s.error=!0,s.loading=!1}).addCase(k.pending,s=>{s.loading=!0,s.error=!1}).addCase(k.fulfilled,(s,e)=>{s.classData=[...s.classData,e.payload],s.loading=!1,s.error=!1}).addCase(k.rejected,s=>{s.error=!0,s.loading=!1}).addCase(D.pending,s=>{s.loading=!0,s.error=!1}).addCase(D.fulfilled,(s,e)=>{s.classData=[...s.classData.filter(o=>o.id!==e.payload.id),e.payload],s.loading=!1,s.error=!1}).addCase(D.rejected,s=>{s.error=!0,s.loading=!1}).addCase(E.pending,s=>{s.loading=!0,s.error=!1}).addCase(E.fulfilled,(s,e)=>{s.classTypeNumber=e.payload,s.loading=!1,s.error=!1}).addCase(E.rejected,s=>{s.error=!0,s.loading=!1}).addCase(B.pending,s=>{s.loading=!0,s.error=!1}).addCase(B.fulfilled,(s,e)=>{s.loading=!1,s.error=!1,s.classItems=e.payload}).addCase(B.rejected,s=>{s.loading=!1,s.error=!0}).addCase($.pending,s=>{s.loading=!0,s.error=!1}).addCase($.fulfilled,(s,e)=>{s.loading=!1,s.error=!1,s.classNewItems=s.classNewItems.map(o=>o.id===e.payload.id?{...o,price:e.payload.price,subjects:e.payload.subjects}:o)}).addCase($.rejected,s=>{s.loading=!1,s.error=!0}).addCase(A.pending,s=>{s.loading=!0,s.error=!1}).addCase(A.fulfilled,(s,e)=>{s.loading=!1,s.error=!1,s.color=[...s.color,e.payload]}).addCase(A.rejected,s=>{s.loading=!1,s.error=!0}).addCase(O.pending,s=>{s.loading=!0,s.error=!1}).addCase(O.fulfilled,(s,e)=>{s.loading=!1,s.error=!1,s.color=e.payload}).addCase(O.rejected,s=>{s.loading=!1,s.error=!0}).addCase(P.pending,s=>{s.loading=!0,s.error=!1}).addCase(P.fulfilled,(s,e)=>{s.loading=!1,s.error=!1,s.color=[...s.color.filter(o=>o.id!==e.payload.id),e.payload]}).addCase(P.rejected,s=>{s.loading=!1,s.error=!0}).addCase(G.pending,s=>{s.loading=!0,s.error=!1}).addCase(G.fulfilled,(s,e)=>{s.subjects=e.payload,s.loading=!1,s.error=!1}).addCase(G.rejected,s=>{s.loading=!1,s.error=!0}).addCase(F.pending,s=>{s.loading=!0,s.error=!1}).addCase(F.fulfilled,(s,e)=>{s.classNewItems=e.payload,s.loading=!1,s.error=!1}).addCase(F.rejected,s=>{s.loading=!1,s.error=!0})}),{onDelete:qs,onDeleteTypes:Ds,onChangeClassStatus:as,onUpdateClass:Es}=U.actions,Bs=U.reducer,ls="_modalBtn_1d7c7_10",rs="_extraClassForm_1d7c7_15",cs="_modalHeader_1d7c7_57",ns="_items_1d7c7_65",os="_checkbox__minus_1d7c7_70",ts="_active_1d7c7_79",ds="_changeColorItem_1d7c7_89",is="_color_1d7c7_100",us="_subject__main_1d7c7_107",ps="_subject_1d7c7_107",N={modalBtn:ls,extraClassForm:rs,modalHeader:cs,items:ns,checkbox__minus:os,active:ts,changeColorItem:ds,color:is,subject__main:us,subject:ps},fs="_select_1d7c7_1",_s="_extraClassForm_1d7c7_15",ms="_container_1d7c7_21",Cs="_input_1d7c7_26",hs="_selectBox_1d7c7_34",v={select:fs,extraClassForm:_s,container:ms,input:Cs,selectBox:hs},js=({selectOptions:a,editClass:s,setEditClass:e,edit:o,changedItem:f})=>{const[_,p]=h.useState([]),{register:t,handleSubmit:n,setValue:g}=ss(),{request:b}=d(),T=R(),S=r=>{const c={subjects:_,...r},m=s;g("price",_.price),T($({idClass:m,res:c})),e(!s)},[y,I]=h.useState([]);h.useEffect(()=>{f?.id&&(p(f.subjects.map(r=>({value:r.id,label:r.name}))),g("curriculum_hours",f.curriculum_hours),g("price",f.price))},[f?.id]),h.useEffect(()=>{a?.length&&I(a?.map(r=>({value:r.id,label:r.name})))},[a]),h.useEffect(()=>{s&&b(`${i}Class/class_subjects?id=${s}`,"GET",null,u()).then(r=>{p(r.hours.map(c=>({value:c.id,label:c.name,hours:c.hours})))})},[s]);const x=(r,c)=>{p(m=>m.map(C=>C.value===r&&c!==C?.hours?{...C,hours:c}:C))};return l.jsx(l.Fragment,{children:l.jsxs(W,{active:s,setActive:e,children:[l.jsx("h2",{children:"Ma’lumotlarni o’zgartirish "}),l.jsxs(X,{extraClassname:v.extraClassForm,typeSubmit:"",onSubmit:n(S),children:[l.jsxs("div",{className:v.container,children:[l.jsxs("div",{children:[l.jsx(L,{name:"price",register:t,value:_.price,type:"number",placeholder:"narxi"}),l.jsx("div",{className:v.selectBox,children:l.jsx(Y,{extraClass:v.select,value:_,options:y,onChange:p})})]}),l.jsx("div",{className:v.input,children:_.map(r=>l.jsx(L,{value:r.hours,type:"number",title:r.label,onChange:c=>x(r.value,c.target.value)}))})]}),l.jsx(V,{children:"Tastiqlash"})]})]})})},As=a=>a.classSlice.loading,Os=a=>a.classSlice?.classData,Ps=a=>a.classSlice?.color,gs=a=>a.classSlice?.subjects,bs=a=>a.classSlice?.classNewItems,Gs=({edit:a})=>{const[s,e]=h.useState(!1),[o,f]=h.useState({}),_=J(gs),p=J(bs),{request:t}=d(),n=R(),[g,b]=h.useState([]),[T,S]=h.useState(null);h.useEffect(()=>{if(s){const r=p.find(c=>c.id===s);S(r)}},[s,p]);const y=({id:r,type:c})=>{const m={status:!c,class_type_id:a.id,class_number_id:r};t(`${i}Class/class_number_update_status/`,"POST",JSON.stringify(m),u()).then(C=>{n(as({id:r})),n(Z({type:"success",status:!0,msg:C.msg}))}).catch(C=>{console.log(C)})},x=p.map((r,c)=>l.jsxs("tr",{children:[l.jsx("td",{children:c+1}),l.jsx("td",{children:r?.number}),l.jsx("td",{children:l.jsx("div",{className:N.subject__main,children:r?.subjects.map(m=>l.jsxs("span",{className:N.subject,children:[" ",m.name,"-",m.hours]}))})}),l.jsx("td",{children:r.price}),l.jsx("td",{style:{width:"3rem"},children:l.jsxs("div",{className:N.items,children:[l.jsx("div",{onClick:()=>y({id:r.id,type:r.status}),className:M(N.checkbox__minus,{[N.active]:r.status}),children:r.status?l.jsx("i",{className:"fa fa-check "}):l.jsx("i",{className:"fa fa-minus"})}),l.jsx("i",{onClick:()=>{e(r.id),f(r)},className:"fa fa-pen"})]})})]}));return l.jsxs("div",{children:[l.jsxs(K,{children:[l.jsx("thead",{children:l.jsxs("tr",{children:[l.jsx("th",{children:"No"}),l.jsx("th",{children:"Sinf Raqami"}),l.jsx("th",{children:"Fanlari"}),l.jsx("th",{children:"Narxi"}),l.jsx("th",{})]})}),l.jsx("tbody",{children:x})]}),l.jsx(js,{setEditClass:e,selectOptions:_,editClass:s,changedItem:o,edit:a})]})},xs="_classFilter_12547_1",ys="_active_12547_28",w={classFilter:xs,active:ys},Hs=({classesType:a,active:s,setActive:e,setEdit:o})=>{const f=R(),_=J(Q),p=h.useCallback(n=>{f(F({branchId:_.id,id:n}))},[_]);function t(n,g){return n.id-g.id}return l.jsx("div",{className:w.classFilter,children:l.jsx("div",{className:w.classFilter__wrapper,children:l.jsx("ul",{children:[...a].sort(t)?.map((n,g)=>l.jsxs("li",{className:M(w.classFilter_li,{[w.active]:s===n?.id}),onClick:()=>{p(n.id),e(n.id),o({id:n.id,name:n.name})},children:[n?.name,l.jsx("div",{children:n.class_numbers?.map(b=>l.jsx("span",{children:b?.number}))})]},g))})})})},Ss="_filter__wrapper_5nrwu_1",H={filter__wrapper:Ss},Js=({color:a,setEdit:s,setChangeName:e,changeName:o,setValue:f})=>{const p=a.map((t,n)=>{function g(y){var I=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;y=y.replace(I,function(r,c,m,C){return c+c+m+m+C+C});var x=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(y);return x?{r:parseInt(x[1],16),g:parseInt(x[2],16),b:parseInt(x[3],16)}:null}const b=g(t?.value?t?.value:"#ffffff"),T=Math.round((parseInt(b?.r)*299+parseInt(b?.g)*587+parseInt(b?.b)*114)/1e3),S={backgroundColor:t?.value?t?.value:"white",color:T>125?"black":"white"};return l.jsxs("li",{style:S,className:M(H.classFilter_li),onClick:()=>{s(t),f("name",t.name),e(!o)},children:[t.name,l.jsx("span",{children:t.class})]},n)});return l.jsx("div",{className:H.filter,children:l.jsx("div",{className:H.filter__wrapper,children:l.jsx("ul",{children:p})})})};export{Gs as C,Ps as a,As as b,Os as c,O as d,N as e,G as f,q as g,A as h,k as i,Hs as j,Js as k,Bs as l,qs as m,P as n,Ds as o,D as u};
