import{r as s,j as e,B as w,e as S,d as te,T as U,n as G,z as O,F as J,I,S as V,ba as K,M as Q,bF as $,bG as ae,bH as ne,bI as re,C as T,u as ie,a as q,bJ as ce,bK as le,D as oe,bL as de,o as B,bM as me,h as ue,A as _e,i as he,bN as pe}from"./index-9ggpSpOh.js";import{g as je}from"./searchSelector-B3qtoac4.js";import{P as xe}from"./pagination-TgzvL7nQ.js";import{a as be,C as ve}from"./confirmModal-Dyb-8OvR.js";const ge="_header_lodna_1",fe="_header__container_lodna_6",Le="_inner__btn_lodna_15",ye="_active_lodna_18",E={header:ge,header__container:fe,inner__btn:Le,active:ye},Te=s.memo(o=>{const{isCreate:t,setIsCreate:u,setIsFilter:_,setStatus:m}=o;return e.jsx("div",{className:E.header,children:e.jsx("div",{className:E.header__container,children:e.jsx(w,{onClick:()=>{u(!t),m(!1)},type:t?"simple":"simple-add",extraClass:S(E.inner__btn,t?"":E.active),children:"Create Time"})})})}),Ce="_timeTableList_oowao_1",Ne="_timeTableList__icon_oowao_18",H={timeTableList:Ce,timeTableList__icon:Ne},Se=s.memo(o=>{const{data:t,setIsChange:u,loading:_,setStatus:m}=o;console.log(t,"da");const j=s.useCallback(()=>t?.map((h,y)=>e.jsxs("tr",{children:[e.jsx("td",{children:y+1}),e.jsxs("td",{children:[h?.order,"-dars"]}),e.jsx("td",{children:h?.start_time?.slice(0,5)}),e.jsx("td",{children:h?.end_time?.slice(0,5)}),e.jsx("td",{children:h?.name}),e.jsx("td",{}),e.jsx("td",{children:e.jsx("i",{onClick:()=>{u(h),m(!1)},className:S("fas fa-pen",H.timeTableList__icon)})})]})),[t,_])();return _?e.jsx(te,{}):e.jsx("div",{className:H.timeTableList,children:e.jsxs(U,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Soatlar roâ€™yxati"}),e.jsx("th",{children:"Boshlanish vaqt"}),e.jsx("th",{children:"Tugash vaqti"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Sinf"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:j})]})})}),De="_create_dnjzo_1",Ie="_create__input_dnjzo_6",ke="_create__btn_dnjzo_21",A={create:De,create__input:Ie,create__btn:ke},we=s.memo(o=>{const{classInput:t,active:u,setActive:_,onSubmit:m,loading:d}=o,j=[{name:"Yuqori",value:"high"},{name:"Boshlang'ich",value:"initial"}],{register:h,handleSubmit:y,reset:D}=G(),[p,x]=s.useState(null),[f,g]=s.useState([]);return s.useEffect(()=>{g(t.map(L=>({value:L.id,label:L.name})))},[t]),e.jsx(O,{active:u,setActive:_,children:e.jsx(J,{onSubmit:y(L=>{m({...L,types:p?.map(r=>r.value)}),D()}),typeSubmit:"",children:e.jsxs("div",{className:A.create,children:[e.jsx("h1",{children:"Soat yaratish"}),e.jsx(I,{extraClassName:A.create__input,placeholder:"Boshlanish vaqti",register:h,name:"start_time",type:"time",required:!0}),e.jsx(I,{extraClassName:A.create__input,placeholder:"Tugash vaqti",register:h,name:"end_time",type:"time",required:!0}),e.jsx(I,{extraClassName:A.create__input,placeholder:"Soati",register:h,name:"order",type:"number",required:!0}),e.jsx(I,{extraClassName:A.create__input,placeholder:"Name",register:h,name:"name",required:!0}),e.jsx(V,{name:"type",register:h,required:!0,options:j}),e.jsx(K,{options:f,onChange:x,value:p,fontSize:15}),d?e.jsx(Q,{}):e.jsx(w,{extraClass:A.create__btn,type:"simple",children:"Yaratish"})]})})})}),Ae="_change_1uf17_1",Me="_change__input_1uf17_6",qe="_change__btn_1uf17_21",k={change:Ae,change__input:Me,change__btn:qe},Ee=s.memo(o=>{const{register:t,handleSubmit:u,setValue:_}=G(),{classInput:m,active:d,setActive:j,onSubmit:h,loading:y,onDelete:D}=o;let p=s.useMemo(()=>d?.start_time,[d]),x=s.useMemo(()=>d?.end_time,[d]),f=s.useMemo(()=>d?.order,[d]),g=s.useMemo(()=>d?.name,[d]),L=s.useMemo(()=>d?.type,[d]);const[r,c]=s.useState([]),[a,n]=s.useState([]);s.useEffect(()=>{_("start_time",p),_("end_time",x),_("order",f),_("name",g),_("type",L)},[d]);const i=[{name:"Yuqori",value:"high"},{name:"Boshlang'ich",value:"initial"}];return s.useEffect(()=>{c(d?.types.map(C=>({value:C.id,label:C.name})))},[d?.types]),s.useEffect(()=>{n(m.map(C=>({value:C.id,label:C.name})))},[]),e.jsx(O,{active:d,setActive:j,children:e.jsx(J,{typeSubmit:"",children:e.jsxs("div",{className:k.change,children:[e.jsx("h1",{children:"Change time"}),e.jsx(I,{extraClassName:k.change__input,placeholder:"Boshlanish vaqti",register:t,name:"start_time",type:"time",required:!0}),e.jsx(I,{extraClassName:k.change__input,placeholder:"Tugash vaqti",register:t,name:"end_time",type:"time",required:!0}),e.jsx(I,{extraClassName:k.change__input,placeholder:"Order",register:t,name:"order",type:"number",required:!0}),e.jsx(I,{extraClassName:k.change__input,placeholder:"Name",register:t,name:"name",required:!0}),e.jsx(K,{options:a,onChange:c,value:r,fontSize:15}),e.jsx(V,{name:"type",register:t,required:!0,options:i,defaultValue:L}),y?e.jsx(Q,{}):e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx(w,{onClick:u(h),extraClass:k.change__btn,type:"simple",children:"O'zgartirish"}),e.jsx(w,{onClick:u(D),extraClass:k.change__btn,type:"danger",children:"O'chirish"})]})]})})})}),$e="_timeTableFilters_mw11o_1",ze="_navigators_mw11o_6",Fe="_navigators__inner_mw11o_11",Ye="_timeTableFilters__icon_mw11o_15",Pe="_classList_mw11o_26",Be="_classList__inner_mw11o_31",Ue="_active_mw11o_40",Oe="_colorList_mw11o_47",Ve="_colorList__inner_mw11o_50",He="_typesList_mw11o_62",Re="_typesList__inner_mw11o_69",Ge="_typesList__active_mw11o_77",Je="_subjectsList_mw11o_86",Ke="_subjectsList__inner_mw11o_94",v={timeTableFilters:$e,navigators:ze,navigators__inner:Fe,timeTableFilters__icon:Ye,classList:Pe,classList__inner:Be,active:Ue,colorList:Oe,colorList__inner:Ve,typesList:He,typesList__inner:Re,typesList__active:Ge,subjectsList:Je,subjectsList__inner:Ke},Qe=[{id:1,value:"Subjects"},{id:2,value:"Teacher"},{id:3,value:"Room"}],We=[15.55,48.5,80.7];s.memo(o=>{const{activeDrag:t,setData:u,setActiveModal:_,setActive:m,setActiveDrop:d,setActiveDrag:j,classData:h,colorData:y,branchData:D,roomData:p,subjectData:x,teacherData:f}=o,[g,L]=s.useState([]),[r,c]=s.useState(1),[a,n]=s.useState(1),[i,C]=s.useState([]);s.useEffect(()=>{m(g),d(null),j(null)},[g]),s.useEffect(()=>{C(a===1&&x?x:a===2&&f?f:p),u(null)},[a,f,x,p]),s.useEffect(()=>{i&&u(a===2?{name:i.filter(l=>l.id===t)[0]?.user?.name,surname:i.filter(l=>l.id===t)[0]?.user?.surname,value:"teacher",id:i.filter(l=>l.id===t)[0]?.id}:{name:i.filter(l=>l.id===t)[0]?.name,value:a===1?"subject":"room",id:i.filter(l=>l.id===t)[0]?.id})},[t]);const z=()=>h?.map(l=>e.jsxs("div",{className:S(v.classList__inner,{[v.active]:g.includes(l.id)}),onClick:()=>L(P=>g.includes(l.id)?[...P.filter(se=>se!==l.id)]:[...P,l.id]),children:[g.includes(l.id)?e.jsx("img",{src:ae,alt:""}):null,l.name]})),N=()=>y?.map(l=>e.jsx("div",{className:S(v.colorList__inner,{[v.active]:r===l.id}),onClick:()=>c(l.id),children:l.value})),F=()=>Qe.map(l=>e.jsx("div",{className:S(v.typesList__inner,{[v.active]:a===l.id}),onClick:()=>n(l.id),children:l.value})),Y=s.useCallback(()=>i.map((l,P)=>e.jsx($,{extraClass:v.subjectsList__inner,id:l.id,data:{hello:1},children:a===2?`${l?.user?.name} ${l?.user?.surname}`:l.name})),[a,i]),W=z(),X=N(),Z=F(),ee=Y();return e.jsxs("div",{className:v.timeTableFilters,children:[e.jsxs("div",{className:v.navigators,children:[e.jsxs("div",{id:"unique-id",className:v.navigators__inner,children:[e.jsx(w,{type:"simple",children:"Class"}),e.jsx(w,{type:"simple-add",children:"Patok"})]}),e.jsx(V,{title:"Branch",options:D})]}),e.jsx("div",{onClick:()=>_(!0),className:v.timeTableFilters__icon,children:e.jsx("i",{className:"fas fa-cog"})}),e.jsx("div",{className:v.classList,children:W}),e.jsx("div",{className:v.colorList,children:X}),e.jsxs("div",{className:v.typesList,children:[Z,e.jsx("div",{className:v.typesList__active,style:{left:`${We[a-1]}%`}})]}),e.jsx("div",{className:v.subjectsList,children:ee})]})});const Xe="_schedule_9m7ae_1",Ze="_schedule__inner_9m7ae_4",es="_index_9m7ae_7",ss="_subject_9m7ae_45",ts="_notActive_9m7ae_48",as="_teacher_9m7ae_51",ns="_room_9m7ae_60",rs="_schedule__time_9m7ae_66",b={schedule:Xe,schedule__inner:Ze,index:es,subject:ss,notActive:ts,teacher:as,room:ns,schedule__time:rs},is=s.memo(o=>{const{subjectData:t,activeDrop:u,uid:_,data:m,index:d,onSubmit:j,onDelete:h,classId:y,userBranchId:D}=o,[p,x]=s.useState([]);s.useEffect(()=>{x(m?.time_tables.map((r,c)=>({weekday:{name:r.weekday.name,id:r.weekday.id,lessons:r.weekday.lessons.map((a,n)=>{let i=_+(r.weekday.id+(n+1))*(a.hour.id+(c+1));return{id:a.id,hour:a.hour,status:a.status,uid:i,subject:{id:a?.subject?.id,name:a?.subject?.name,itemUID:a?.subject?.id?i+"subject":null},room:{id:a?.room?.id,name:a?.room?.name,itemUID:a?.room?.id?i+"room":null},teacher:{id:a?.teacher?.id,name:a?.teacher?.name,surname:a?.teacher?.surname,itemUID:a?.teacher?.id?i+"teacher":null}}})}})))},[m]),s.useEffect(()=>{t&&p?.length&&x(p.map(r=>({weekday:{name:r.weekday.name,id:r.weekday.id,lessons:r.weekday.lessons.map(c=>c.uid===u?{hour:c.hour,status:c.status,uid:c.uid,subject:t.value==="subject"?t:c.subject,teacher:t.value==="teacher"?t:c.teacher,room:t.value==="room"?t:c.room}:c)}})))},[m,u,t]),s.useEffect(()=>{if(u){let r,c;p.filter(a=>a.weekday.lessons.map(n=>{n.uid===u&&(r=n,c=a.weekday.id)})),r?.room.id&&r?.teacher.id&&r?.subject.id&&j({group:y,week:c,room:r?.room?.id,hours:r?.hour?.id,branch:D,teacher:r?.teacher?.id,subject:r?.subject?.id})}},[u,p]);const g=s.useCallback(()=>p?.map((r,c)=>{const a=e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"3rem 1.5rem"},children:r?.weekday?.name?.slice(0,3)}),r?.weekday?.lessons?.map((n,i)=>(n.status,e.jsx("td",{className:b.days__item,children:e.jsxs(ne,{id:n.uid,children:[n.subject?.name?e.jsx($,{id:n.subject.itemUID,children:e.jsx("p",{className:S(b.subject,{[b.notActive]:!n.subject?.name}),children:n?.subject?.name})}):e.jsx("p",{className:S(b.subject,{[b.notActive]:!n.subject?.name}),children:n?.subject?.name}),n.teacher?.name?e.jsx($,{id:n.teacher.itemUID,children:e.jsxs("p",{className:S(b.teacher,{[b.notActive]:!n.teacher?.name}),children:[e.jsx("span",{children:n?.teacher?.name}),e.jsx("span",{children:n?.teacher?.surname})]})}):e.jsxs("p",{className:S(b.teacher,{[b.notActive]:!n.teacher?.name}),children:[e.jsx("span",{children:n?.teacher?.name}),e.jsx("span",{children:n?.teacher?.surname})]}),n.room?.name?e.jsx($,{id:n.room.itemUID,children:e.jsx("p",{className:S(b.room,{[b.notActive]:!n.room?.name}),children:n?.room?.name})}):e.jsx("p",{className:S(b.room,{[b.notActive]:!n.room?.name}),children:n?.room?.name})]},n.uid)})))]});return e.jsx(re,{onDragEnd:L,children:a})}),[p,_])();function L(r){const{active:c,over:a}=r;p.map(n=>{n.weekday.lessons.map(i=>{c.id.includes("subject")?i.uid===c.id.slice(0,i.uid.length)&&i.uid!==a.id&&h({id:i.id,res:{item_type:"subject"}}):c.id.includes("room")?i.uid===c.id.slice(0,i.uid.length)&&i.uid!==a.id&&h({id:i.id,res:{item_type:"room"}}):i.uid===c.id.slice(0,i.uid.length)&&i.uid!==a.id&&h({id:i.id,res:{item_type:"teacher"}})})})}return e.jsx("div",{className:b.schedule,children:e.jsxs(U,{extraClass:b.schedule__inner,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),m?.hours_list?.map((r,c)=>e.jsxs("th",{children:[e.jsx("p",{className:b.index,children:c+1}),e.jsxs("div",{className:b.schedule__time,children:[e.jsx("p",{children:r?.start_time.slice(0,5)}),"-",e.jsx("p",{children:r?.end_time.slice(0,5)})]})]}))]})}),e.jsx("tbody",{children:g})]})})}),cs="_error_1y39z_1",ls="_error__header_1y39z_6",os="_inner_1y39z_11",ds="_error__btn_1y39z_22",ms="_error__list_1y39z_25",M={error:cs,error__header:ls,inner:os,error__btn:ds,error__list:ms},us=[{img:T,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:T,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:T,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:T,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:T,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:T,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:T,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:T,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:T,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:T,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:T,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:T,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"}];s.memo(({setActive:o,active:t})=>{const _=us.map(m=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:m.img,alt:""})}),e.jsx("td",{children:m.fullName}),e.jsx("td",{children:m.phone}),e.jsx("td",{children:m.comment})]}));return e.jsx(O,{setActive:o,active:t,children:e.jsxs("div",{className:M.error,children:[e.jsxs("div",{className:M.error__header,children:[e.jsx("img",{src:be,alt:""}),e.jsxs("div",{className:M.inner,children:[e.jsx("h1",{children:"Error"}),e.jsx("span",{children:"1 blueda hato chiqdi"})]})]}),e.jsx(w,{type:"danger",extraClass:M.error__btn,children:e.jsx("i",{className:"far fa-check-circle"})}),e.jsx("div",{className:M.error__list,children:e.jsxs(U,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism Familiya"}),e.jsx("th",{children:"Tel"}),e.jsx("th",{children:"Comment"})]})}),e.jsx("tbody",{children:_})]})})]})})});const _s="_scheduleList_mfdk0_1",hs={scheduleList:_s};s.memo(o=>{const{data:t,subjectData:u,activeDrop:_,length:m,onSubmit:d,onDelete:j,userBranchId:h,handleDragEndInner:y}=o,p=s.useCallback(()=>t?.map((x,f)=>e.jsx(is,{uid:`${m[f]}class`,subjectData:u,activeDrop:_,data:x.data,index:f+1,onSubmit:d,onDelete:j,classId:m[f],userBranchId:h,handleDragEndInner:y})),[m,_,t,u,d,j])();return e.jsx("div",{className:hs.scheduleList,children:p})});const ps=o=>o.TimeTableSlice?.data,js=o=>o.TimeTableSlice?.loading,xs="_timeTable_nfy34_1",bs="_timeTable__table_nfy34_7",R={timeTable:xs,timeTable__table:bs},vs={},Ts=()=>{const o=ie(),t=q(ps),u=q(ce),_=q(js),[m,d]=s.useState(!1),[j,h]=s.useState(null),[y,D]=s.useState(!1),[p,x]=s.useState(!1),[f,g]=s.useState(!1);q(je);let L=s.useMemo(()=>10,[]);const[r,c]=s.useState(1);s.useEffect(()=>{o(le({currentPage:r,pageSize:L}))},[r]);const a=N=>{o(de(N)),o(B({type:"success",status:!0,msg:"Vaqt qo'shildi"})),d(!1),x(!0)},n=N=>{const F=t?.filter(Y=>Y.id===j?.id)[0];o(me({id:j?.id,obj:N})),o(B({type:"success",status:!0,msg:`${F?.name}ni malumotlari o'zgardi`})),x(!0)},{request:i}=ue(),C=()=>{i(`${_e}SchoolTimeTable/hours-list-update/${j.id}`,"DELETE",null,he()).then(N=>{o(pe(j.id)),g(!1),o(B({status:!0,type:"success",msg:N.msg})),h(!1)}).catch(N=>{console.log(N)})},z=()=>{g(!0)};return e.jsx(oe,{reducers:vs,children:e.jsxs("div",{className:R.timeTable,children:[e.jsx(Te,{isCreate:m,setIsCreate:d,setIsFilter:D,setStatus:x}),e.jsxs("div",{className:R.timeTable__table,children:[e.jsx(Se,{data:t?.results,setIsChange:h,loading:_,setStatus:x}),e.jsx(xe,{totalCount:t?.count,currentPage:r,pageSize:L,onPageChange:N=>{c(N)}})]}),e.jsx(we,{classInput:u,active:p?!1:m,setActive:d,onSubmit:a,loading:_}),e.jsx(Ee,{classInput:u,active:p?!1:j,setActive:h,onSubmit:n,loading:_,onDelete:z}),e.jsx(ve,{type:"danger",active:f,setActive:g,onClick:C})]})})};export{Ts as TimeTableListPage};
