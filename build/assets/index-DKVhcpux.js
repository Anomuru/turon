import{R as N,r as d,n as p,l as C,o as I,j as t,p as D,I as H,B as R,c as T}from"./index-Cux8sda1.js";import{M as B}from"./modal-BR27MEf1.js";import{g as E,b as m,p as x,c as g,f as A}from"./index-FTpBLBKi.js";import"./cross-BXlnQeE0.js";const J="_filter_1xl0c_1",M="_filter__container_1xl0c_7",V="_filter__select_1xl0c_13",q="_workerPermission_1xl0c_51",z="_buttonHome_1xl0c_62",l={filter:J,filter__container:M,filter__select:V,workerPermission:q,buttonHome:z},O=n=>n.vacancyWorkerPermissionSlice?.tables,Q=N.memo(({active:n,setActive:r,onAddVacancy:i})=>{const[k,f]=d.useState(""),[h,c]=d.useState([]),[b,j]=d.useState([]),P=p(E),a=C(),{id:u}=p(I),S=p(O),y=P.job?.length?Number(P.job[0].id):null;d.useEffect(()=>{a(m())},[a]);const W=e=>{f(e),a(x(e)).then(s=>{x.fulfilled.match(s)?j(s.payload.permissions):console.error("Permissionlada xato",s.payload)})},w=(e,s)=>{e.target.checked?c(o=>[...o,s]):c(o=>o.filter(_=>_!==s))},v=()=>{const e={id:Date.now(),workName:k,workerNames:h.join(", ")};i(e),c([]),f(""),a(x(e));const s=b.permissions.filter(o=>h.includes(o.name)).map(o=>o.id);u&&a(g({id:u,selectedJobID:y,selectedPermissions:s})).then(o=>{if(g.fulfilled.match(o)){a(A(u));const _={id:Date.now(),permissions:s};i(_),c([]),f(""),r(!1)}else console.error("Xatolik yuz berdi",o.payload)})};return t.jsx(B,{active:n,setActive:r,children:t.jsxs("div",{className:l.filter,children:[t.jsx("h1",{children:"Add"}),t.jsxs("div",{className:l.filter__container,children:[t.jsx(D,{title:"Ish turi",extraClass:l.filter__select,onChangeOption:W,options:S.tables,required:!0,value:k}),b.permissions?.map(e=>t.jsxs("div",{className:l.workerPermission,children:[t.jsx("h4",{children:e.name}),t.jsx(H,{style:{width:"20px",marginTop:"15px"},type:"checkbox",checked:h.includes(e.name),onChange:s=>w(s,e.name)})]},e.id))]}),t.jsx("div",{className:l.buttonHome,children:t.jsx(R,{children:"Add",onClick:v})})]})})}),X={tables:[],loading:!1,error:null},$=T({name:"vacancyWorkerPermissionSlice",initialState:X,reducers:{},extraReducers:n=>{n.addCase(m.pending,r=>{r.loading=!0}).addCase(m.fulfilled,(r,i)=>{r.loading=!1,r.tables=i.payload}).addCase(m.rejected,(r,i)=>{r.loading=!1,r.error=i.error.message})}}),U=$.reducer;export{Q as VacancyWorkerPermission,m as fetchPermissionTable,O as getPermissionTables,U as vacancyWorkerPermissionSlice};
