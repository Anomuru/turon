import{a as pe,u as ue,A as U,h as J,c as Rr,R as se,r as b,l as yr,n as L,j as f,B as Se,p as xr,I as Kr,i as Ve,M as _r,o as qr,O as Gr}from"./index-Cux8sda1.js";import"./teacherProfile.thunk-CNLmQFLQ.js";import{u as Qr,C as Ur,f as Jr,h as ur,D as Ir,r as en,j as rn,T as nn,M as an}from"./core.esm-Crx2h5Ym.js";import{o as on,a as dr}from"./alertSlice-XeBTN8B3.js";import{D as tn,a as sn}from"./droppable-CvZqsj53.js";import{M as cr}from"./modal-BR27MEf1.js";import"./cross-BXlnQeE0.js";const Ue=pe("TimeTableTuronSlice/fetchTimeTableWeekDays",async()=>{const{request:e}=ue();return await e(`${U}TimeTable/week_days/`,"GET",null,J())}),Le=pe("TimeTableTuronSlice/fetchTimeTableTypesData",async({type:e,branch:n})=>{const{request:r}=ue();return await r(`${U}SchoolTimeTable/timetable-class-flow/?branch=${n}&type=${e}`,"GET",null,J())}),Be=pe("TimeTableTuronSlice/fetchTimeTableData",async e=>{const{request:n}=ue();return await n(`${U}SchoolTimeTable/timetable-lessons/?date=${e.date}&branch=${e.branch}`,"GET",null,J())}),Ye=pe("TimeTableTuronSlice/fetchTimeTableSubject",async e=>{const{request:n}=ue();return await n(`${U}Class/class-subjects/?group=${e}`,"GET",null,J())}),Me=pe("TimeTableTuronSlice/fetchTimeTableTeacher",async({subject:e,branch:n})=>{const{request:r}=ue();return await r(`${U}Teachers/teachers-for-subject-time/?branch=${n}&subject=${e}`,"GET",null,J())}),Ze=pe("TimeTableTuronSlice/fetchTimeTableColors",async()=>{const{request:e}=ue();return await e(`${U}Class/class_colors/`,"GET",null,J())}),Fe=pe("TimeTableTuronSlice/fetchTimeTableClassView",async e=>{const{request:n}=ue();return await n(`${U}SchoolTimeTable/timetable-lessons-class/?date=${e.date}&branch=${e.branch}`,"GET",null,J())}),ln={type:"group",hours:[],data:[],group:[],flows:[],subjects:[],teachers:[],weekDays:[],colors:[],date:new Date().toLocaleDateString("en-CA"),classViewData:[],day:"",color:"",filterClass:"",fetchStatusTeachers:"idle",fetchStatusGroup:"idle",fetchStatusData:"idle",loading:!1,error:null},Pr=Rr({name:"TimeTableTuronSlice",initialState:ln,reducers:{onChangeTypeTimeTable:(e,n)=>{e.type=n.payload},onChangeDayTimeTable:(e,n)=>{e.day=n.payload},onChangeFilterClassTimeTable:(e,n)=>{e.filterClass=n.payload},onChangeColorTimeTable:(e,n)=>{e.color=n.payload},onChangeDateTimeTable:(e,n)=>{e.date=n.payload}},extraReducers:e=>e.addCase(Ze.pending,n=>{n.loading=!0,n.error=null}).addCase(Ze.fulfilled,(n,r)=>{n.colors=r.payload,n.color=r.payload[0].id,n.loading=!1,n.error=null}).addCase(Ze.rejected,(n,r)=>{n.loading=!1,n.error=r.payload??null}).addCase(Ye.pending,n=>{n.loading=!0,n.error=null}).addCase(Ye.fulfilled,(n,r)=>{r.payload.length>0?n.subjects=r.payload.map((i,a)=>({...i,dndId:`subject-${i.id}`,type:"subject"})):n.subjects=[],n.loading=!1,n.error=null}).addCase(Ye.rejected,(n,r)=>{n.loading=!1,n.error=r.payload??null}).addCase(Me.pending,n=>{n.loading=!0,n.error=null,n.fetchStatusTeachers="loading"}).addCase(Me.fulfilled,(n,r)=>{n.teachers=r.payload.map((i,a)=>({...i,dndId:`teacher-${i.id}`,type:"teacher"})),n.fetchStatusTeachers="success",n.loading=!1,n.error=null}).addCase(Me.rejected,(n,r)=>{n.loading=!1,n.error=r.payload??null,n.fetchStatusTeachers="error"}).addCase(Ue.pending,n=>{n.loading=!0,n.error=null}).addCase(Ue.fulfilled,(n,r)=>{n.weekDays=r.payload.days.map(i=>({id:i.id,name:i.name_uz})),n.day=r.payload.today,n.loading=!1,n.error=null}).addCase(Ue.rejected,(n,r)=>{n.loading=!1,n.error=r.payload??null}).addCase(Le.pending,n=>{n.loading=!0,n.error=null,n.fetchStatusGroup="loading"}).addCase(Le.fulfilled,(n,r)=>{n.group=r.payload.map((i,a)=>({...i,dndId:`${i.type}-${i.id}`,type:i.type}))||[],n.fetchStatusGroup="success",n.loading=!1,n.error=null}).addCase(Le.rejected,(n,r)=>{n.loading=!1,n.fetchStatusGroup="error",n.error=r.payload??null}).addCase(Fe.pending,n=>{n.loading=!0,n.error=null}).addCase(Fe.fulfilled,(n,r)=>{n.classViewData=r.payload.time_tables,n.loading=!1,n.error=null}).addCase(Fe.rejected,(n,r)=>{n.loading=!1,n.error=!0}).addCase(Be.pending,n=>{n.loading=!0,n.fetchStatusData="loading",n.error=null}).addCase(Be.fulfilled,(n,r)=>{let i=1;n.data=r.payload.time_tables.map(a=>{const o=a.lessons.map(t=>(i+=1,t.group.id?{...t,group:{...t.group,dndId:`group-${t.id}`,type:t.is_flow?"flow":"group"},subject:{...t.subject,dndId:`subject-${t.id}`,type:"subject"},teacher:{...t.teacher,dndId:`teacher-${t.id}`,type:"teacher"},dndId:`container-${i}`,isSelected:!1,isDisabled:!1}:{...t,dndId:`container-${i}`,isSelected:!1,isDisabled:!1}));return{...a,lessons:o}}),n.hours=r.payload.hours_list,n.fetchStatusData="success",n.loading=!1,n.error=null}).addCase(Be.rejected,(n,r)=>{n.loading=!1,n.fetchStatusData="error",n.error=r.payload??null})}),Va=Pr.reducer,{onChangeTypeTimeTable:un,onChangeDayTimeTable:Ha,onChangeColorTimeTable:dn,onChangeFilterClassTimeTable:cn,onChangeDateTimeTable:fn}=Pr.actions,pn="_timeTable_1i695_1",mn={timeTable:pn},jr=e=>e.timeTableTuronSlice.date,vn=e=>e.timeTableTuronSlice.colors,Yr=e=>e.timeTableTuronSlice.color,Dr=e=>e.timeTableTuronSlice.type,hn=e=>e.timeTableTuronSlice.group,gn=e=>e.timeTableTuronSlice.fetchStatusGroup,bn=e=>e.timeTableTuronSlice.data,Sn=e=>e.timeTableTuronSlice.fetchStatusData,Tn=e=>e.timeTableTuronSlice.classViewData,Cn=e=>e.timeTableTuronSlice.hours,wn=e=>e.timeTableTuronSlice.subjects,yn=e=>e.timeTableTuronSlice.teachers,_n=e=>e.timeTableTuronSlice.fetchStatusTeachers,Pn=e=>e.timeTableTuronSlice.filterClass,jn="_filters_191un_1",Yn="_navigators_191un_6",Dn="_navigators__inner_191un_12",Xn="_colorList_191un_27",En="_colorList__inner_191un_30",An="_active_191un_38",be={filters:jn,navigators:Yn,navigators__inner:Dn,colorList:Xn,colorList__inner:En,active:An},Nn=se.memo(e=>{const{setFullScreen:n,isSelected:r,setIsSelected:i,setClassView:a,groups:o}=e,[t,s]=b.useState(1),l=yr(),c=L(Dr),u=L(vn),d=L(Yr),p=L(jr),m=g=>{l(dn(g))},h=g=>{l(fn(g))},S=()=>u?.map(g=>f.jsx("div",{style:{color:g?.value},className:Ve(be.colorList__inner,{[be.active]:+d===g.id}),onClick:()=>m(g.id),children:g.name})),T=g=>{i(),l(un(g))},X=S(),j=g=>{l(cn(g))};return f.jsxs("div",{className:be.filters,children:[f.jsxs("div",{className:be.navigators,children:[f.jsxs("div",{id:"unique-id",className:be.navigators__inner,children:[f.jsx(Se,{onClick:()=>T("group"),type:c==="group"?"simple":"simple-add",children:"Class"}),f.jsx(Se,{onClick:()=>T("flow"),type:c==="flow"?"simple":"simple-add",children:"Flow"})]}),f.jsxs("div",{style:{display:"flex"},children:[f.jsx(Se,{onClick:()=>n(!0),children:"Full screen"}),f.jsx(Se,{onClick:()=>a(!0),children:"Class view"})]}),f.jsx(xr,{onChangeOption:j,options:o,title:"filter"}),f.jsx(Kr,{type:"date",value:p,onChange:g=>h(g.target.value)})]}),c==="group"&&!r&&f.jsx("div",{className:be.colorList,children:X})]})}),zn="_dnd_o45g6_1",fr={dnd:zn,class:"_class_o45g6_8"},De=e=>{const{item:n,children:r,color:i,typeItem:a}=e;return f.jsx(tn,{data:{type:n.type},id:n.dndId,extraClass:fr.dnd,children:f.jsx("div",{className:fr.class,style:{backgroundColor:i||n?.teacher?.color,fontSize:a==="flow"?"1.2rem":null},children:r})})},kn="_dragItems_1ftr7_1",On={dragItems:kn},Wn=e=>{const{groups:n,isSelected:r,subjects:i,teachers:a,selectedSubject:o,color:t,setSelectedSubject:s,type:l,status:c}=e,u=()=>n?.filter(p=>p.type==="group"?p?.color?.id===+t:!0),d=b.useCallback(()=>r?o?a.map(p=>f.jsxs(De,{type:"teacher",item:p,children:[p?.name," ",p?.surname]})):i?.length?i.map(p=>f.jsxs(De,{type:"subject",item:p,children:[p?.name," - ",p.hours]})):f.jsx("h1",{style:{color:"red"},children:"Fanlar yoq"}):n.length?u()?.map(p=>f.jsxs(De,{color:p.type==="group"?p?.color?.value:"",typeItem:l,item:p,children:[f.jsx("p",{style:{textAlign:"center"},children:p?.class_name||p?.name}),f.jsx("p",{style:{textAlign:"center"},children:l==="flow"&&f.jsxs(f.Fragment,{children:[p?.subject_info?.name,f.jsx("br",{}),p.teacher_info?.name," -",p.teacher_info?.surname]})})]})):f.jsxs("h1",{style:{color:"red"},children:[l," yoq"]}),[r,o,n,a,t,i]);return c==="loading"?f.jsx(_r,{}):f.jsxs("div",{className:On.dragItems,children:[o&&f.jsx(Se,{type:"danger",onClick:()=>s(null),children:"Fanlar"}),d()]})},$n="_tableTuron_133uk_6",Ln="_wrapper_133uk_13",Bn="_header_133uk_20",Mn="_item_133uk_29",Zn="_footer_133uk_38",Fn="_rooms_133uk_43",Vn="_room_133uk_43",Hn="_containers_133uk_59",Rn="_droppableContainer_133uk_64",ie={tableTuron:$n,wrapper:Ln,header:Bn,item:Mn,footer:Zn,rooms:Fn,room:Vn,containers:Hn,droppableContainer:Rn},xn="_draggableContainer_f3x1m_1",Kn="_handle_f3x1m_12",qn="_trash_f3x1m_18",Gn="_selected_f3x1m_25",Qn="_info_f3x1m_34",Pe={draggableContainer:xn,handle:Kn,trash:qn,selected:Gn,info:Qn},Un="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='16'%20width='10'%20viewBox='0%200%20320%20512'%3e%3c!--!Font%20Awesome%20Free%206.5.1%20by%20@fontawesome%20-%20https://fontawesome.com%20License%20-%20https://fontawesome.com/license/free%20Copyright%202024%20Fonticons,%20Inc.--%3e%3cpath%20d='M40%20352l48%200c22.1%200%2040%2017.9%2040%2040l0%2048c0%2022.1-17.9%2040-40%2040l-48%200c-22.1%200-40-17.9-40-40l0-48c0-22.1%2017.9-40%2040-40zm192%200l48%200c22.1%200%2040%2017.9%2040%2040l0%2048c0%2022.1-17.9%2040-40%2040l-48%200c-22.1%200-40-17.9-40-40l0-48c0-22.1%2017.9-40%2040-40zM40%20320c-22.1%200-40-17.9-40-40l0-48c0-22.1%2017.9-40%2040-40l48%200c22.1%200%2040%2017.9%2040%2040l0%2048c0%2022.1-17.9%2040-40%2040l-48%200zM232%20192l48%200c22.1%200%2040%2017.9%2040%2040l0%2048c0%2022.1-17.9%2040-40%2040l-48%200c-22.1%200-40-17.9-40-40l0-48c0-22.1%2017.9-40%2040-40zM40%20160c-22.1%200-40-17.9-40-40L0%2072C0%2049.9%2017.9%2032%2040%2032l48%200c22.1%200%2040%2017.9%2040%2040l0%2048c0%2022.1-17.9%2040-40%2040l-48%200zM232%2032l48%200c22.1%200%2040%2017.9%2040%2040l0%2048c0%2022.1-17.9%2040-40%2040l-48%200c-22.1%200-40-17.9-40-40l0-48c0-22.1%2017.9-40%2040-40z'/%3e%3c/svg%3e",ar=e=>{const{item:n,type:r,onDoubleClick:i,onDelete:a,canChange:o=!0}=e,{attributes:t,listeners:s,setNodeRef:l,transform:c,isDragging:u}=Qr({id:n.dndId,data:{type:"container",room:n.room}}),d=r==="overlay"?{border:"1px solid black"}:null,p=u?{transform:Ur.Translate.toString(c),opacity:"0",backgroundColor:n?.isFilteredColor?"red":n.group?.color?.value||null,...d}:{backgroundColor:n?.isFilteredColor?"#642626":n.group?.color?.value||null,...d};return f.jsxs("div",{style:p,className:Ve(Pe.draggableContainer,{[Pe.selected]:n.isSelected}),...t,ref:l,onDoubleClick:o?i:null,children:[o&&f.jsxs(f.Fragment,{children:[!!n?.teacher?.name&&f.jsx(Un,{...s,className:Pe.handle}),f.jsx("i",{onClick:()=>a(n.room,n.dndId,n.id),className:Ve("fa-solid  fa-times",Pe.trash)})]}),f.jsx("h1",{children:n.group?.class_name||n.group?.name}),!!n?.subject?.name&&f.jsxs("div",{className:Pe.info,children:[f.jsx("span",{children:n.subject.name}),!!n?.teacher?.name&&f.jsxs("span",{children:[n.teacher?.name," ",n?.teacher?.surname]})]})]})},Jn=e=>{const{rooms:n,hours:r,onDoubleClickContainer:i,onDeleteContainer:a}=e,o=t=>t.map(s=>f.jsx(In,{onDoubleClickContainer:i,onDelete:a,item:s}));return f.jsx("div",{className:ie.tableTuron,children:f.jsxs("div",{className:ie.wrapper,children:[f.jsx("div",{className:ie.header,children:r.map(t=>f.jsxs("div",{className:ie.item,children:[t.start_time,"-",t.end_time]}))}),f.jsx("div",{className:ie.footer,children:n.map(t=>f.jsxs("div",{className:ie.rooms,children:[f.jsx("div",{className:ie.room,children:t.name}),f.jsx("div",{className:ie.containers,children:o(t.lessons)})]}))})]})})},In=e=>{const{item:n,onDoubleClickContainer:r,onDelete:i}=e,a={background:"green",border:"2px solid black"},o=()=>{n.group.name&&n.group.type!=="flow"&&r(n.room,n.dndId)};return f.jsx(sn,{data:{room:n.room,type:"container"},id:n.dndId,disabled:n.isDisabled,extraClass:ie.droppableContainer,overStyle:a,children:!!n.group.name&&f.jsx(ar,{onDelete:i,onDoubleClick:o,item:n})})},ei="_fullscreen_mghar_6",ri="_wrapper_mghar_13",ni="_header_mghar_21",ii="_item_mghar_28",ai="_footer_mghar_37",oi="_rooms_mghar_42",ti="_room_mghar_42",si="_containers_mghar_56",li="_droppableContainer_mghar_61",ae={fullscreen:ei,wrapper:ri,header:ni,item:ii,footer:ai,rooms:oi,room:ti,containers:si,droppableContainer:li};var q=function(e,n){return Number(e.toFixed(n))},ui=function(e,n){return typeof e=="number"?e:n},D=function(e,n,r){r&&typeof r=="function"&&r(e,n)},di=function(e){return-Math.cos(e*Math.PI)/2+.5},ci=function(e){return e},fi=function(e){return e*e},pi=function(e){return e*(2-e)},mi=function(e){return e<.5?2*e*e:-1+(4-2*e)*e},vi=function(e){return e*e*e},hi=function(e){return--e*e*e+1},gi=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},bi=function(e){return e*e*e*e},Si=function(e){return 1- --e*e*e*e},Ti=function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},Ci=function(e){return e*e*e*e*e},wi=function(e){return 1+--e*e*e*e*e},yi=function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},Xr={easeOut:di,linear:ci,easeInQuad:fi,easeOutQuad:pi,easeInOutQuad:mi,easeInCubic:vi,easeOutCubic:hi,easeInOutCubic:gi,easeInQuart:bi,easeOutQuart:Si,easeInOutQuart:Ti,easeInQuint:Ci,easeOutQuint:wi,easeInOutQuint:yi},Er=function(e){typeof e=="number"&&cancelAnimationFrame(e)},Q=function(e){e.mounted&&(Er(e.animation),e.animate=!1,e.animation=null,e.velocity=null)};function Ar(e,n,r,i){if(e.mounted){var a=new Date().getTime(),o=1;Q(e),e.animation=function(){if(!e.mounted)return Er(e.animation);var t=new Date().getTime()-a,s=t/r,l=Xr[n],c=l(s);t>=r?(i(o),e.animation=null):e.animation&&(i(c),requestAnimationFrame(e.animation))},requestAnimationFrame(e.animation)}}function _i(e){var n=e.scale,r=e.positionX,i=e.positionY;return!(Number.isNaN(n)||Number.isNaN(r)||Number.isNaN(i))}function de(e,n,r,i){var a=_i(n);if(!(!e.mounted||!a)){var o=e.setTransformState,t=e.transformState,s=t.scale,l=t.positionX,c=t.positionY,u=n.scale-s,d=n.positionX-l,p=n.positionY-c;r===0?o(n.scale,n.positionX,n.positionY):Ar(e,i,r,function(m){var h=s+u*m,S=l+d*m,T=c+p*m;o(h,S,T)})}}function Pi(e,n,r){var i=e.offsetWidth,a=e.offsetHeight,o=n.offsetWidth,t=n.offsetHeight,s=o*r,l=t*r,c=i-s,u=a-l;return{wrapperWidth:i,wrapperHeight:a,newContentWidth:s,newDiffWidth:c,newContentHeight:l,newDiffHeight:u}}var ji=function(e,n,r,i,a,o,t){var s=e>n?r*(t?1:.5):0,l=i>a?o*(t?1:.5):0,c=e-n-s,u=s,d=i-a-l,p=l;return{minPositionX:c,maxPositionX:u,minPositionY:d,maxPositionY:p}},or=function(e,n){var r=e.wrapperComponent,i=e.contentComponent,a=e.setup.centerZoomedOut;if(!r||!i)throw new Error("Components are not mounted");var o=Pi(r,i,n),t=o.wrapperWidth,s=o.wrapperHeight,l=o.newContentWidth,c=o.newDiffWidth,u=o.newContentHeight,d=o.newDiffHeight,p=ji(t,l,c,s,u,d,!!a);return p},er=function(e,n,r,i){return i?e<n?q(n,2):e>r?q(r,2):q(e,2):q(e,2)},fe=function(e,n){var r=or(e,n);return e.bounds=r,r};function Xe(e,n,r,i,a,o,t){var s=r.minPositionX,l=r.minPositionY,c=r.maxPositionX,u=r.maxPositionY,d=0,p=0;t&&(d=a,p=o);var m=er(e,s-d,c+d,i),h=er(n,l-p,u+p,i);return{x:m,y:h}}function He(e,n,r,i,a,o){var t=e.transformState,s=t.scale,l=t.positionX,c=t.positionY,u=i-s;if(typeof n!="number"||typeof r!="number")return console.error("Mouse X and Y position were not provided!"),{x:l,y:c};var d=l-n*u,p=c-r*u,m=Xe(d,p,a,o,0,0,null);return m}function Ee(e,n,r,i,a){var o=a?i:0,t=n-o;return!Number.isNaN(r)&&e>=r?r:!Number.isNaN(n)&&e<=t?t:e}var pr=function(e,n){var r=e.setup.panning.excluded,i=e.isInitialized,a=e.wrapperComponent,o=n.target,t="shadowRoot"in o&&"composedPath"in n,s=t?n.composedPath().some(function(u){return u instanceof Element?a?.contains(u):!1}):a?.contains(o),l=i&&o&&s;if(!l)return!1;var c=Re(o,r);return!c},mr=function(e){var n=e.isInitialized,r=e.isPanning,i=e.setup,a=i.panning.disabled,o=n&&r&&!a;return!!o},Yi=function(e,n){var r=e.transformState,i=r.positionX,a=r.positionY;e.isPanning=!0;var o=n.clientX,t=n.clientY;e.startCoords={x:o-i,y:t-a}},Di=function(e,n){var r=n.touches,i=e.transformState,a=i.positionX,o=i.positionY;e.isPanning=!0;var t=r.length===1;if(t){var s=r[0].clientX,l=r[0].clientY;e.startCoords={x:s-a,y:l-o}}};function Xi(e){var n=e.transformState,r=n.positionX,i=n.positionY,a=n.scale,o=e.setup,t=o.disabled,s=o.limitToBounds,l=o.centerZoomedOut,c=e.wrapperComponent;if(!(t||!c||!e.bounds)){var u=e.bounds,d=u.maxPositionX,p=u.minPositionX,m=u.maxPositionY,h=u.minPositionY,S=r>d||r<p,T=i>m||i<h,X=r>d?c.offsetWidth:e.setup.minPositionX||0,j=i>m?c.offsetHeight:e.setup.minPositionY||0,g=He(e,X,j,a,e.bounds,s||l),R=g.x,Z=g.y;return{scale:a,positionX:S?R:r,positionY:T?Z:i}}}function Nr(e,n,r,i,a){var o=e.setup.limitToBounds,t=e.wrapperComponent,s=e.bounds,l=e.transformState,c=l.scale,u=l.positionX,d=l.positionY;if(!(t===null||s===null||n===u&&r===d)){var p=Xe(n,r,s,o,i,a,t),m=p.x,h=p.y;e.setTransformState(c,m,h)}}var Ei=function(e,n,r){var i=e.startCoords,a=e.transformState,o=e.setup.panning,t=o.lockAxisX,s=o.lockAxisY,l=a.positionX,c=a.positionY;if(!i)return{x:l,y:c};var u=n-i.x,d=r-i.y,p=t?l:u,m=s?c:d;return{x:p,y:m}},le=function(e,n){var r=e.setup,i=e.transformState,a=i.scale,o=r.minScale,t=r.disablePadding;return n>0&&a>=o&&!t?n:0},Ai=function(e){var n=e.mounted,r=e.setup,i=r.disabled,a=r.velocityAnimation,o=e.transformState.scale,t=a.disabled,s=!t||o>1||!i||n;return!!s},Ni=function(e){var n=e.mounted,r=e.velocity,i=e.bounds,a=e.setup,o=a.disabled,t=a.velocityAnimation,s=e.transformState.scale,l=t.disabled,c=!l||s>1||!o||n;return!(!c||!r||!i)};function zi(e,n){var r=e.setup.velocityAnimation,i=r.equalToMove,a=r.animationTime,o=r.sensitivity;return i?a*n*o:a}function vr(e,n,r,i,a,o,t,s,l,c){if(a){if(n>t&&r>t){var u=t+(e-t)*c;return u>l?l:u<t?t:u}if(n<o&&r<o){var u=o+(e-o)*c;return u<s?s:u>o?o:u}}return i?n:er(e,o,t,a)}function ki(e,n){var r=1;return n?Math.min(r,e.offsetWidth/window.innerWidth):r}function Oi(e,n){var r=Ai(e);if(r){var i=e.lastMousePosition,a=e.velocityTime,o=e.setup,t=e.wrapperComponent,s=o.velocityAnimation.equalToMove,l=Date.now();if(i&&a&&t){var c=ki(t,s),u=n.x-i.x,d=n.y-i.y,p=u/c,m=d/c,h=l-a,S=u*u+d*d,T=Math.sqrt(S)/h;e.velocity={velocityX:p,velocityY:m,total:T}}e.lastMousePosition=n,e.velocityTime=l}}function Wi(e){var n=e.velocity,r=e.bounds,i=e.setup,a=e.wrapperComponent,o=Ni(e);if(!(!o||!n||!r||!a)){var t=n.velocityX,s=n.velocityY,l=n.total,c=r.maxPositionX,u=r.minPositionX,d=r.maxPositionY,p=r.minPositionY,m=i.limitToBounds,h=i.alignmentAnimation,S=i.zoomAnimation,T=i.panning,X=T.lockAxisY,j=T.lockAxisX,g=S.animationType,R=h.sizeX,Z=h.sizeY,w=h.velocityAlignmentTime,V=w,M=zi(e,l),W=Math.max(M,V),I=le(e,R),F=le(e,Z),ee=I*a.offsetWidth/100,me=F*a.offsetHeight/100,Te=c+ee,oe=u-ee,ve=d+me,Ce=p-me,we=e.transformState,ye=new Date().getTime();Ar(e,g,W,function(Ae){var ne=e.transformState,x=ne.scale,z=ne.positionX,H=ne.positionY,xe=new Date().getTime()-ye,he=xe/V,Ke=Xr[h.animationType],_e=1-Ke(Math.min(1,he)),Ne=1-Ae,ze=z+t*Ne,ge=H+s*Ne,qe=vr(ze,we.positionX,z,j,m,u,c,oe,Te,_e),Ge=vr(ge,we.positionY,H,X,m,p,d,Ce,ve,_e);(z!==ze||H!==ge)&&e.setTransformState(x,qe,Ge)})}}function hr(e,n){var r=e.transformState.scale;Q(e),fe(e,r),window.TouchEvent!==void 0&&n instanceof TouchEvent?Di(e,n):Yi(e,n)}function tr(e,n){var r=e.transformState.scale,i=e.setup,a=i.minScale,o=i.alignmentAnimation,t=o.disabled,s=o.sizeX,l=o.sizeY,c=o.animationTime,u=o.animationType,d=t||r<a||!s&&!l;if(!d){var p=Xi(e);p&&de(e,p,n??c,u)}}function gr(e,n,r){var i=e.startCoords,a=e.setup,o=a.alignmentAnimation,t=o.sizeX,s=o.sizeY;if(i){var l=Ei(e,n,r),c=l.x,u=l.y,d=le(e,t),p=le(e,s);Oi(e,{x:c,y:u}),Nr(e,c,u,d,p)}}function $i(e){if(e.isPanning){var n=e.setup.panning.velocityDisabled,r=e.velocity,i=e.wrapperComponent,a=e.contentComponent;e.isPanning=!1,e.animate=!1,e.animation=null;var o=i?.getBoundingClientRect(),t=a?.getBoundingClientRect(),s=o?.width||0,l=o?.height||0,c=t?.width||0,u=t?.height||0,d=s<c||l<u,p=!n&&r&&r?.total>.1&&d;p?Wi(e):tr(e)}}function sr(e,n,r,i){var a=e.setup,o=a.minScale,t=a.maxScale,s=a.limitToBounds,l=Ee(q(n,2),o,t,0,!1),c=fe(e,l),u=He(e,r,i,l,c,s),d=u.x,p=u.y;return{scale:l,positionX:d,positionY:p}}function zr(e,n,r){var i=e.transformState.scale,a=e.wrapperComponent,o=e.setup,t=o.minScale,s=o.limitToBounds,l=o.zoomAnimation,c=l.disabled,u=l.animationTime,d=l.animationType,p=c||i>=t;if((i>=1||s)&&tr(e),!(p||!a||!e.mounted)){var m=n||a.offsetWidth/2,h=r||a.offsetHeight/2,S=sr(e,t,m,h);S&&de(e,S,u,d)}}var te=function(){return te=Object.assign||function(n){for(var r,i=1,a=arguments.length;i<a;i++){r=arguments[i];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},te.apply(this,arguments)};function br(e,n,r){for(var i=0,a=n.length,o;i<a;i++)(o||!(i in n))&&(o||(o=Array.prototype.slice.call(n,0,i)),o[i]=n[i]);return e.concat(o||Array.prototype.slice.call(n))}var We={scale:1,positionX:0,positionY:0},je={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},rr={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},kr=function(e){var n,r,i,a;return{previousScale:(n=e.initialScale)!==null&&n!==void 0?n:We.scale,scale:(r=e.initialScale)!==null&&r!==void 0?r:We.scale,positionX:(i=e.initialPositionX)!==null&&i!==void 0?i:We.positionX,positionY:(a=e.initialPositionY)!==null&&a!==void 0?a:We.positionY}},Sr=function(e){var n=te({},je);return Object.keys(e).forEach(function(r){var i=typeof e[r]<"u",a=typeof je[r]<"u";if(a&&i){var o=Object.prototype.toString.call(je[r]),t=o==="[object Object]",s=o==="[object Array]";t?n[r]=te(te({},je[r]),e[r]):s?n[r]=br(br([],je[r],!0),e[r]):n[r]=e[r]}}),n},Or=function(e,n,r){var i=e.transformState.scale,a=e.wrapperComponent,o=e.setup,t=o.maxScale,s=o.minScale,l=o.zoomAnimation,c=o.smooth,u=l.size;if(!a)throw new Error("Wrapper is not mounted");var d=c?i*Math.exp(n*r):i+n*r,p=Ee(q(d,3),s,t,u,!1);return p};function Wr(e,n,r,i,a){var o=e.wrapperComponent,t=e.transformState,s=t.scale,l=t.positionX,c=t.positionY;if(!o)return console.error("No WrapperComponent found");var u=o.offsetWidth,d=o.offsetHeight,p=(u/2-l)/s,m=(d/2-c)/s,h=Or(e,n,r),S=sr(e,h,p,m);if(!S)return console.error("Error during zoom event. New transformation state was not calculated.");de(e,S,i,a)}function $r(e,n,r,i){var a=e.setup,o=e.wrapperComponent,t=a.limitToBounds,s=kr(e.props),l=e.transformState,c=l.scale,u=l.positionX,d=l.positionY;if(o){var p=or(e,s.scale),m=Xe(s.positionX,s.positionY,p,t,0,0,o),h={scale:s.scale,positionX:m.x,positionY:m.y};c===s.scale&&u===s.positionX&&d===s.positionY||(i?.(),de(e,h,n,r))}}function Li(e,n,r,i){var a=e.getBoundingClientRect(),o=n.getBoundingClientRect(),t=r.getBoundingClientRect(),s=o.x*i.scale,l=o.y*i.scale;return{x:(a.x-t.x+s)/i.scale,y:(a.y-t.y+l)/i.scale}}function Bi(e,n,r){var i=e.wrapperComponent,a=e.contentComponent,o=e.transformState,t=e.setup,s=t.limitToBounds,l=t.minScale,c=t.maxScale;if(!i||!a)return o;var u=i.getBoundingClientRect(),d=n.getBoundingClientRect(),p=Li(n,i,a,o),m=p.x,h=p.y,S=d.width/o.scale,T=d.height/o.scale,X=i.offsetWidth/S,j=i.offsetHeight/T,g=Ee(r||Math.min(X,j),l,c,0,!1),R=(u.width-S*g)/2,Z=(u.height-T*g)/2,w=(u.left-m)*g+R,V=(u.top-h)*g+Z,M=or(e,g),W=Xe(w,V,M,s,0,0,i),I=W.x,F=W.y;return{positionX:I,positionY:F,scale:g}}var Mi=function(e){return function(n,r,i){n===void 0&&(n=.5),r===void 0&&(r=300),i===void 0&&(i="easeOut"),Wr(e,1,n,r,i)}},Zi=function(e){return function(n,r,i){n===void 0&&(n=.5),r===void 0&&(r=300),i===void 0&&(i="easeOut"),Wr(e,-1,n,r,i)}},Fi=function(e){return function(n,r,i,a,o){a===void 0&&(a=300),o===void 0&&(o="easeOut");var t=e.transformState,s=t.positionX,l=t.positionY,c=t.scale,u=e.wrapperComponent,d=e.contentComponent,p=e.setup.disabled;if(!(p||!u||!d)){var m={positionX:Number.isNaN(n)?s:n,positionY:Number.isNaN(r)?l:r,scale:Number.isNaN(i)?c:i};de(e,m,a,o)}}},Vi=function(e){return function(n,r){n===void 0&&(n=200),r===void 0&&(r="easeOut"),$r(e,n,r)}},Hi=function(e){return function(n,r,i){r===void 0&&(r=200),i===void 0&&(i="easeOut");var a=e.transformState,o=e.wrapperComponent,t=e.contentComponent;if(o&&t){var s=Lr(n||a.scale,o,t);de(e,s,r,i)}}},Ri=function(e){return function(n,r,i,a){i===void 0&&(i=600),a===void 0&&(a="easeOut"),Q(e);var o=e.wrapperComponent,t=typeof n=="string"?document.getElementById(n):n;if(o&&t&&o.contains(t)){var s=Bi(e,t,r);de(e,s,i,a)}}},nr=function(e){return{instance:e,zoomIn:Mi(e),zoomOut:Zi(e),setTransform:Fi(e),resetTransform:Vi(e),centerView:Hi(e),zoomToElement:Ri(e)}},xi=function(e){return{instance:e,state:e.transformState}},P=function(e){var n={};return Object.assign(n,xi(e)),Object.assign(n,nr(e)),n},Je=!1;function Ie(){try{var e={get passive(){return Je=!0,!1}};return e}catch{return Je=!1,Je}}var $e=".".concat(rr.wrapperClass),Re=function(e,n){return n.some(function(r){return e.matches("".concat($e," ").concat(r,", ").concat($e," .").concat(r,", ").concat($e," ").concat(r," *, ").concat($e," .").concat(r," *"))})},ir=function(e){e&&clearTimeout(e)},Ki=function(e,n,r){return"translate(".concat(e,"px, ").concat(n,"px) scale(").concat(r,")")},Lr=function(e,n,r){var i=r.offsetWidth*e,a=r.offsetHeight*e,o=(n.offsetWidth-i)/2,t=(n.offsetHeight-a)/2;return{scale:e,positionX:o,positionY:t}};function qi(e){return function(n){e.forEach(function(r){typeof r=="function"?r(n):r!=null&&(r.current=n)})}}var Gi=function(e,n){var r=e.setup.wheel,i=r.disabled,a=r.wheelDisabled,o=r.touchPadDisabled,t=r.excluded,s=e.isInitialized,l=e.isPanning,c=n.target,u=s&&!l&&!i&&c;if(!u||a&&!n.ctrlKey||o&&n.ctrlKey)return!1;var d=Re(c,t);return!d},Qi=function(e){return e?e.deltaY<0?1:-1:0};function Ui(e,n){var r=Qi(e),i=ui(n,r);return i}function Br(e,n,r){var i=n.getBoundingClientRect(),a=0,o=0;if("clientX"in e)a=(e.clientX-i.left)/r,o=(e.clientY-i.top)/r;else{var t=e.touches[0];a=(t.clientX-i.left)/r,o=(t.clientY-i.top)/r}return(Number.isNaN(a)||Number.isNaN(o))&&console.error("No mouse or touch offset found"),{x:a,y:o}}var Ji=function(e,n,r,i,a){var o=e.transformState.scale,t=e.wrapperComponent,s=e.setup,l=s.maxScale,c=s.minScale,u=s.zoomAnimation,d=s.disablePadding,p=u.size,m=u.disabled;if(!t)throw new Error("Wrapper is not mounted");var h=o+n*r,S=i?!1:!m,T=Ee(q(h,3),c,l,p,S&&!d);return T},Ii=function(e,n){var r=e.previousWheelEvent,i=e.transformState.scale,a=e.setup,o=a.maxScale,t=a.minScale;return r?i<o||i>t||Math.sign(r.deltaY)!==Math.sign(n.deltaY)||r.deltaY>0&&r.deltaY<n.deltaY||r.deltaY<0&&r.deltaY>n.deltaY||Math.sign(r.deltaY)!==Math.sign(n.deltaY):!1},ea=function(e,n){var r=e.setup.pinch,i=r.disabled,a=r.excluded,o=e.isInitialized,t=n.target,s=o&&!i&&t;if(!s)return!1;var l=Re(t,a);return!l},ra=function(e){var n=e.setup.pinch.disabled,r=e.isInitialized,i=e.pinchStartDistance,a=r&&!n&&i;return!!a},na=function(e,n,r){var i=r.getBoundingClientRect(),a=e.touches,o=q(a[0].clientX-i.left,5),t=q(a[0].clientY-i.top,5),s=q(a[1].clientX-i.left,5),l=q(a[1].clientY-i.top,5);return{x:(o+s)/2/n,y:(t+l)/2/n}},Mr=function(e){return Math.sqrt(Math.pow(e.touches[0].pageX-e.touches[1].pageX,2)+Math.pow(e.touches[0].pageY-e.touches[1].pageY,2))},ia=function(e,n){var r=e.pinchStartScale,i=e.pinchStartDistance,a=e.setup,o=a.maxScale,t=a.minScale,s=a.zoomAnimation,l=a.disablePadding,c=s.size,u=s.disabled;if(!r||i===null||!n)throw new Error("Pinch touches distance was not provided");if(n<0)return e.transformState.scale;var d=n/i,p=d*r;return Ee(q(p,2),t,o,c,!u&&!l)},aa=160,oa=100,ta=function(e,n){var r=e.props,i=r.onWheelStart,a=r.onZoomStart;e.wheelStopEventTimer||(Q(e),D(P(e),n,i),D(P(e),n,a))},sa=function(e,n){var r=e.props,i=r.onWheel,a=r.onZoom,o=e.contentComponent,t=e.setup,s=e.transformState,l=s.scale,c=t.limitToBounds,u=t.centerZoomedOut,d=t.zoomAnimation,p=t.wheel,m=t.disablePadding,h=t.smooth,S=d.size,T=d.disabled,X=p.step,j=p.smoothStep;if(!o)throw new Error("Component not mounted");n.preventDefault(),n.stopPropagation();var g=Ui(n,null),R=h?j*Math.abs(n.deltaY):X,Z=Ji(e,g,R,!n.ctrlKey);if(l!==Z){var w=fe(e,Z),V=Br(n,o,l),M=T||S===0||u||m,W=c&&M,I=He(e,V.x,V.y,Z,w,W),F=I.x,ee=I.y;e.previousWheelEvent=n,e.setTransformState(Z,F,ee),D(P(e),n,i),D(P(e),n,a)}},la=function(e,n){var r=e.props,i=r.onWheelStop,a=r.onZoomStop;ir(e.wheelAnimationTimer),e.wheelAnimationTimer=setTimeout(function(){e.mounted&&(zr(e,n.x,n.y),e.wheelAnimationTimer=null)},oa);var o=Ii(e,n);o&&(ir(e.wheelStopEventTimer),e.wheelStopEventTimer=setTimeout(function(){e.mounted&&(e.wheelStopEventTimer=null,D(P(e),n,i),D(P(e),n,a))},aa))},Zr=function(e){for(var n=0,r=0,i=0;i<2;i+=1)n+=e.touches[i].clientX,r+=e.touches[i].clientY;var a=n/2,o=r/2;return{x:a,y:o}},ua=function(e,n){var r=Mr(n);e.pinchStartDistance=r,e.lastDistance=r,e.pinchStartScale=e.transformState.scale,e.isPanning=!1;var i=Zr(n);e.pinchLastCenterX=i.x,e.pinchLastCenterY=i.y,Q(e)},da=function(e,n){var r=e.contentComponent,i=e.pinchStartDistance,a=e.wrapperComponent,o=e.transformState.scale,t=e.setup,s=t.limitToBounds,l=t.centerZoomedOut,c=t.zoomAnimation,u=t.alignmentAnimation,d=c.disabled,p=c.size;if(!(i===null||!r)){var m=na(n,o,r);if(!(!Number.isFinite(m.x)||!Number.isFinite(m.y))){var h=Mr(n),S=ia(e,h),T=Zr(n),X=T.x-(e.pinchLastCenterX||0),j=T.y-(e.pinchLastCenterY||0);if(!(S===o&&X===0&&j===0)){e.pinchLastCenterX=T.x,e.pinchLastCenterY=T.y;var g=fe(e,S),R=d||p===0||l,Z=s&&R,w=He(e,m.x,m.y,S,g,Z),V=w.x,M=w.y;e.pinchMidpoint=m,e.lastDistance=h;var W=u.sizeX,I=u.sizeY,F=le(e,W),ee=le(e,I),me=V+X,Te=M+j,oe=Xe(me,Te,g,s,F,ee,a),ve=oe.x,Ce=oe.y;e.setTransformState(S,ve,Ce)}}}},ca=function(e){var n=e.pinchMidpoint;e.velocity=null,e.lastDistance=null,e.pinchMidpoint=null,e.pinchStartScale=null,e.pinchStartDistance=null,zr(e,n?.x,n?.y)},Fr=function(e,n){var r=e.props.onZoomStop,i=e.setup.doubleClick.animationTime;ir(e.doubleClickStopEventTimer),e.doubleClickStopEventTimer=setTimeout(function(){e.doubleClickStopEventTimer=null,D(P(e),n,r)},i)},fa=function(e,n){var r=e.props,i=r.onZoomStart,a=r.onZoom,o=e.setup.doubleClick,t=o.animationTime,s=o.animationType;D(P(e),n,i),$r(e,t,s,function(){return D(P(e),n,a)}),Fr(e,n)};function pa(e,n){return e==="toggle"?n===1?1:-1:e==="zoomOut"?-1:1}function ma(e,n){var r=e.setup,i=e.doubleClickStopEventTimer,a=e.transformState,o=e.contentComponent,t=a.scale,s=e.props,l=s.onZoomStart,c=s.onZoom,u=r.doubleClick,d=u.disabled,p=u.mode,m=u.step,h=u.animationTime,S=u.animationType;if(!d&&!i){if(p==="reset")return fa(e,n);if(!o)return console.error("No ContentComponent found");var T=pa(p,e.transformState.scale),X=Or(e,T,m);if(t!==X){D(P(e),n,l);var j=Br(n,o,t),g=sr(e,X,j.x,j.y);if(!g)return console.error("Error during zoom event. New transformation state was not calculated.");D(P(e),n,c),de(e,g,h,S),Fr(e,n)}}}var va=function(e,n){var r=e.isInitialized,i=e.setup,a=e.wrapperComponent,o=i.doubleClick,t=o.disabled,s=o.excluded,l=n.target,c=a?.contains(l),u=r&&l&&c&&!t;if(!u)return!1;var d=Re(l,s);return!d},ha=function(){function e(n){var r=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){r.initializeWindowEvents()},this.unmount=function(){r.cleanupWindowEvents()},this.update=function(i){r.props=i,fe(r,r.transformState.scale),r.setup=Sr(i)},this.initializeWindowEvents=function(){var i,a,o=Ie(),t=(i=r.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,s=t?.defaultView;(a=r.wrapperComponent)===null||a===void 0||a.addEventListener("wheel",r.onWheelPanning,o),s?.addEventListener("mousedown",r.onPanningStart,o),s?.addEventListener("mousemove",r.onPanning,o),s?.addEventListener("mouseup",r.onPanningStop,o),t?.addEventListener("mouseleave",r.clearPanning,o),s?.addEventListener("keyup",r.setKeyUnPressed,o),s?.addEventListener("keydown",r.setKeyPressed,o)},this.cleanupWindowEvents=function(){var i,a,o=Ie(),t=(i=r.wrapperComponent)===null||i===void 0?void 0:i.ownerDocument,s=t?.defaultView;s?.removeEventListener("mousedown",r.onPanningStart,o),s?.removeEventListener("mousemove",r.onPanning,o),s?.removeEventListener("mouseup",r.onPanningStop,o),t?.removeEventListener("mouseleave",r.clearPanning,o),s?.removeEventListener("keyup",r.setKeyUnPressed,o),s?.removeEventListener("keydown",r.setKeyPressed,o),document.removeEventListener("mouseleave",r.clearPanning,o),Q(r),(a=r.observer)===null||a===void 0||a.disconnect()},this.handleInitializeWrapperEvents=function(i){var a=Ie();i.addEventListener("wheel",r.onWheelZoom,a),i.addEventListener("dblclick",r.onDoubleClick,a),i.addEventListener("touchstart",r.onTouchPanningStart,a),i.addEventListener("touchmove",r.onTouchPanning,a),i.addEventListener("touchend",r.onTouchPanningStop,a)},this.handleInitialize=function(i,a){var o=!1,t=r.setup.centerOnInit,s=function(l,c){for(var u=0,d=l;u<d.length;u++){var p=d[u];if(p.target===c)return!0}return!1};r.applyTransformation(),r.onInitCallbacks.forEach(function(l){l(P(r))}),r.observer=new ResizeObserver(function(l){if(s(l,i)||s(l,a))if(t&&!o){var c=a.offsetWidth,u=a.offsetHeight;(c>0||u>0)&&(o=!0,r.setCenter())}else Q(r),fe(r,r.transformState.scale),tr(r,0)}),r.observer.observe(i),r.observer.observe(a)},this.onWheelZoom=function(i){var a=r.setup.disabled;if(!a){var o=Gi(r,i);if(o){var t=r.isPressingKeys(r.setup.wheel.activationKeys);t&&(ta(r,i),sa(r,i),la(r,i))}}},this.onWheelPanning=function(i){var a=r.setup,o=a.disabled,t=a.wheel,s=a.panning;if(!(!r.wrapperComponent||!r.contentComponent||o||!t.wheelDisabled||s.disabled||!s.wheelPanning||i.ctrlKey)){i.preventDefault(),i.stopPropagation();var l=r.transformState,c=l.positionX,u=l.positionY,d=c-i.deltaX,p=u-i.deltaY,m=s.lockAxisX?c:d,h=s.lockAxisY?u:p,S=r.setup.alignmentAnimation,T=S.sizeX,X=S.sizeY,j=le(r,T),g=le(r,X);m===c&&h===u||Nr(r,m,h,j,g)}},this.onPanningStart=function(i){var a=r.setup.disabled,o=r.props.onPanningStart;if(!a){var t=pr(r,i);if(t){var s=r.isPressingKeys(r.setup.panning.activationKeys);s&&(i.button===0&&!r.setup.panning.allowLeftClickPan||i.button===1&&!r.setup.panning.allowMiddleClickPan||i.button===2&&!r.setup.panning.allowRightClickPan||(i.preventDefault(),i.stopPropagation(),Q(r),hr(r,i),D(P(r),i,o)))}}},this.onPanning=function(i){var a=r.setup.disabled,o=r.props.onPanning;if(!a){var t=mr(r);if(t){var s=r.isPressingKeys(r.setup.panning.activationKeys);s&&(i.preventDefault(),i.stopPropagation(),gr(r,i.clientX,i.clientY),D(P(r),i,o))}}},this.onPanningStop=function(i){var a=r.props.onPanningStop;r.isPanning&&($i(r),D(P(r),i,a))},this.onPinchStart=function(i){var a=r.setup.disabled,o=r.props,t=o.onPinchingStart,s=o.onZoomStart;if(!a){var l=ea(r,i);l&&(ua(r,i),Q(r),D(P(r),i,t),D(P(r),i,s))}},this.onPinch=function(i){var a=r.setup.disabled,o=r.props,t=o.onPinching,s=o.onZoom;if(!a){var l=ra(r);l&&(i.preventDefault(),i.stopPropagation(),da(r,i),D(P(r),i,t),D(P(r),i,s))}},this.onPinchStop=function(i){var a=r.props,o=a.onPinchingStop,t=a.onZoomStop;r.pinchStartScale&&(ca(r),D(P(r),i,o),D(P(r),i,t))},this.onTouchPanningStart=function(i){var a=r.setup.disabled,o=r.props.onPanningStart;if(!a){var t=pr(r,i);if(t){var s=r.lastTouch&&+new Date-r.lastTouch<200&&i.touches.length===1;if(!s){r.lastTouch=+new Date,Q(r);var l=i.touches,c=l.length===1,u=l.length===2;c&&(Q(r),hr(r,i),D(P(r),i,o)),u&&r.onPinchStart(i)}}}},this.onTouchPanning=function(i){var a=r.setup.disabled,o=r.props.onPanning;if(r.isPanning&&i.touches.length===1){if(a)return;var t=mr(r);if(!t)return;i.preventDefault(),i.stopPropagation();var s=i.touches[0];gr(r,s.clientX,s.clientY),D(P(r),i,o)}else i.touches.length>1&&r.onPinch(i)},this.onTouchPanningStop=function(i){r.onPanningStop(i),r.onPinchStop(i)},this.onDoubleClick=function(i){var a=r.setup.disabled;if(!a){var o=va(r,i);o&&ma(r,i)}},this.clearPanning=function(i){r.isPanning&&r.onPanningStop(i)},this.setKeyPressed=function(i){r.pressedKeys[i.key]=!0},this.setKeyUnPressed=function(i){r.pressedKeys[i.key]=!1},this.isPressingKeys=function(i){return i.length?!!i.find(function(a){return r.pressedKeys[a]}):!0},this.setTransformState=function(i,a,o){var t=r.props.onTransformed;if(!Number.isNaN(i)&&!Number.isNaN(a)&&!Number.isNaN(o)){i!==r.transformState.scale&&(r.transformState.previousScale=r.transformState.scale,r.transformState.scale=i),r.transformState.positionX=a,r.transformState.positionY=o,r.applyTransformation();var s=P(r);r.onChangeCallbacks.forEach(function(l){return l(s)}),D(s,{scale:i,positionX:a,positionY:o},t)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(r.wrapperComponent&&r.contentComponent){var i=Lr(r.transformState.scale,r.wrapperComponent,r.contentComponent);r.setTransformState(i.scale,i.positionX,i.positionY)}},this.handleTransformStyles=function(i,a,o){return r.props.customTransform?r.props.customTransform(i,a,o):Ki(i,a,o)},this.applyTransformation=function(){if(!(!r.mounted||!r.contentComponent)){var i=r.transformState,a=i.scale,o=i.positionX,t=i.positionY,s=r.handleTransformStyles(o,t,a);r.contentComponent.style.transform=s}},this.getContext=function(){return P(r)},this.onChange=function(i){return r.onChangeCallbacks.has(i)||r.onChangeCallbacks.add(i),function(){r.onChangeCallbacks.delete(i)}},this.onInit=function(i){return r.onInitCallbacks.has(i)||r.onInitCallbacks.add(i),function(){r.onInitCallbacks.delete(i)}},this.init=function(i,a){r.cleanupWindowEvents(),r.wrapperComponent=i,r.contentComponent=a,fe(r,r.transformState.scale),r.handleInitializeWrapperEvents(i),r.handleInitialize(i,a),r.initializeWindowEvents(),r.isInitialized=!0;var o=P(r);D(o,void 0,r.props.onInit)},this.props=n,this.setup=Sr(this.props),this.transformState=kr(this.props)}return e}(),lr=se.createContext(null),ga=function(e,n){return typeof e=="function"?e(n):e},Vr=se.forwardRef(function(e,n){var r=b.useRef(new ha(e)).current,i=ga(e.children,nr(r));return b.useImperativeHandle(n,function(){return nr(r)},[r]),b.useEffect(function(){r.update(e)},[r,e]),se.createElement(lr.Provider,{value:r},i)});se.forwardRef(function(e,n){var r=b.useRef(null),i=b.useContext(lr);return b.useEffect(function(){return i.onChange(function(a){if(r.current){var o=0,t=0;r.current.style.transform=i.handleTransformStyles(o,t,1/a.instance.transformState.scale)}})},[i]),se.createElement("div",te({},e,{ref:qi([r,n])}))});function ba(e,n){n===void 0&&(n={});var r=n.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",r==="top"&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var Sa=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,Tr={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};ba(Sa);var Hr=function(e){var n=e.children,r=e.wrapperClass,i=r===void 0?"":r,a=e.contentClass,o=a===void 0?"":a,t=e.wrapperStyle,s=e.contentStyle,l=e.wrapperProps,c=l===void 0?{}:l,u=e.contentProps,d=u===void 0?{}:u,p=b.useContext(lr),m=p.init,h=p.cleanupWindowEvents,S=b.useRef(null),T=b.useRef(null);return b.useEffect(function(){var X=S.current,j=T.current;return X!==null&&j!==null&&m&&m?.(X,j),function(){h?.()}},[]),se.createElement("div",te({},c,{ref:S,className:"".concat(rr.wrapperClass," ").concat(Tr.wrapper," ").concat(i),style:t}),se.createElement("div",te({},d,{ref:T,className:"".concat(rr.contentClass," ").concat(Tr.content," ").concat(o),style:s}),n))};const Ta=e=>{const{rooms:n,hours:r}=e,i=s=>s.map(l=>f.jsx(Ca,{item:l})),[a,o]=b.useState();function t(s){o(s.instance.transformState.scale)}return f.jsx("div",{className:ae.fullscreen,children:f.jsx(Vr,{onTransformed:s=>t(s),initialScale:1,doubleClick:{disabled:!0},minScale:.2,maxScale:5,panning:{activationKeys:[],excluded:[]},pinch:{excluded:[]},children:f.jsx("div",{className:ae.wrapper,children:f.jsxs(Hr,{wrapperStyle:{width:"100%",height:"100%"},children:[f.jsx("div",{className:ae.header,children:r.map(s=>f.jsx("div",{className:ae.item,children:f.jsxs("span",{style:{transform:`scale(${1/a})`},children:[s.start_time,"-",s.end_time]})}))}),f.jsx("div",{className:ae.footer,children:n.map(s=>f.jsxs("div",{className:ae.rooms,children:[f.jsx("div",{className:ae.room,children:f.jsx("span",{style:{transform:`scale(${1/a})`},children:s.name})}),f.jsx("div",{className:ae.containers,children:i(s.lessons)})]}))})]})})})})},Ca=e=>{const{item:n}=e;return f.jsx("div",{className:ae.droppableContainer,children:!!n.group.name&&f.jsx(ar,{canChange:!1,item:n})})},wa="_fullscreen_1fovm_6",ya="_wrapper_1fovm_19",_a="_header_1fovm_26",Pa="_item_1fovm_33",ja="_footer_1fovm_42",Ya="_rooms_1fovm_47",Da="_room_1fovm_47",Xa="_containers_1fovm_61",Ea="_droppableContainer_1fovm_66",Aa="_draggableContainer_1fovm_73",Na="_isFlow_1fovm_83",za="_info_1fovm_94",K={fullscreen:wa,wrapper:ya,header:_a,item:Pa,footer:ja,rooms:Ya,room:Da,containers:Xa,droppableContainer:Ea,draggableContainer:Aa,isFlow:Na,info:za};function ka(e){e=e.replace(/^#/,"");let n=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),i=parseInt(e.substring(4,6),16);return .299*n+.587*r+.114*i}const Oa=e=>{const{lessons:n,hours:r}=e,[i,a]=b.useState([]),[o,t]=b.useState(!1);b.useEffect(()=>{if(n?.length){const d=[];for(let p=0;p<n.length;p++){const m=n[p];for(let h=0;h<m.lessons.length;h++){const S=m.lessons[h];S.is_flow&&(d.some(T=>T.flow===S.group.id)||d.push({group:m.id,flow:S.group.id}))}}a(d),t(!0)}},[n]);const s=b.useCallback((d,p)=>{if(o&&d.length)return d.map(m=>m.is_flow?f.jsx(Cr,{isFlow:!0,canRender:i.some(h=>h.flow===m.group.id&&h.group===p),renderedFlows:i,setRenderedFlows:a,item:m}):f.jsx(Cr,{renderedFlows:i,setRenderedFlows:a,item:m}))},[o]),[l,c]=b.useState();function u(d){c(d.instance.transformState.scale)}return console.log(n,"lessons"),f.jsx("div",{className:K.fullscreen,children:f.jsx(Vr,{onTransformed:d=>u(d),initialScale:.6,doubleClick:{disabled:!0},minScale:.2,maxScale:5,panning:{activationKeys:[],excluded:[]},pinch:{excluded:[]},children:f.jsx("div",{className:K.wrapper,children:f.jsxs(Hr,{wrapperStyle:{width:"100%",height:"100%"},children:[f.jsx("div",{className:K.header,children:r?.map(d=>f.jsx("div",{className:K.item,children:f.jsxs("span",{style:{transform:`scale(${1/l})`},children:[d.start_time,"-",d.end_time]})}))}),f.jsx("div",{className:K.footer,children:n?.map(d=>f.jsxs("div",{className:K.rooms,children:[f.jsx("div",{className:K.room,style:{backgroundColor:`${d.color}`,color:ka(d.color)>125?"black":"white"},children:f.jsx("span",{style:{transform:`scale(${1/l})`},children:d.name})}),f.jsx("div",{className:K.containers,children:s(d.lessons,d.id)})]}))})]})})})})},Cr=e=>{const{item:n,isFlow:r,canRender:i}=e,a=r&&{height:n.group.classes.length*70+"px",position:"absolute",zIndex:20};return r&&!i?f.jsx("div",{className:K.droppableContainer}):f.jsx("div",{className:K.droppableContainer,children:!!n.group.name&&f.jsxs("div",{style:a,className:Ve(K.draggableContainer,{[K.isFlow]:r}),children:[f.jsxs("h1",{children:[" ",r?n.group.name:n.room.name]}),n?.subject?.name?f.jsxs("div",{className:K.info,children:[f.jsx("span",{children:n.subject.name}),!!n?.teacher?.name&&f.jsxs("span",{children:[n.teacher?.name," ",n?.teacher?.surname]})]}):null]})})},wr=[{to:"7:00",from:"8:00"},{to:"8:00",from:"9:00"},{to:"9:00",from:"10:00"},{to:"10:00",from:"11:00"}],Ra=()=>{const[e,n]=b.useState([]),[r,i]=b.useState([]),[a,o]=b.useState([]),[t,s]=b.useState(),[l,c]=b.useState(!1),[u,d]=b.useState(!1),[p,m]=b.useState(!1),[h,S]=b.useState(!1),[T,X]=b.useState(!1),[j,g]=b.useState(null),[R,Z]=b.useState(null),[w,V]=b.useState({}),[M,W]=b.useState([]),I=L(Yr),F=L(Dr),ee=L(bn),me=L(Sn),Te=L(Tn),oe=L(Cn),ve=L(hn),Ce=L(gn),we=L(wn),ye=L(yn),Ae=L(_n),ne=L(Pn),x=L(jr),{id:z}=L(qr),H=yr();b.useEffect(()=>{H(Ze())},[]),b.useEffect(()=>{x&&z&&H(Be({date:x,branch:z}))},[x,z]),b.useEffect(()=>{x&&z&&T&&H(Fe({date:x,branch:z}))},[x,z,T]),b.useEffect(()=>{F&&z&&H(Le({type:F,branch:z}))},[F,z]),b.useEffect(()=>{R&&H(Ye(R))},[R]),b.useEffect(()=>{ee.length&&W(ee)},[ee]),b.useEffect(()=>{n(ve)},[ve]),b.useEffect(()=>{i(we)},[we]),b.useEffect(()=>{d(!1),!ye.length&&Ae==="success"?(H(on({type:"error",status:!0,msg:"Bu fanda o'qituvchilar yo'q"})),g(null)):o(ye)},[ye,Ae]),b.useEffect(()=>{j&&z&&(d(!0),H(Me({subject:j,branch:z})))},[j,z]),b.useEffect(()=>{M.length&&ne&&F&&W(k=>k.map(y=>{const Y=y.lessons.map(v=>{if(!!v.group.id){let _;return F==="group"?_=v.group.type==="group"?v.group.id===+ne:v.group.classes.includes(+ne):_=v.group.id===+ne,{...v,isFilteredColor:_}}return v});return{...y,lessons:Y}}))},[M.length,ne,F]);const xe=k=>{const{active:y}=k,Y=y?.data?.current?.type;if(m(!0),Y==="container"){ge();const v=y.data.current.room;s(M.filter(N=>N.id===v)[0].lessons.filter(N=>N.dndId===y.id)[0])}else s(Y==="group"?e.filter(v=>v.dndId===y.id)[0]:Y==="subject"?r.filter(v=>v.dndId===y.id)[0]:a.filter(v=>v.dndId===y.id)[0])},{request:he}=ue(),Ke=async(k,y,Y,v,N)=>{const _={hour:k,date:x,checked_id:y,room:Y,type:v};return v==="subject"&&(_.group_id=N.group.id),d(!0),await await he(`${U}SchoolTimeTable/can-set${v==="flow"?"-flow":""}/?branch=${z}`,"POST",JSON.stringify(_),J()).then(G=>(d(!1),v==="subject"&&!G.status&&g(null),H(dr(G.msg.map(Qe=>({type:"error",status:!0,msg:Qe})))),G.status))},_e=async k=>(d(!0),await await he(`${U}SchoolTimeTable/timetable-update-hours-rooms/?branch=${z}`,"POST",JSON.stringify(k),J()).then(Y=>(d(!1),H(dr(Y.msg.map(v=>({type:"error",status:!0,msg:v})))),Y.status)));async function Ne(k){const{active:y,over:Y}=k;if(!Y||!y)return;const v=y?.data?.current?.type,N=y?.data?.current?.room,_=y.id,re=Y.id,G=Y?.data?.current?.room,Qe=Y?.data?.current?.type;let $;if(v==="group"||v==="flow"?$=e.filter(A=>A.dndId===_)[0]:v==="subject"?($=r.filter(A=>A.dndId===_)[0],g($.id)):($=a.filter(A=>A.dndId===_)[0],g(null)),v==="container"&&Qe==="container"){const A=M.filter(E=>E.id===N)[0].lessons.filter(E=>E.dndId===_)[0],O=M.filter(E=>E.id===G)[0].lessons.filter(E=>E.dndId===re)[0];let ke;if(O.group?.id?ke=await _e([{id:A.id,room:O.room,hour:O.hours,date:x},{id:O.id,room:A.room,hour:A.hours,date:x}]):ke=await _e([{id:A.id,room:O.room,hour:O.hours,date:x}]),!ke)return;W(N!==G?E=>E.map(B=>{if(B.id===G){const ce=B.lessons.map(C=>C.dndId===re?{...C,id:A.id,group:A?.group||{},subject:A?.subject||{},teacher:A?.teacher||{}}:C);return{...B,lessons:ce}}if(B.id===N){const ce=B.lessons.map(C=>C.dndId===_?{...C,id:O?.id,group:O?.group,subject:O?.subject,teacher:O?.teacher}:C);return{...B,lessons:ce}}return B}):E=>E.map(B=>{if(B.id===G){const ce=B.lessons.map(C=>C.dndId===re?{...C,id:A?.id,group:A?.group||{},subject:A?.subject||{},teacher:A?.teacher||{}}:C.dndId===_?{...C,id:O?.id,group:O?.group||{},subject:O?.subject||{},teacher:O?.teacher||{}}:C);return{...B,lessons:ce}}return B}))}else{const A=M.filter(E=>E.id===G)[0].lessons.filter(E=>E.dndId===re)[0];let O;if(v==="group"||v==="flow"?O=e.filter(E=>E.dndId===y.id)[0]:v==="subject"?O=r.filter(E=>E.dndId===y.id)[0]:O=a.filter(E=>E.dndId===y.id)[0],!await Ke(A.hours,O.id,A.room,v,A))return;await W(E=>E.map(B=>{if(B.id===G){const ce=B.lessons.map(C=>{if(C.dndId===Y.id)if(C.items){let Oe;return v==="group"?Oe=!!C.group.dndId:v==="subject"?Oe=!!C.subject.dndId:Oe=!!C.teacher.dndId,Oe?C:v==="subject"?{...C,[v]:$,teacher:{}}:v==="teacher"?(V({...C,[v]:$}),{...C,[v]:$}):{...C,[v]:$}}else return v==="subject"?{...C,[v]:$,teacher:{}}:v==="teacher"?(V({...C,[v]:$}),{...C,[v]:$}):v==="flow"?(V({...C,id:null,group:$,subject:$.subject_info,teacher:$.teacher_info}),{...C,id:null,group:$,subject:$.subject_info,teacher:$.teacher_info}):{...C,[v]:$};return C});return{...B,lessons:ce}}return B}))}m(!1)}const ze=(k,y)=>{W(Y=>Y.map(v=>{if(v.id===k){const N=v.lessons.map(_=>_.dndId===y?(c(!0),Z(_.group.id),g(!_.teacher.id&&_.subject.id?_.subject.id:null),{..._,isSelected:!0,isDisabled:!1}):{..._,isSelected:!1,isDisabled:!0});return{...v,lessons:N}}else{const N=v.lessons.map(_=>({..._,isSelected:!1,isDisabled:!0}));return{...v,lessons:N}}}))},ge=()=>{c(!1),g(null),W(k=>k.map(y=>{const Y=y.lessons.map(v=>({...v,isSelected:!1,isDisabled:!1}));return{...y,lessons:Y}}))},qe=(k,y,Y)=>{W(v=>v.map(N=>{if(N.id===k){const _=N.lessons.map(re=>re.dndId===y?(re.id&&(he(`${U}SchoolTimeTable/timetable-list-delete/${Y}`,"DELETE",null,J()).then(G=>{}),Z(null)),{...re,id:null,group:{},subject:{},teacher:{}}):re);return{...N,lessons:_}}return N})),g(null),ge()};b.useEffect(()=>{if(Object.keys(w)?.length){let k={lesson:w?.id,[w?.group.type]:w.group.id,subject:w?.subject?.id,hours:w?.hours,teacher:w?.teacher?.id,room:w?.room,branch:z,date:x};w?.group.type==="flow"&&(k.teacher=w?.group?.teacher_info?.id,k.subject=w?.group?.subject_info?.id),he(`${U}SchoolTimeTable/timetable-list-${w?.id?"update":"create"}/${w?.id?w?.id:""}`,w?.id?"PATCH":"POST",JSON.stringify(k),J()).then(y=>{W(Y=>Y?.map(v=>{if(v.id===w?.room){const N=v?.lessons?.map(_=>_?.dndId===w?.dndId?{..._,id:y?.lesson?.id}:_);return{...v,lessons:N}}return v})),w?.group.type!=="flow"&&H(Ye(w.group.id))}).then(()=>{V({})})}},[w]);const Ge=Jr(ur(an),ur(nn));return f.jsxs("div",{className:mn.timeTable,children:[l?null:f.jsx(Nn,{setIsSelected:c,isSelected:l,setFullScreen:S,setClassView:X,groups:e}),l&&f.jsx(Se,{type:"danger",onClick:ge,children:"Remove Selected"}),u&&f.jsx(Gr,{}),f.jsxs(Ir,{sensors:Ge,collisionDetection:en,onDragStart:xe,onDragEnd:Ne,children:[f.jsx(Wn,{setSelectedSubject:g,selectedSubject:j,isSelected:l,groups:e,subjects:r,teachers:a,color:I,type:F,status:Ce}),me==="loading"?f.jsx(_r,{}):f.jsx(Jn,{onDoubleClickContainer:ze,onDeleteContainer:qe,rooms:M,times:wr,hours:oe,canDisabled:p,startItem:t}),f.jsx(rn,{children:t?.room?f.jsx(ar,{type:"overlay",item:t}):t?.type==="teacher"?f.jsxs(De,{item:t,children:[t.name," ",t.surname]}):t?.dndId?f.jsx(De,{item:t,color:t?.color?.value,children:t.class_name||t.name}):null})]}),f.jsx(cr,{active:h,setActive:S,type:"other",children:f.jsx(Ta,{rooms:M,times:wr,hours:oe})}),f.jsx(cr,{active:T,setActive:X,type:"other",children:f.jsx(Oa,{lessons:Te,hours:oe})})]})};export{Ra as TimeTableTuronPage,Va as timeTableTuronSlice};
