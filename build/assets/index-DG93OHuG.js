import{a as b,a_ as F,a$ as R,r as t,b0 as B,b1 as T,a2 as q,b2 as H,u as L,i as N,A as M,k as A,j as e,b3 as V,b4 as G,D as K,w as D,C as U,b5 as Y,b6 as z,b7 as J,b8 as Q,b9 as W,ba as X,bb as Z,o as ee,g as te,bc as se,bd as ae,be as oe,bf as re,bg as ce,B as de,S as ne}from"./index-B1KXs2zi.js";import{T as le}from"./taskManagerRight-cBHj5Jhk.js";const _e="_container_e3kfj_2",ie="_box_e3kfj_7",he="_box__header_e3kfj_16",xe="_select_e3kfj_23",ue="_box__header_title_e3kfj_26",be="_box__sides_e3kfj_34",u={container:_e,box:ie,box__header:he,select:xe,box__header_title:ue,box__sides:be},fe="_taskLeft_14ud8_1",je="_taskLeft__header_14ud8_20",ke="_taskLeft__header_box_14ud8_24",me="_taskLeft__header_box_top_14ud8_33",ge="_taskLeft__header_box_count_14ud8_41",Le="_taskLeft__body_14ud8_46",pe="_taskLeft__body_table_14ud8_52",ye="_taskLeft__body_main_14ud8_58",Ce="_taskLeft__body_title_14ud8_66",ve="_taskLeft__body_card_14ud8_69",Se="_taskLeft__body_card_cotainer_14ud8_74",o={taskLeft:fe,taskLeft__header:je,taskLeft__header_box:ke,taskLeft__header_box_top:me,taskLeft__header_box_count:ge,taskLeft__body:Le,taskLeft__body_table:pe,taskLeft__body_main:ye,taskLeft__body_title:Ce,taskLeft__body_card:ve,taskLeft__body_card_cotainer:Se},w=t.createContext(null),S=["Tel ko'tardi","Tel ko'tarmadi"],Te=({formatted:s,setTaskType:_,taskType:d})=>{const l=b(F),i=b(R),[f,k]=t.useState(null),[h,j]=t.useState(null),n=b(B),[x,m]=t.useState(null),r=T(new Date),[E,y]=t.useState(!1),[I,C]=t.useState(null),{register:Ae,handleSubmit:De,setValue:we}=q(),v=b(H),{request:O}=N();L(),t.useEffect(()=>{n&&y(!1)},[n]);const g={red:[],yellow:[],green:[]};v?.forEach(a=>{g[a?.color]&&g[a?.color].push(a)}),t.useEffect(()=>{k(S[0])},[S]);const P=t.useCallback(a=>{y(!0),C(a),O(`${M}Lead/lead_call/${a.id}`,"GET",null,A()).then(c=>{console.log(c,"nma gap"),m(c.history)}).catch(c=>{console.log(c)})}),$=t.useMemo(()=>({activeModal:E,setActiveModal:a=>P(a),activeModalItem:I,setActiveModalItem:C,taskType:d}),[]);return e.jsxs("div",{className:o.taskLeft,children:[e.jsxs("div",{className:o.taskLeft__header,children:[r===s&&e.jsxs("div",{onClick:()=>_("progress"),className:o.taskLeft__header_box,style:{background:"rgba(249, 145, 75, 1)"},children:[e.jsxs("div",{className:o.taskLeft__header_box_top,children:[e.jsx("img",{src:V,alt:""}),e.jsxs("h2",{style:{whiteSpace:"pre-line"},children:["Task ",e.jsx("br",{}),"in Progress"]})]}),e.jsx("div",{className:o.taskLeft__header_box_count,children:i})]}),e.jsxs("div",{className:o.taskLeft__header_box,onClick:()=>_("completed"),style:{background:"rgba(26, 174, 204, 1)"},children:[e.jsxs("div",{className:o.taskLeft__header_box_top,children:[e.jsx("img",{src:G,alt:""}),e.jsxs("h2",{style:{whiteSpace:"pre-line"},children:["Project",e.jsx("br",{}),"Completed"]})]}),e.jsx("div",{className:o.taskLeft__header_box_count,children:l})]})]}),e.jsx(w.Provider,{value:$,children:e.jsxs("div",{className:o.taskLeft__body,children:[e.jsx("h1",{className:o.taskLeft__body_title,children:d==="completed"?"Completed leads":"Leads"}),n?e.jsx(K,{}):s===r?e.jsx(e.Fragment,{children:e.jsx("div",{className:o.taskLeft__body_main,children:e.jsx("div",{className:o.taskLeft__body_card,children:Object.entries(g).map(([a,c])=>c.length?e.jsx(Ne,{taskType:d,items:c,className:o.taskLeft__body_card_cotainer},a+d):null)})})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:o.taskLeft__body_table,children:e.jsxs(D,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism"}),e.jsx("th",{children:"Familiya"}),e.jsx("th",{children:"Kament"}),e.jsx("th",{children:"Tel raqami"}),e.jsx("th",{children:"Tel statusi"}),e.jsx("th",{children:"Yaratilgan sana"})]})}),e.jsx("tbody",{children:v?.map((a,c)=>e.jsxs("tr",{children:[e.jsx("td",{children:c+1}),e.jsx("td",{children:a?.lead?.name}),e.jsx("td",{children:a?.lead?.surname}),e.jsx("td",{children:a?.comment}),e.jsx("td",{children:a?.lead?.phone}),e.jsx("td",{children:a.status===!0?"Tel ko'tardi":"Tel ko'tarilmadi"}),e.jsx("td",{children:a?.lead?.created})]},c))})]})})})]})})]})},Ne=({items:s=[],className:_="",taskType:d})=>e.jsxs(D,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"â„–"}),e.jsx("th",{children:"Ism"}),e.jsx("th",{children:"Familiya"}),e.jsx("th",{children:"Telefon nomer"})]})}),e.jsx("tbody",{children:s.map((l,i)=>e.jsx(Me,{item:l,i},i))})]}),Me=({item:s,i:_})=>{const[d,l]=t.useState({}),{setActiveModal:i,setActiveModalItem:f,taskType:k}=t.useContext(w),[h,j]=t.useState(!1),{request:n}=N(),x=L(),m=r=>{switch(r){case"red":return`url(${J})`;case"yellow":return`url(${z})`;case"green":return`url(${Y})`;default:return""}},p=()=>{n(`${M}Lead/lead_delete/${s.id}`,"DELETE",null,A()).then(r=>{console.log(r),j(!1),x(Q(s.id)),x(W(r.accepted_percentage)),x(X(r.completed)),x(Z(r.progressing)),x(ee({type:"success",status:!0,msg:"Muvaffaqiyatli o'chirildi"}))}).catch(r=>{console.log(r)})};return t.useEffect(()=>{l({backImage:m(s?.color),color:s?.color==="green"?"rgba(220, 252, 231, 1)":s.color==="yellow"?"rgba(254, 249, 195, 1)":"rgba(255, 228, 230, 1)"})},[s?.color]),e.jsxs(e.Fragment,{children:[e.jsxs("tr",{style:{background:d.color},children:[e.jsx("td",{children:_+1}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.surname}),e.jsx("td",{children:s.phone})]}),e.jsx(U,{active:h,setActive:j,onClick:p})]})},Oe=()=>{const s=L(),{id:_}=b(te),d=b(se),[l,i]=t.useState(new Date),[f,k]=t.useState("all"),[h,j]=t.useState("progress"),n=T(l);return t.useEffect(()=>{s(ae({operator_id:f,date:n,branch:_,taskType:h}))},[f,n,h]),t.useEffect(()=>{s(oe()),s(re())},[]),e.jsx("div",{className:u.container,children:e.jsxs("div",{className:u.box,children:[e.jsxs("div",{className:u.box__header,children:[e.jsx("h1",{className:u.box__header_title,children:"My Projects"}),e.jsx(ce,{to:"../filteredLeadsList",children:e.jsx(de,{children:"New Leads"})}),e.jsx(ne,{defaultValue:f,onChangeOption:k,extraClass:u.select,title:"Operators",options:[...d,{name:"Hammasi",id:"all"}]})]}),e.jsxs("div",{className:u.box__sides,children:[e.jsx(Te,{setTaskType:j,taskType:h,formatted:n}),e.jsx(le,{selectedDate:l,setSelectedDate:i})]})]})})};export{Oe as AdminTaskManager};
