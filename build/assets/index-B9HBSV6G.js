import{a as _,aq as me,ar as ue,as as de,at as ge,au as xe,a2 as pe,l as he,u as fe,r as o,g as be,av as je,aw as ye,ax as Ce,ay as Se,az as Ne,aA as Te,x as ve,j as e,S as m,I as n,aB as qe,a4 as Oe,B as De,i as ke,A as Ue,k as Ae,aC as B,aD as Me,aE as R,aF as Ee,aG as Fe,o as P}from"./index-B1KXs2zi.js";import{aH as us}from"./index-B1KXs2zi.js";import{g as Ie}from"./systemSelector-CUSI55rJ.js";const we=q=>q.registerUser.categories,Le="_registerBtn_1mt0n_1",Be="_login_1mt0n_5",Re="_login__boxes_1mt0n_14",Pe="_login__boxes__login__box_1mt0n_22",Ve="_login__boxes__box_1mt0n_26",ze="_login__boxes__box__headerTitle_1mt0n_31",Je="_login__boxes__box__form_1mt0n_35",He="_login__aside_1mt0n_44",Ke="_login__aside__img_1mt0n_52",$e="_selection_1mt0n_58",Ge="_extraClasss_1mt0n_63",We="_extraClasses_1mt0n_67",Xe="_multiSelect_1mt0n_71",Qe="_resume_1mt0n_76",Ye="_resume__input_1mt0n_81",Ze="_mess_1mt0n_85",es="_errorMess_1mt0n_89",ss="_successMess_1mt0n_96",as="_seriya_1mt0n_103",s={registerBtn:Le,login:Be,login__boxes:Re,login__boxes__login__box:Pe,login__boxes__box:Ve,login__boxes__box__headerTitle:ze,login__boxes__box__form:Je,login__aside:He,login__aside__img:Ke,selection:$e,extraClasss:Ge,extraClasses:We,multiSelect:Xe,resume:Qe,resume__input:Ye,mess:Ze,errorMess:es,successMess:ss,seriya:as},ts="/assets/reg__bg-CnMNd682.svg",ns={types:[{value:"student",name:"Student"},{value:"teacher",name:"Teacher"},{value:"employer",name:"Employer"}]},V=[{id:1,name:"1 smen"},{id:2,name:"2 smen"},{id:3,name:"hamma vaqt"}],cs=()=>{const O=_(me)?.map(a=>({id:a.group.id,name:a.group.name}))||[],C=_(ue),p=_(de),D=_(ge),z=_(xe),{register:t,handleSubmit:J,watch:k,setValue:r,reset:rs}=pe(),u=k("registerType","student"),S=k("username","");he(),_(Ie);const d=JSON.parse(localStorage.getItem("selectedSystem"));localStorage.getItem("selectedBranch");const H=_(we),c=fe(),[os,K]=o.useState(!1),[$,N]=o.useState(1),[U,A]=o.useState(1),[G,M]=o.useState(1),[W,E]=o.useState(1),[X,Q]=o.useState(1),[Y,Z]=o.useState(),[ee,se]=o.useState(),[ae,T]=o.useState(!1),{request:te}=ke(),[F,h]=o.useState(""),[I,f]=o.useState(!0),ne=Array.isArray(C)?C:[C],[re,oe]=o.useState(""),g=_(be),j=_(je),w=ne?.map(a=>({value:a?.id,label:a?.name})),ie=O.filter(a=>a.name.toLowerCase()!=="admin"&&a.name.toLowerCase()!=="director");o.useEffect(()=>{j&&j?.job&&oe(j.job.toString())},[j]);const L=a=>{A(a)};o.useEffect(()=>{g&&(c(ye()),c(Ce()),c(Se({branch:g.id})),c(Ne({branch:g.id})),c(Te(g.id))),r("password",12345678)},[g]),o.useEffect(()=>{c(ve())},[]),o.useEffect(()=>{S?(async()=>{try{const b=await await te(`${Ue}Users/username-check/`,"POST",JSON.stringify({username:S}),Ae());b.exists===!0?(h(e.jsxs("p",{className:s.errorMess,children:[e.jsx("i",{className:"fa-solid fa-circle-exclamation",style:{color:"#f15c5c"}}),"Username band"]})),f(!1)):b.exists===!1&&(h(e.jsxs("p",{className:s.successMess,children:[e.jsx("i",{className:"fa-solid fa-circle-check"}),"Username bo'sh"]})),f(!0))}catch(y){console.error("Error checking username:",y),h("Error checking username"),f(!1)}})():(h(e.jsx("p",{children:"Username kiriting"})),f(!1))},[S]);const le=a=>{if(!I)return;T(!0);const y=V.find(l=>l.id===Number(G)),b=p.find(l=>l.id===Number($));let i={user:{...a,observer:!0,language:b?.id,branch:g.id}},v={...a,observer:!0,language:b?.id||"",branch:g.id},x;if(u==="student"){let l;d?.name==="school"?l={class_number:X,parents_fullname:a.parents_fullname,old_school:a.old_school,parent_region:a.parent_region,district:a.district,parent_seria:a.parent_seria,parent_seria_num:a.parent_seria_num,region:a.region,born_date:a.born_date,student_seria_num:a.student_seria_num,student_seria:a.student_seria}:l={subject:U.map(_e=>_e.value)||null},i={...i,shift:y?.id||"",parents_number:a.parents_phone,...l},x=Me(i)}else u==="teacher"?d?.name==="school"?(i={...i,total_students:1212,color:"red",class_type:+Y,teacher_salary_type:ee,subject:U.map(l=>l.value)||null},x=R({res:i,file:i?.user?.resume})):(i={...i,total_students:1212},x=R(i)):u==="employer"&&(v={...v,profession:Number(W)},x=Ee(v));x&&(u==="teacher"&&d?.name==="school"&&c(Fe({id:i?.user?.username,file:i?.user?.resume})),c(x).then(l=>{T(!1),l.type.endsWith("fulfilled")?(c(P({type:"success",status:!0,msg:`${u} muvofaqqiyatli qo'shildi`})),A(1),M(1),E(1),h(""),f(!0),r("name",""),r("surname",""),r("username",""),r("parents_fullname",""),r("parent_seria",""),r("parent_seria_num",""),r("parent_region",""),r("born_date",""),r("father_name",""),r("parents_phone",""),r("phone",""),r("student_seria_num",""),r("student_seria",""),r("old_school",""),r("region",""),r("district",""),r("birth_date",""),r("comment","")):(c(P({type:"error",status:!0,msg:"Internet yoki serverda xatolik qayta urinib ko'ring"})),K(!0),T(!1))}))},ce=()=>{switch(u){case"student":return e.jsxs(e.Fragment,{children:[e.jsx(m,{extraClass:s.extraClasses,title:"Til",name:"language",onChangeOption:N,options:p,defaultValue:p[0]?.id}),d?.name==="school"?e.jsxs(e.Fragment,{children:[e.jsx(m,{extraClass:s.extraClasses,title:"Sinf",name:"class_number",onChangeOption:Q,options:D,defaultValue:D[0]?.id}),e.jsx(n,{register:t,placeholder:"Ota-ona telefon raqami",type:"number",required:!0,name:"parents_phone"}),e.jsx(n,{register:t,name:"parents_fullname",placeholder:"ota-ona fio"}),e.jsxs("div",{className:s.seriya,children:[e.jsx(n,{register:t,name:"parent_seria",placeholder:"passport seriya"}),e.jsx(n,{register:t,name:"parent_seria_num",placeholder:"seriya raqami",type:"number"})]}),e.jsx(n,{register:t,name:"born_date",placeholder:"tug'ilgan yili ",type:"date"}),e.jsx(n,{register:t,name:"parent_region",placeholder:"yashash joyi"})]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{options:w,onChange:L,extraClass:s.multiSelect,fontSize:15}),e.jsx(m,{title:"Kelish vaqti",extraClass:s.extraClasses,name:"shift",onChangeOption:M,options:V})]})]});case"teacher":return e.jsxs(e.Fragment,{children:[e.jsx(m,{extraClass:s.extraClasses,name:"language",title:"Til",onChangeOption:N,options:p}),e.jsx(B,{options:w,onChange:L,extraClass:s.multiSelect,fontSize:15}),d?.name==="school"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{extraClass:s.extraClasses,name:"category",options:H,onChangeOption:se,title:"Toifa"}),e.jsx(m,{extraClass:s.extraClasses,name:"class_type",options:z,onChangeOption:Z,title:"Sinf turi"}),e.jsxs("div",{className:s.resume,children:[e.jsx("h2",{style:{textAlign:"left",fontSize:"2rem"},children:"Resume"}),e.jsx(n,{type:"file",name:"file",register:t,extraClassName:s.resume__input})]})]})]});case"employer":return e.jsxs(e.Fragment,{children:[e.jsx(m,{extraClass:s.extraClasses,name:"language",onChangeOption:N,options:p}),e.jsx(m,{extraClass:s.extraClasses,name:"profession",onChangeOption:E,options:re==="director"?O:ie}),e.jsxs("div",{className:s.resume,children:[e.jsx("h2",{style:{textAlign:"left",fontSize:"2rem"},children:"Resume"}),e.jsx(n,{type:"file",name:"resume",register:t,extraClassName:s.resume__input})]})]})}};return e.jsxs("div",{className:s.login,children:[e.jsx("div",{className:s.selection,children:e.jsx(m,{defaultValue:"student",options:ns.types,onChangeOption:a=>r("registerType",a)})}),e.jsxs("div",{className:s.login__boxes,children:[e.jsxs("div",{className:s.login__boxes__login__box,children:[e.jsx("h1",{className:s.login__boxes__box__headerTitle,children:"Registratsiya"}),e.jsx("div",{className:s.login__boxes__box__form,children:e.jsxs("form",{onSubmit:J(le),children:[e.jsx(n,{title:F&&e.jsx("p",{className:s.mess,children:F}),register:t,placeholder:"Username",required:!0,extraClassName:s.extraClasss,name:"username"}),e.jsx(n,{register:t,placeholder:"Ism",required:!0,name:"name"}),e.jsx(n,{register:t,placeholder:"Familiya",required:!0,name:"surname"}),e.jsx(n,{register:t,placeholder:"Otasi ismi",required:!0,name:"father_name"}),d?.name==="school"&&u==="student"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:s.seriya,children:[e.jsx(n,{register:t,name:"student_seria",placeholder:"seriya"}),e.jsx(n,{name:"student_seria_num",register:t,type:"number",placeholder:"metrka raqami"})]}),e.jsx(n,{register:t,name:"old_school",placeholder:"kelgan maktabi"}),e.jsx(n,{register:t,name:"region",placeholder:"Xudud nomi"}),e.jsx(n,{register:t,name:"district",placeholder:"Tuman shaxar nomi"})]}):null,e.jsx(n,{register:t,placeholder:"Parol",required:!0,type:"password",name:"password"}),e.jsx(n,{register:t,placeholder:"Tug'ilgan kun",type:"date",required:!0,name:"birth_date"}),e.jsx(n,{register:t,placeholder:"Telefon raqami",type:"number",required:!0,name:"phone"}),d?.name==="center "&&u==="student"?e.jsx(n,{register:t,placeholder:"Ota-ona telefon raqami",type:"number",required:!0,name:"parents_phone"}):null,e.jsx(qe,{register:t,placeholder:"Kommentariya",name:"comment"}),ce(),ae?e.jsx(Oe,{}):e.jsx(De,{type:I?"submit":"disabled",extraClass:s.registerBtn,children:"Register"})]})})]}),e.jsx("div",{className:s.login__aside,children:e.jsx("img",{className:s.login__aside__img,src:ts,alt:""})})]})]})};export{cs as default,us as registerUser};
