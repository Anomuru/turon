import{n as f,o as ve,l as ee,k as se,r as o,j as e,B as N,i as m,T as H,p as Y,I as X,u as te,A as J,h as K,m as be,D as Ce,c as Ne}from"./index-Cux8sda1.js";import{g as ne,a as Ie,d as Le,e as E,c as I,h as Me,i as Se,b as q,j as B,f as O}from"./flowsProfileThunk-CL9pqjRO.js";import"./index-Dyh4sQR2.js";import"./userProfileSlice-BflEK4KO.js";import{g as ae}from"./index-B-IQsIPc.js";import{C as Q}from"./confirmModal-DiNALKc8.js";import{j as Fe}from"./studentsSlice-JQcNq_2O.js";import{a as ye,o as z}from"./alertSlice-XeBTN8B3.js";import{b as we}from"./studentsSelector-TVQxHXsm.js";import"./pagination-Cj0p_t2O.js";import{u as re}from"./index.esm-DQmSsb0O.js";import"./workerSelect-N9ju4zO7.js";import"./teacherParseSlice-z7KSx3F7.js";import"./teacherThunk-qU_2Y3xX.js";import"./filterRoomsSlice-ClpK4_Fa.js";import{M as A}from"./modal-BR27MEf1.js";import{F as W}from"./form-C3mZZqBW.js";import"./textArea-1604NtUh.js";import"./editableCard-BNSd-vHU.js";import"./index-CO9axSa1.js";import"./oftenUsedSelector-B4R2CTqR.js";import{F as ke}from"./flowList-DzAYIuIr.js";import{a as Te}from"./flowsSlice-BXoIT3Tq.js";import{g as Pe}from"./flowsSelector-BUggl1rg.js";import{d as v}from"./user_image-CruVt77w.js";import{S as Ae}from"./switch-sjHY-EbU.js";import{t as Z}from"./teachingTeacher-CnoExvDG.js";import"./groupsAttendanceSlice-DmRNDpcI.js";import"./roomsSelectors-Dutms6Wd.js";import"./Transition-CosWKtpf.js";import"./room_image-CsXp1EfD.js";import"./filters.module-C8GjSCwu.js";import"./cross-BXlnQeE0.js";const $e="_studentsList_8cx1i_76",De="_btns_8cx1i_82",Ee="_btns__inner_8cx1i_88",qe="_btns__icon_8cx1i_93",Be="_studentsList__container_8cx1i_96",Oe="_studentsList__input_8cx1i_122",ze="_studentsList__delete_8cx1i_125",Ye="_studentsList__status_8cx1i_136",Re="_red_8cx1i_143",Ve="_yellow_8cx1i_147",Ue="_addModal_8cx1i_152",Ge="_addModal__header_8cx1i_161",He="_addModal__inner_8cx1i_171",Je="_addModal__container_8cx1i_177",Ke="_check_8cx1i_205",Qe="_status_8cx1i_213",We="_active_8cx1i_222",Xe="_status__inner_8cx1i_225",Ze="_addModal__btn_8cx1i_235",es="_deleteForm_8cx1i_239",ss="_deleteForm__form_8cx1i_245",ts="_deleteForm__select_8cx1i_254",ns="_deleteForm__btn_8cx1i_258",as="_teachersModal_8cx1i_262",rs="_teachersModal__container_8cx1i_271",is="_teachersModal__wrapper_8cx1i_322",ls="_teachersModal__subject_8cx1i_327",ds="_changeTeacher_8cx1i_336",cs="_changeTeacher__container_8cx1i_341",l={studentsList:$e,btns:De,btns__inner:Ee,btns__icon:qe,studentsList__container:Be,studentsList__input:Oe,studentsList__delete:ze,studentsList__status:Ye,red:Re,yellow:Ve,addModal:Ue,addModal__header:Ge,addModal__inner:He,addModal__container:Je,check:Ke,status:Qe,active:We,status__inner:Xe,addModal__btn:Ze,deleteForm:es,deleteForm__form:ss,deleteForm__select:ts,deleteForm__btn:ns,teachersModal:as,teachersModal__container:rs,teachersModal__wrapper:is,teachersModal__subject:ls,changeTeacher:ds,changeTeacher__container:cs},os=({activeTeacher:j,setActiveTeacher:n})=>{const{request:_}=te(),{id:u}=f(ve),d=ee(),{register:$,handleSubmit:g}=re(),c=se(),b=f(ne),R=f(Pe),L=f(Ie),M=f(Le),S=f(ae),[F,w]=o.useState(!1),[p,C]=o.useState(""),[D,V]=o.useState(),[y,k]=o.useState([]),[T,U]=o.useState([]),[h,P]=o.useState(null),[ie,G]=o.useState([]);o.useEffect(()=>{L&&G(L)},[L]),o.useEffect(()=>{d(Te())},[]),o.useEffect(()=>{if(b&&u&&S){const s={ignore_teacher:b?.teacher?.id};d(E({res:s,id:u,branch:S}))}},[u,S]);const le=()=>{let s=[];y.map(a=>{a?.students?.map(r=>s.push(r))}),d(I({id:u,res:{update_type:"add_students",students:s}}))},de=()=>{const s={update_type:"remove_students",students:[h?.id]};d(I({id:u,res:s}))},ce=s=>{_(`${J}Flow/move-to-flow/?flow_id=${u}&to_flow_id=${s?.to_id}`,"POST",JSON.stringify({students:T}),K()).then(i=>{d(ye(i.errors.map(a=>({type:"error",status:!0,msg:a}))))})},oe=s=>{M.filter(i=>i.id===+s)[0]?.subject.length===1?(d(I({res:{teacher:s,subject:M.filter(i=>i.id===+s)[0]?.subject[0]?.id,level:null},id:u})),d(z({type:"success",status:!0,msg:"Patokni o'qituvchisi o'zgardi"}))):(V(s),C("changeTeacher"))},_e=s=>{const i={...s,teacher:D,level:null};d(I({id:u,res:i}))},ue=()=>b?.students?.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{onClick:()=>c(`../students/profile/${s?.id}`),src:s.img??v,alt:""})}),e.jsx("td",{children:`${s?.surname} ${s?.name}`}),e.jsx("td",{children:s?.phone}),e.jsx("td",{children:s?.parents_phone}),e.jsx("td",{children:e.jsx("div",{className:m(l.studentsList__status,{[l.red]:Number(s.balance)<0,[l.yellow]:Number(s.balance)>0&&Number(s.balance)<1e5}),children:s?.balance})}),F?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx(X,{extraClassName:l.studentsList__input,type:"checkbox",onChange:()=>U(i=>i.filter(a=>a===s.id)[0]?i.filter(a=>a!==s.id):[...i,s.id])})}),e.jsx("td",{children:e.jsx("i",{className:m("fas fa-trash",l.studentsList__delete),onClick:()=>P(s)})})]}):null]})),he=s=>{G(i=>i.map(a=>a.id===+s?a.isCheck?(k(r=>r.filter(x=>x.classId!==a.id)),{isCheck:!1,id:a.id,students:a.students.map(r=>({isCheck:!1,id:r.id,extra_info:r.extra_info,user:r.user})),class_number:a.class_number,color:a.color}):(k(r=>r.filter(x=>x.classId===a.id)[0]?[...r.filter(x=>x.classId!==a.id),{classId:a.id,students:a?.students?.map(x=>x?.id)}]:[...r,{classId:a.id,students:a?.students?.map(x=>x?.id)}]),{isCheck:!0,id:a.id,students:a.students.map(r=>({isCheck:!0,id:r.id,extra_info:r.extra_info,user:r.user})),class_number:a.class_number,color:a.color}):a))},me=(s,i)=>{k(a=>a.filter(r=>r?.classId===+i)[0]?a.map(r=>{if(r?.classId===i)return{classId:r.classId,students:r.students.includes(+s)?r.students.filter(x=>x!==+s):[...r.students,+s]}}):[...a,{classId:+i,students:[+s]}])};o.useEffect(()=>{G(s=>s.map(i=>{const a=y.filter(r=>r?.classId===i.id)[0];return a?{isCheck:a?.students?.length===i.students.length,id:i.id,students:i.students.map(r=>a?.students?.includes(r.id)?{isCheck:!0,id:r.id,extra_info:r.extra_info,user:r.user}:{isCheck:!1,id:r.id,extra_info:r.extra_info,user:r.user}),class_number:i.class_number,color:i.color}:i}))},[y]);const xe=()=>ie.map((s,i)=>e.jsx(ke,{flowList:s,onChangeAll:he,onChangeSingle:me,number:i},i)),fe=()=>M?.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:v,alt:""})}),e.jsx("td",{children:s?.user?.name}),e.jsx("td",{children:s?.user?.surname}),e.jsx("td",{children:e.jsx("div",{className:l.teachersModal__wrapper,children:s?.subject?.map(i=>e.jsx("div",{className:l.teachersModal__subject,children:i?.name?.slice(0,16)}))})}),e.jsx("td",{children:e.jsxs("div",{className:l.check,children:[e.jsx(Ae,{activeSwitch:b?.teacher?.id===s?.id,onChangeSwitch:()=>oe(s?.id)}),e.jsx("div",{className:m(l.status,{[l.active]:s?.extra_info?.status}),children:e.jsx("div",{className:m(l.status__inner,{[l.active]:s?.extra_info?.status})})})]})})]})),je=xe(),ge=fe(),pe=ue();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:l.studentsList,children:[e.jsxs("div",{className:l.btns,children:[e.jsx("h1",{children:"O’quvchilar ro’yxati"}),e.jsxs("div",{className:l.btns__inner,children:[e.jsx(N,{disabled:T.length===0,type:T.length===0?"disabled":"",onClick:()=>C("change"),children:"Move"}),e.jsx(N,{onClick:()=>C("add"),children:"Add"}),e.jsx("i",{className:m("fas fa-edit",l.btns__icon),onClick:()=>w(!F)})]})]}),e.jsx("div",{className:l.studentsList__container,children:e.jsxs(H,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism Familya"}),e.jsx("th",{children:"Tel"}),e.jsx("th",{children:"Tel Ota-ona"}),e.jsx("th",{children:"Balans"}),F?e.jsxs(e.Fragment,{children:[e.jsx("th",{}),e.jsx("th",{})]}):null]})}),e.jsx("tbody",{children:pe})]})})]}),e.jsxs(A,{active:p==="add",setActive:C,extraClass:l.addModal,children:[e.jsx("div",{className:l.addModal__header,children:e.jsxs("div",{className:l.addModal__inner,children:[e.jsx("span",{children:"No"}),e.jsx("span",{children:"Sinf Raqami"})]})}),e.jsx("div",{className:l.addModal__container,children:je}),e.jsx(N,{extraClass:l.addModal__btn,onClick:le,children:"Add"})]}),e.jsxs(A,{extraClass:l.deleteForm,active:p==="change",setActive:C,children:[e.jsx("h1",{children:"Boshqa sinfga qo’shish"}),e.jsxs(W,{extraClassname:l.deleteForm__form,onSubmit:g(ce),typeSubmit:"",children:[e.jsx(Y,{extraClass:l.deleteForm__select,options:R.filter(s=>s.id!==+u),title:"Patok",register:$,name:"to_id"}),e.jsx(N,{extraClass:l.deleteForm__btn,children:"Add"})]})]}),e.jsx(A,{active:j==="changeTeacher",setActive:n,extraClass:l.teachersModal,children:e.jsx("div",{className:l.teachersModal__container,children:e.jsxs(H,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism"}),e.jsx("th",{children:"Familya"}),e.jsx("th",{children:"Fanlar"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:ge})]})})}),e.jsxs(A,{extraClass:l.changeTeacher,active:p==="changeTeacher",setActive:C,children:[e.jsx("h1",{children:"Fan tanlang"}),e.jsx(W,{extraClassname:l.changeTeacher__container,onSubmit:g(_e),children:e.jsx(Y,{title:"Fan",register:$,options:M?.filter(s=>s.id===D)[0]?.subject,name:"subject"})})]}),e.jsx(Q,{setActive:P,active:h,onClick:de,type:"danger"})]})},_s="_flowProfile_1np6n_1",us="_navigators_1np6n_8",hs="_navigatorsItem_1np6n_13",ms="_navigatorsItem__link_1np6n_24",xs="_navigatorsItem__border_1np6n_34",fs="_navigatorsItem__icon_1np6n_39",js="_navigatorsItem__info_1np6n_43",gs="_status_1np6n_53",ps="_active_1np6n_62",vs="_status__inner_1np6n_65",bs="_navigatorsItem__inner_1np6n_75",Cs="_navigatorsItem__iconPosition_1np6n_80",Ns="_navigatorsItem__image_1np6n_86",Is="_navigatorsItem__subject_1np6n_90",Ls="_studentsList_1np6n_109",Ms="_btns_1np6n_115",Ss="_btns__inner_1np6n_121",Fs="_btns__icon_1np6n_126",ys="_studentsList__container_1np6n_129",ws="_studentsList__input_1np6n_155",ks="_studentsList__delete_1np6n_158",Ts="_studentsList__status_1np6n_169",Ps="_red_1np6n_176",As="_yellow_1np6n_180",$s="_infoModal_1np6n_185",Ds="_infoModal__btn_1np6n_190",Es="_form_1np6n_193",qs="_form__input_1np6n_198",t={flowProfile:_s,navigators:us,navigatorsItem:hs,navigatorsItem__link:ms,navigatorsItem__border:xs,navigatorsItem__icon:fs,navigatorsItem__info:js,status:gs,active:ps,status__inner:vs,navigatorsItem__inner:bs,navigatorsItem__iconPosition:Cs,navigatorsItem__image:Ns,navigatorsItem__subject:Is,studentsList:Ls,btns:Ms,btns__inner:Ss,btns__icon:Fs,studentsList__container:ys,studentsList__input:ws,studentsList__delete:ks,studentsList__status:Ts,red:Ps,yellow:As,infoModal:$s,infoModal__btn:Ds,form:Es,form__input:qs},Bs=[{img:v,fullName:"Mahmud Yo`Ldoshev",parentTel:"+998909773176",tel:"+998909773176",money:"-10000",checked:!0,deleted:!0},{img:v,fullName:"Mahmud Yo`Ldoshev",parentTel:"+998909773176",tel:"+998909773176",money:"50000",checked:!0,deleted:!0},{img:v,fullName:"Mahmud Yo`Ldoshev",parentTel:"+998909773176",tel:"+998909773176",money:"295 000",checked:!0,deleted:!0},{img:v,fullName:"Mahmud Yo`Ldoshev",parentTel:"+998909773176",tel:"+998909773176",money:"295 000",checked:!0,deleted:!0},{img:v,fullName:"Mahmud Yo`Ldoshev",parentTel:"+998909773176",tel:"+998909773176",money:"295 000",checked:!0,deleted:!0},{img:v,fullName:"Mahmud Yo`Ldoshev",parentTel:"+998909773176",tel:"+998909773176",money:"295 000",checked:!0,deleted:!0}];o.memo(()=>{const[j,n]=o.useState(!1),u=Bs.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:d.img,alt:""})}),e.jsx("td",{children:d.fullName}),e.jsx("td",{children:d.tel}),e.jsx("td",{children:d.parentTel}),e.jsx("td",{children:e.jsx("div",{className:m(t.studentsList__status,{[t.red]:Number(d.money)<0,[t.yellow]:Number(d.money)>0&&Number(d.money)<1e5}),children:d.money})}),j?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx(X,{extraClassName:t.studentsList__input,type:"checkbox",defaultValue:d.checked})}),e.jsx("td",{children:e.jsx("i",{className:m("fas fa-trash",t.studentsList__delete)})})]}):null]}));return e.jsxs("div",{className:t.studentsList,children:[e.jsxs("div",{className:t.btns,children:[e.jsx("h1",{children:"O’quvchilar ro’yxati"}),e.jsxs("div",{className:t.btns__inner,children:[e.jsx(N,{children:"Move"}),e.jsx(N,{children:"Add"}),e.jsx("i",{className:m("fas fa-edit",t.btns__icon),onClick:()=>n(!j)})]})]}),e.jsx("div",{className:t.studentsList__container,children:e.jsxs(H,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism Familya"}),e.jsx("th",{children:"Tel"}),e.jsx("th",{children:"Tel Ota-ona"}),e.jsx("th",{children:"Balans"}),j?e.jsxs(e.Fragment,{children:[e.jsx("th",{}),e.jsx("th",{})]}):null]})}),e.jsx("tbody",{children:u})]})})]})});const bt=o.memo(()=>{const{request:j}=te(),{register:n,handleSubmit:_,setValue:u}=re(),d=ee(),$=se(),{id:g}=be(),c=f(ne),b=f(Me),R=f(Se),L=f(ae),M=f(we),[S,F]=o.useState(!1),[w,p]=o.useState(""),[C,D]=o.useState(null),[V,y]=o.useState(!1);o.useEffect(()=>{d(q({id:g})),d(B({id:g}))},[g]),o.useEffect(()=>{L&&c&&d(O({flow:g,branch:L,res:{ignore_students:c?.students.map(h=>h?.id)}}))},[L,c]),o.useEffect(()=>{c&&(u("name",c?.name),u("level",c?.level?.id))},[c]),o.useEffect(()=>{c&&j(`${J}Subjects/level-for-subject/${c?.subject_id}/`,"GET",null,K()).then(h=>{d(Fe(h))}).catch(h=>console.log(h))},[c]);const k=()=>{j(`${J}Flow/flow-delete/${g}`,"DELETE",null,K()).then(h=>{$(-2),d(z({type:"success",status:!0,msg:h?.msg}))}).catch(h=>{d(z({type:"error",status:!0,msg:"Databazada hatolik yuzberdi"}))})},T=()=>{y(!0)},U=h=>{const P={...h,subject:C};console.log(P,"log"),d(I({id:g,res:P})),d(z({type:"success",status:!0,msg:"Patokni malumotlari o'zgardi"}))};return R?(w&&p(!1),e.jsx(Ce,{})):e.jsxs("div",{className:t.flowProfile,children:[e.jsxs("div",{className:t.navigators,children:[e.jsxs("div",{className:t.navigatorsItem,style:{borderColor:"#3B82F6"},children:[e.jsxs("div",{className:t.navigatorsItem__link,children:[e.jsx("p",{children:"Next lesson"}),e.jsx("i",{className:m("fas fa-share",t.navigatorsItem__icon)})]}),e.jsx("div",{className:t.navigatorsItem__border}),e.jsxs("div",{className:t.navigatorsItem__info,children:[e.jsx("h2",{children:b?.day}),e.jsx("h2",{children:b?.hour}),e.jsx("h2",{children:b?.room})]})]}),e.jsxs("div",{className:t.navigatorsItem,style:{borderColor:"#5A588E"},children:[e.jsxs("div",{className:t.navigatorsItem__link,children:[e.jsx("p",{children:"Teacher"}),e.jsx("img",{src:Z,alt:""})]}),e.jsx("div",{className:t.navigatorsItem__border}),e.jsxs("div",{className:t.navigatorsItem__info,children:[e.jsx("img",{className:t.navigatorsItem__image,src:v,alt:""}),e.jsx("h2",{children:`${c?.teacher?.surname} ${c?.teacher?.name}`}),e.jsx("h2",{className:t.navigatorsItem__subject,children:c?.subject_name}),e.jsx("i",{className:m("fas fa-edit",t.navigatorsItem__iconPosition),onClick:()=>p("changeTeacher")})]})]}),e.jsxs("div",{className:t.navigatorsItem,style:{borderColor:"#5A588E"},children:[e.jsxs("div",{className:t.navigatorsItem__link,children:[e.jsx("p",{children:"Info"}),e.jsx("img",{src:Z,alt:""})]}),e.jsx("div",{className:t.navigatorsItem__border}),e.jsxs("div",{className:t.navigatorsItem__info,children:[e.jsxs("h2",{className:t.navigatorsItem__inner,children:[e.jsx("span",{children:"Name: "}),c?.name]}),c?.level_name?e.jsxs("h2",{className:t.navigatorsItem__inner,children:[e.jsx("span",{children:"Level: "}),c?.level_name]}):null,e.jsxs("h2",{className:t.navigatorsItem__inner,children:[e.jsx("span",{children:"Activity: "}),e.jsx("div",{className:m(t.status,{[t.active]:c?.activity}),children:e.jsx("div",{className:m(t.status__inner,{[t.active]:c?.activity})})})]}),e.jsx("i",{className:m("fas fa-edit",t.navigatorsItem__iconPosition),onClick:()=>p("changeInfo")})]})]})]}),e.jsx(os,{activeTeacher:w,setActiveTeacher:p}),e.jsxs(A,{extraClass:t.infoModal,active:w==="changeInfo",setActive:p,children:[e.jsx("h1",{children:"Ma’lumot o’zgartirish"}),e.jsx(N,{extraClass:t.infoModal__btn,onClick:()=>F(!S),type:"danger",children:"Delete group"}),e.jsxs(W,{id:"formChange",extraClassname:t.form,typeSubmit:"",onSubmit:_(U),children:[e.jsx(X,{extraClassName:t.form__input,placeholder:"Patok nomi",register:n,name:"name",required:!0}),e.jsx(Y,{extraClass:t.form__input,options:c?.teacher?.subject,title:"Fan",defaultValue:c?.subject?.id,onChangeOption:D,required:!0}),M.length?e.jsx(Y,{extraClass:t.form__input,options:M,title:"Level",register:n,name:"level",defaultValue:c?.level?.id,required:!0}):null,e.jsx(N,{id:"formChange",extraClass:t.infoModal__btn,children:"Change"})]}),e.jsx(Q,{setActive:F,active:S,onClick:T,title:"Rostanham o'chirmoqchimisiz ",type:"danger"})]}),e.jsx(Q,{type:"danger",active:V,setActive:y,onClick:k})]})}),Os={data:null,nextLessonData:null,filteredStudents:null,filteredTeachers:null,loading:!1,error:null},zs=Ne({name:"flowsProfileSlice",initialState:Os,reducers:{},extraReducers:j=>j.addCase(q.pending,n=>{n.loading=!0,n.error=null}).addCase(q.fulfilled,(n,_)=>{n.data=_.payload,n.loading=!1,n.error=null}).addCase(q.rejected,n=>{n.loading=!1,n.error="error"}).addCase(B.pending,n=>{}).addCase(B.fulfilled,(n,_)=>{n.nextLessonData=_.payload}).addCase(B.rejected,n=>{}).addCase(O.pending,n=>{}).addCase(O.fulfilled,(n,_)=>{n.filteredStudents=_.payload?.classes}).addCase(O.rejected,n=>{}).addCase(E.pending,n=>{}).addCase(E.fulfilled,(n,_)=>{n.filteredTeachers=_.payload?.teachers_list}).addCase(E.rejected,n=>{}).addCase(I.pending,n=>{n.loading=!0,n.error=null}).addCase(I.fulfilled,(n,_)=>{n.data=_.payload,n.loading=!1,n.error=null}).addCase(I.rejected,n=>{n.loading=!1,n.error="error"})}),Ct=zs.reducer;export{bt as FlowProfileNavigators,Ct as flowsProfileSlice};
