import{n as f,r as t,l as g,u as T,A as N,h as M,j as e,D as F,T as A,o as R,L as B,B as q,p as H}from"./index-Cux8sda1.js";import{g as V,a as G,b as K,f as D,c as U,p as Y,d as z,e as J,y as Q,h as W,o as X,i as Z,j as ee,k as te,l as se,m as ae,T as oe}from"./index-Id37AgE1.js";import"./modal-BR27MEf1.js";import"./textArea-1604NtUh.js";import{u as re}from"./index.esm-DQmSsb0O.js";import{C as ce}from"./confirmModal-DiNALKc8.js";import{o as ne}from"./alertSlice-XeBTN8B3.js";import"./index-CO9axSa1.js";import{b as de,c as le}from"./oftenUsedSelector-B4R2CTqR.js";import"./userProfileSlice-BflEK4KO.js";import"./user_image-CruVt77w.js";import"./form-C3mZZqBW.js";import"./index-B-IQsIPc.js";import"./cross-BXlnQeE0.js";const _e="_container_e3kfj_2",ie="_box_e3kfj_7",he="_box__header_e3kfj_16",xe="_select_e3kfj_23",ue="_box__header_title_e3kfj_26",fe="_box__sides_e3kfj_34",u={container:_e,box:ie,box__header:he,select:xe,box__header_title:ue,box__sides:fe},me="_taskLeft_14ud8_1",je="_taskLeft__header_14ud8_20",be="_taskLeft__header_box_14ud8_24",ke="_taskLeft__header_box_top_14ud8_33",pe="_taskLeft__header_box_count_14ud8_41",ge="_taskLeft__body_14ud8_46",Le="_taskLeft__body_table_14ud8_52",ye="_taskLeft__body_main_14ud8_58",Ce="_taskLeft__body_title_14ud8_66",ve="_taskLeft__body_card_14ud8_69",Se="_taskLeft__body_card_cotainer_14ud8_74",o={taskLeft:me,taskLeft__header:je,taskLeft__header_box:be,taskLeft__header_box_top:ke,taskLeft__header_box_count:pe,taskLeft__body:ge,taskLeft__body_table:Le,taskLeft__body_main:ye,taskLeft__body_title:Ce,taskLeft__body_card:ve,taskLeft__body_card_cotainer:Se},E=t.createContext(null),S=["Tel ko'tardi","Tel ko'tarmadi"],Te=({formatted:s,setTaskType:_,taskType:n})=>{const l=f(V),i=f(G),[m,b]=t.useState(null),[h,j]=t.useState(null),d=f(K),[x,k]=t.useState(null),r=D(new Date),[w,y]=t.useState(!1),[I,C]=t.useState(null),{register:Ae,handleSubmit:De,setValue:Ee}=re(),v=f(U),{request:O}=T();g(),t.useEffect(()=>{d&&y(!1)},[d]);const p={red:[],yellow:[],green:[]};v?.forEach(a=>{p[a?.color]&&p[a?.color].push(a)}),t.useEffect(()=>{b(S[0])},[S]);const P=t.useCallback(a=>{y(!0),C(a),O(`${N}Lead/lead_call/${a.id}`,"GET",null,M()).then(c=>{console.log(c,"nma gap"),k(c.history)}).catch(c=>{console.log(c)})}),$=t.useMemo(()=>({activeModal:w,setActiveModal:a=>P(a),activeModalItem:I,setActiveModalItem:C,taskType:n}),[]);return e.jsxs("div",{className:o.taskLeft,children:[e.jsxs("div",{className:o.taskLeft__header,children:[r===s&&e.jsxs("div",{onClick:()=>_("progress"),className:o.taskLeft__header_box,style:{background:"rgba(249, 145, 75, 1)"},children:[e.jsxs("div",{className:o.taskLeft__header_box_top,children:[e.jsx("img",{src:Y,alt:""}),e.jsxs("h2",{style:{whiteSpace:"pre-line"},children:["Task ",e.jsx("br",{}),"in Progress"]})]}),e.jsx("div",{className:o.taskLeft__header_box_count,children:i})]}),e.jsxs("div",{className:o.taskLeft__header_box,onClick:()=>_("completed"),style:{background:"rgba(26, 174, 204, 1)"},children:[e.jsxs("div",{className:o.taskLeft__header_box_top,children:[e.jsx("img",{src:z,alt:""}),e.jsxs("h2",{style:{whiteSpace:"pre-line"},children:["Project",e.jsx("br",{}),"Completed"]})]}),e.jsx("div",{className:o.taskLeft__header_box_count,children:l})]})]}),e.jsx(E.Provider,{value:$,children:e.jsxs("div",{className:o.taskLeft__body,children:[e.jsx("h1",{className:o.taskLeft__body_title,children:n==="completed"?"Completed leads":"Leads"}),d?e.jsx(F,{}):s===r?e.jsx(e.Fragment,{children:e.jsx("div",{className:o.taskLeft__body_main,children:e.jsx("div",{className:o.taskLeft__body_card,children:Object.entries(p).map(([a,c])=>c.length?e.jsx(Ne,{taskType:n,items:c,className:o.taskLeft__body_card_cotainer},a+n):null)})})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:o.taskLeft__body_table,children:e.jsxs(A,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism"}),e.jsx("th",{children:"Familiya"}),e.jsx("th",{children:"Kament"}),e.jsx("th",{children:"Tel raqami"}),e.jsx("th",{children:"Tel statusi"}),e.jsx("th",{children:"Yaratilgan sana"})]})}),e.jsx("tbody",{children:v?.map((a,c)=>e.jsxs("tr",{children:[e.jsx("td",{children:c+1}),e.jsx("td",{children:a?.lead?.name}),e.jsx("td",{children:a?.lead?.surname}),e.jsx("td",{children:a?.comment}),e.jsx("td",{children:a?.lead?.phone}),e.jsx("td",{children:a.status===!0?"Tel ko'tardi":"Tel ko'tarilmadi"}),e.jsx("td",{children:a?.lead?.created})]},c))})]})})})]})})]})},Ne=({items:s=[],className:_="",taskType:n})=>e.jsxs(A,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"â„–"}),e.jsx("th",{children:"Ism"}),e.jsx("th",{children:"Familiya"}),e.jsx("th",{children:"Telefon nomer"})]})}),e.jsx("tbody",{children:s.map((l,i)=>e.jsx(Me,{item:l,i},i))})]}),Me=({item:s,i:_})=>{const[n,l]=t.useState({}),{setActiveModal:i,setActiveModalItem:m,taskType:b}=t.useContext(E),[h,j]=t.useState(!1),{request:d}=T(),x=g(),k=r=>{switch(r){case"red":return`url(${W})`;case"yellow":return`url(${Q})`;case"green":return`url(${J})`;default:return""}},L=()=>{d(`${N}Lead/lead_delete/${s.id}`,"DELETE",null,M()).then(r=>{console.log(r),j(!1),x(X(s.id)),x(Z(r.accepted_percentage)),x(ee(r.completed)),x(te(r.progressing)),x(ne({type:"success",status:!0,msg:"Muvaffaqiyatli o'chirildi"}))}).catch(r=>{console.log(r)})};return t.useEffect(()=>{l({backImage:k(s?.color),color:s?.color==="green"?"rgba(220, 252, 231, 1)":s.color==="yellow"?"rgba(254, 249, 195, 1)":"rgba(255, 228, 230, 1)"})},[s?.color]),e.jsxs(e.Fragment,{children:[e.jsxs("tr",{style:{background:n.color},children:[e.jsx("td",{children:_+1}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.surname}),e.jsx("td",{children:s.phone})]}),e.jsx(ce,{active:h,setActive:j,onClick:L})]})},Ye=()=>{const s=g(),{id:_}=f(R),n=f(de),[l,i]=t.useState(new Date),[m,b]=t.useState("all"),[h,j]=t.useState("progress"),d=D(l);return t.useEffect(()=>{s(se({operator_id:m,date:d,branch:_,taskType:h}))},[m,d,h]),t.useEffect(()=>{s(ae()),s(le())},[]),e.jsx("div",{className:u.container,children:e.jsxs("div",{className:u.box,children:[e.jsxs("div",{className:u.box__header,children:[e.jsx("h1",{className:u.box__header_title,children:"My Projects"}),e.jsx(B,{to:"../filteredLeadsList",children:e.jsx(q,{children:"New Leads"})}),e.jsx(H,{defaultValue:m,onChangeOption:b,extraClass:u.select,title:"Operators",options:[...n,{name:"Hammasi",id:"all"}]})]}),e.jsxs("div",{className:u.box__sides,children:[e.jsx(Te,{setTaskType:j,taskType:h,formatted:d}),e.jsx(oe,{selectedDate:l,setSelectedDate:i})]})]})})};export{Ye as AdminTaskManager};
