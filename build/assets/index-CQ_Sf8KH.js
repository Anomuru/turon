import{j as e,w as O,r as s,u as K,de as be,aY as ae,b as pe,a2 as re,a as h,bk as fe,d3 as ge,df as Ce,dg as Se,dh as ve,di as Ne,i as ce,A as R,k as q,bs as ye,cJ as Te,dj as ke,aw as Be,B as M,dk as Ge,T as Ae,P as de,M as Y,dl as Pe,dm as Fe,dn as De,dp as Me,I as ze,d as $e,dq as we,e as Ie,g as le,bI as Le,c as Ee,D as oe,dr as Re,ds as qe,dt as Oe,S as ee,du as He,aJ as Ve,aB as Je}from"./index-B1KXs2zi.js";import{g as ie}from"./searchSelector-CJfw-E7m.js";import{M as Ue}from"./MultiPage-OkwmnpSM.js";const Z={},Ye=({currentTableData:o})=>e.jsx("div",{className:Z.deletedGroups,children:e.jsx("div",{className:Z.table,children:e.jsxs(O,{extraClass:Z.table__head,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Guruh Nomi"}),e.jsx("th",{children:"Full name"}),e.jsx("th",{children:"Fan"}),e.jsx("th",{children:"Kurs Turi"}),e.jsx("th",{children:"Guruh narxi"}),e.jsx("th",{children:"O'chirilgan sana"})]})}),e.jsx("tbody",{children:o.map((_,f)=>e.jsxs("tr",{children:[e.jsx("td",{children:f+1}),e.jsx("td",{children:_.groupName}),e.jsxs("td",{children:[_.name," ",_.surname]}),e.jsx("td",{children:e.jsx("div",{children:_.subject})}),e.jsx("td",{children:_.typeCourse}),e.jsx("td",{children:e.jsx("div",{children:_.groupPrice})}),e.jsx("td",{children:_.deletedDate})]}))})]})})}),Ke=o=>o.deletedGroupsSlice.data,We="_mainContainer_1bjz4_1",Qe="_mainContainer__container_1bjz4_4",Xe="_mainContainer_buttonPanelBox_1bjz4_7",Ze="_mainContainer_buttonPanelBox_leftCreateButton_1bjz4_10",et="_mainContainer_filterPanelBox_1bjz4_13",tt="_timeTable_1bjz4_17",st="_mainContainer_filterPanelBox_leftFilterRadioGroupBox_1bjz4_20",nt="_activeFilter_1bjz4_25",at="_mainError_1bjz4_29",rt="_table_1bjz4_37",ct="_table__box_1bjz4_48",dt="_table__container_1bjz4_59",lt="_table__inner_1bjz4_79",ot="_wrapper_1bjz4_83",it="_studentBoxHeader_1bjz4_90",ut="_studentBoxTable_1bjz4_97",ht="_studentBoxTable__inner_1bjz4_116",_t="_studentBoxTable__input_1bjz4_121",xt="_status_1bjz4_129",jt="_status__inner_1bjz4_138",c={mainContainer:We,mainContainer__container:Qe,mainContainer_buttonPanelBox:Xe,mainContainer_buttonPanelBox_leftCreateButton:Ze,mainContainer_filterPanelBox:et,timeTable:tt,mainContainer_filterPanelBox_leftFilterRadioGroupBox:st,activeFilter:nt,mainError:at,table:rt,table__box:ct,table__container:dt,table__inner:lt,wrapper:ot,studentBoxHeader:it,studentBoxTable:ut,studentBoxTable__inner:ht,studentBoxTable__input:_t,status:xt,status__inner:jt},ne=[{name:"studying",label:"Students"},{name:"teachers",label:"Teachers"}],Qt=()=>{s.useEffect(()=>{D(be())},[]);const{request:o}=ce(),{"*":_}=ae();localStorage.getItem("theme"),pe();const{register:f,handleSubmit:B}=re();h(fe),h(ge);const C=h(Ce),G=h(Se),x=h(ve);h(Ne);const S=h(ie),[v,P]=s.useState(),[p,y]=s.useState(),[T,z]=s.useState([]),[N,i]=s.useState([]),[r,g]=s.useState(null),[A,k]=s.useState([]),[j,m]=s.useState(""),w=(t,l)=>{if(!r)g(l);else if(r!==l)return g(l),null;z(L=>L.filter(X=>X===t)[0]?L.filter(X=>X!==t):[...L,t])};s.useEffect(()=>{r&&o(`${R}Subjects/level-for-subject/${r}/`,"GET",null,q()).then(t=>{D(ye(t))}).catch(t=>console.log(t))},[r]);const[H,F]=s.useState(!1),[V,te]=s.useState([]),[$,W]=s.useState(ne[0].name),[J,U]=s.useState(!1),[se,n]=s.useState(!1),[u,d]=s.useState([]),[I,b]=s.useState(1);let Q=s.useMemo(()=>20,[]);const D=K(),ue=t=>{W(t)},he=s.useMemo(()=>{const t=G?.slice();return b(1),S?t.filter(l=>l?.user?.name?.toLowerCase().includes(S.toLowerCase())||l?.user?.surname?.toLowerCase().includes(S.toLowerCase())):t},[G,S]);s.useEffect(()=>{_&&D(Te({id:_})),o(`${R}TimeTable/week_days/`,"GET",null,q()).then(t=>{P(t?.days?.map(l=>({...l,name:l.name_uz})))}).catch(t=>console.log(t)),o(`${R}Group/course_types/`,"GET",null,q()).then(t=>{D(ke(t))}).catch(t=>console.log(t)),D(Be())},[_]);const _e=t=>t.map((l,L)=>e.jsx(e.Fragment,{children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{children:L+1}),e.jsxs("td",{children:[l.user.surname," ",l.user.name]}),e.jsx("td",{children:l.user.age})]})})})),xe=()=>C[p]?.students.map((t,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsxs("td",{children:[t.user.surname," ",t.user.name]}),e.jsx("td",{children:t.user.age}),e.jsx("td",{children:t.user.registered_date}),e.jsx("td",{children:t.user.comment}),e.jsx("td",{children:t.extra_info.status?e.jsxs("div",{className:c.studentBoxTable__inner,children:[e.jsx("div",{className:c.status,children:e.jsx("div",{className:c.status__inner})}),e.jsx(ze,{type:"checkbox",extraClassName:c.studentBoxTable__input,onChange:()=>w(t.id,C[p]?.id)})]}):null})]})),je=()=>C.map((t,l)=>t.subject_status?e.jsxs("div",{onClick:()=>{U(!J),y(l)},className:c.table__box,children:[e.jsx("h2",{className:c.table__title,children:t.name??"Ingliz tili"}),e.jsx("div",{className:c.table__container,children:e.jsxs(O,{extraClass:c.table__inner,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"â„–"}),e.jsx("th",{children:"Full name"}),e.jsx("th",{children:"Age"})]})}),_e(t.students)]})})]}):null),me=s.useCallback(t=>{i([t])},[N]);return e.jsxs("div",{children:[e.jsxs("div",{className:c.mainContainer,children:[e.jsx("div",{className:c.mainContainer_buttonPanelBox,children:e.jsxs("div",{className:c.mainContainer_buttonPanelBox_leftCreateButton,children:[e.jsx(M,{onClick:()=>m("groupCreate"),type:$==="studying"?j==="groupAdd"?"filter":"btn":"filter",extraClass:c.extraCutClass,children:"Create group"}),e.jsx(M,{onClick:()=>m("groupAdd"),type:j==="groupAdd"?"btn":"filter",extraClass:c.noneBackground,children:"Add group"})]})}),e.jsx("div",{className:c.mainContainer_filterPanelBox,children:e.jsx(M,{extraClass:c.timeTable,onClick:()=>m("timeTable"),status:"timeTable",type:"login",children:"Time Table"})}),e.jsx("div",{className:c.mainContainer_filterPanelBox_leftFilterRadioGroupBox,children:ne.map((t,l)=>e.jsx(Ge,{onChange:()=>ue(t.name),checked:$===t.name,extraClasses:$===t.name?c.activeFilter:null,children:t.label},l))})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:c.mainError,children:x?.rooms&&x.rooms[0]?e.jsx("h1",{children:x.rooms[0]}):null}),e.jsx("div",{className:c.mainContainer,children:$==="studying"?e.jsx("div",{className:c.table,children:je()}):e.jsxs("div",{className:c.mainContainer__container,children:[e.jsx(Ae,{data:u,setSelect:me,select:N}),e.jsx(de,{setCurrentTableData:d,users:he,setCurrentPage:b,currentPage:I,pageSize:Q,onPageChange:t=>{b(t)},type:"custom"})]})})]}),e.jsx(Y,{setActive:U,active:J,children:e.jsxs("div",{className:c.wrapper,children:[e.jsx("div",{className:c.studentBox,children:e.jsxs("div",{className:c.studentBoxHeader,children:[e.jsx("h1",{children:C[p]?.name}),e.jsx(Pe,{})]})}),e.jsx("div",{className:c.studentBoxTable,children:e.jsxs(O,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Ism Familiya"}),e.jsx("th",{children:"Yosh"}),e.jsx("th",{children:"Reg.sana"}),e.jsx("th",{children:"Koment"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:xe()})]})})]})}),e.jsx(Fe,{setActive:m,active:j==="timeTable",selectTime:A,setSelectTime:k,weekDays:v}),e.jsx(De,{setActive:m,active:j==="groupAdd"}),e.jsx(Me,{setActive:m,active:j==="groupCreate",selectedStudents:T,selectedTeachers:N,selectedSubjectId:r,selectedTime:A})]})},mt=o=>o.groupAttendanceSlice.attendance,bt=o=>o.groupAttendanceSlice.attendanceList,pt=o=>o.groupAttendanceSlice.loading,ft="_deletedGroups_1wcfg_1",gt="_mainContainer_filterPanelBox_1wcfg_4",Ct="_table_1wcfg_9",E={deletedGroups:ft,mainContainer_filterPanelBox:gt,table:Ct},Xt=()=>{const o=K(),_=h($e),f=h(we),B=h(Ke),C=h(Ie),{id:G}=h(le),x=G,S=h(Le),[v,P]=s.useState([]),[p,y]=s.useState(!1),[T,z]=s.useState(!1),[N,i]=s.useState(!1),r=h(ie);let g=s.useMemo(()=>50,[]);const[A,k]=s.useState([]),[j,m]=s.useState(1),w=s.useMemo(()=>{const F=N?f?.slice():_?.slice();return m(1),r?F.filter(V=>V.name?.toLowerCase().includes(r.toLowerCase())):F},[_,m,r,N,f]);s.useEffect(()=>{P(B)},[B]),s.useEffect(()=>{x&&o(Ee({userBranchId:x}))},[x]);const H=[{name:"Guruhlar",type:"groups"}];return e.jsx(Ue,{types:H,page:"groups",children:e.jsxs("div",{className:E.deletedGroups,children:[e.jsxs("div",{className:E.mainContainer_filterPanelBox,children:[e.jsx(M,{status:"filter",extraClass:E.extraCutClassFilter,onClick:()=>y(!p),type:"filter",children:"Filter"}),e.jsx(M,{type:"login",status:"timeTable",extraClass:E.extraCutClassFilter,onClick:()=>y(!0),children:"Time Table"})]}),C?e.jsx(oe,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:E.table,children:[e.jsx("h2",{children:T?S.name==="center"?"Deleted Groups":"Deleted Classes":S.name==="center"?"Groups":"Classes"}),T?e.jsx(Ye,{currentTableData:A}):e.jsx(Re,{currentTableData:A})]}),e.jsx(de,{setCurrentTableData:k,users:w,setCurrentPage:m,currentPage:j,pageSize:g,onPageChange:F=>{m(F)},type:"custom"})]}),e.jsx(qe,{setIsFilter:i,activeSwitch:T,setActiveSwitch:z,setActive:y,active:p})]})})},St="_attendance_1jo1b_1",vt="_attendance_end_1jo1b_4",Nt="_attendance_end_select_1jo1b_8",yt="_attendance_header_1jo1b_15",Tt="_attendance_icon_1jo1b_28",kt="_attendance_check_1jo1b_31",Bt="_attendance_times_1jo1b_35",Gt="_attendance_plus_1jo1b_62",At="_attendanceModal_1jo1b_89",Pt="_attendanceModal_header_1jo1b_92",Ft="_select_1jo1b_98",Dt="_attendedModal_1jo1b_102",Mt="_checkedStudents__item_1jo1b_108",zt="_infoStudent_1jo1b_113",$t="_typeChecked_1jo1b_119",wt="_green_1jo1b_129",It="_red_1jo1b_132",Lt="_info_1jo1b_113",Et="_button_1jo1b_140",Rt="_absent_1jo1b_144",qt="_text_1jo1b_151",Ot="_reason_1jo1b_161",Ht="_check_1jo1b_108",Vt="_th_1jo1b_174",Jt="_popup_1jo1b_177",a={attendance:St,attendance_end:vt,attendance_end_select:Nt,attendance_header:yt,attendance_icon:Tt,attendance_check:kt,attendance_times:Bt,attendance_plus:Gt,attendanceModal:At,attendanceModal_header:Pt,select:Ft,attendedModal:Dt,checkedStudents__item:Mt,infoStudent:zt,typeChecked:$t,green:wt,red:It,info:Lt,button:Et,absent:Rt,text:qt,reason:Ot,check:Ht,th:Vt,popup:Jt},Zt=()=>{const[o,_]=s.useState(!1),[f,B]=s.useState(!1),[C,G]=s.useState(null),[x,S]=s.useState(null),v=h(bt),P=h(pt),{id:p}=h(le),y=K();s.useEffect(()=>{y(Oe(p))},[]);const T=i=>{if(i)return i?.map(r=>{if(r.status===!0)return e.jsx("td",{className:"date true",children:e.jsx("i",{style:{color:"green",fontSize:"3rem"},className:" fas fa-check"})});if(r.status===!1)return e.jsx("td",{children:e.jsxs("div",{className:a.th,children:[e.jsx("i",{className:`fas fa-times ${a.check}`}),r.reason?e.jsx("div",{className:a.popup,children:r.reason}):null]})});if(r.status==="")return e.jsx("td",{className:"date true"})})},N=v?.students?.students?.map((i,r)=>e.jsxs("tr",{children:[e.jsx("td",{children:r+1}),e.jsxs("td",{children:[i?.name," ",i?.surname]}),T(i.days)]}));return e.jsxs("div",{className:a.attendance,children:[e.jsxs("div",{className:a.attendance_header,children:[e.jsx("h2",{children:"Davomat "}),e.jsxs("div",{className:a.attendance_end,children:[e.jsxs("div",{className:a.attendance_end_select,children:[e.jsx(ee,{extraClass:a.select,options:v?.students?.years?.map(i=>i?.year),onChangeOption:S,defaultValue:v?.students?.years[0]?.year}),x?e.jsx(ee,{extraClass:a.select,options:v?.students?.years?.filter(i=>i?.year===+x)[0]?.month,onChangeOption:G,defaultValue:v?.students?.years[0]?.month}):null]}),e.jsx("div",{onClick:()=>B(!f),className:`${a.attendance_plus} fa fa-plus`})]})]}),e.jsx("div",{children:e.jsxs(O,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism Familya"}),v?.students?.days.map(i=>e.jsx("th",{children:i}))]})}),e.jsx("tbody",{children:P?e.jsx(oe,{}):N})]})}),e.jsx(Ut,{active:f,setActive:B})]})},Ut=({active:o,setActive:_})=>{const{id:f}=ae(),B=K(),{request:C}=ce(),[G,x]=s.useState(!1),[S,v]=s.useState(""),[P,p]=s.useState(!1),[y,T]=s.useState(),{register:z,handleSubmit:N,setValue:i}=re(),[r,g]=s.useState([]);s.useEffect(()=>{B(He(f))},[]);const A=f,k=h(mt),[j,m]=s.useState(null),w=n=>{m(n);const u={date:`${k.month_number}-${n}`};C(`${R}Attendance/school-to-attend-days/${A}/`,"POST",JSON.stringify(u),q()).then(d=>{g(d.students)}).catch(d=>{console.log(d)})},H=n=>{g(u=>u.map(d=>d.id===n?{...d,attended:!0,typeChecked:"yes",reason:"",scores:{}}:d))},F=()=>r?.length>0?r?.map((n,u)=>{if(!n.attended)return e.jsxs("tr",{children:[e.jsx("td",{children:u+1}),e.jsxs("td",{children:[n?.name," ",n?.surname]}),e.jsx("td",{children:e.jsxs("div",{className:a.attendance_icon,children:[e.jsx("i",{onClick:()=>H(n?.id),className:`${a.attendance_check} fa fa-check`}),e.jsx("div",{onClick:()=>{p(!0),T(n.id)},className:"check__btn no",children:e.jsx("i",{className:`${a.attendance_times} fa fa-times`})})]})})]})}):e.jsxs(e.Fragment,{children:[e.jsx("td",{}),e.jsxs("td",{children:[" ",j?"Bu kunda hamma studentlar davomat qilingan":"Studentlar yo'q (kun tanlang)"]})]}),V=n=>{g(u=>u.map(d=>d.id===n?{...d,attended:!1}:d))},te=s.useCallback(()=>r?.length>=0?r.map(n=>{if(n.attended)return e.jsxs("div",{className:a.checkedStudents__item,onClick:()=>V(n.id),children:[e.jsxs("div",{className:a.infoStudent,children:[e.jsxs("div",{className:a.info,children:[e.jsx("span",{children:n.name}),e.jsx("span",{children:n.surname})]}),e.jsx("div",{className:a.typeChecked,children:n.typeChecked==="yes"?e.jsx("i",{className:`fas fa-plus-circle ${a.green} `}):e.jsx("i",{className:`fas fa-minus-circle ${a.red}`})})]}),n.reason?e.jsx("div",{className:a.reason,children:n.reason}):null]})}):e.jsx("h1",{children:"Studentlar yoq"}),[r]),$=({id:n,requestType:u,requestMsg:d})=>{g(I=>I.map(b=>n===b.id?{...b,requestType:u,requestMsg:d}:b))},W=n=>{i("reason",""),g(u=>u.map(d=>d.id===y?{...d,attended:!0,typeChecked:"no",reason:n.reason,date:{day:j},scores:{}}:d)),p(!1)},J=n=>{n.preventDefault(),r.map(u=>{if(u.attended){const d={date:`${k.month_number}-${j}`,students:[{...u,status:!u.reason}],group:Number(A),teacher:k.teachers},I=d?.students?.map(b=>b.id);$({id:u.id,requestType:"loading"}),C(`${R}Attendance/to_attend_school/${I}/`,"POST",JSON.stringify(d),q()).then(b=>{g(Q=>Q.filter(D=>D.id!==b.id)),x(!1)}).catch(b=>{console.log(b,"err")})}})},U=F(),se=te();return e.jsxs(e.Fragment,{children:[e.jsxs(Y,{active:o,setActive:_,children:[e.jsxs("div",{className:a.attendanceModal,children:[e.jsx("h2",{children:k?.month}),e.jsxs("div",{className:a.attendanceModal_header,children:[e.jsx(ee,{extraClass:a.select,options:k?.weekdays,onChangeOption:w,defaultValue:j}),e.jsx(M,{onClick:()=>x(!0),children:"Davomat qilinganlar"})]})]}),e.jsx("div",{children:e.jsxs(O,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Ism Familiya"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:U})]})})]}),e.jsxs(Y,{active:G,setActive:x,children:[e.jsx("h2",{className:a.attended_title,children:"Davomat qilinganlar"}),e.jsxs("div",{className:a.attendedModal,children:[e.jsx("div",{className:"checkedStudents",children:r?.filter(n=>n?.attended)?.length===0?e.jsx("h1",{children:"Studentlar davomat qilinmagan"}):null}),se,r?.filter(n=>n?.attended)?.length===0?null:e.jsx(M,{extraClass:a.button,type:j?"":"disabled",onClick:J,children:"Kritish"})]})]}),e.jsxs(Y,{id:"1",active:P,setActive:p,children:[e.jsxs("div",{className:a.text,children:["Izoh qoldirish ",e.jsx("br",{})," ",e.jsx("div",{children:"( student kemaganligi haqida )"})," "]}),e.jsx("div",{className:a.absent,children:e.jsx(Ve,{onSubmit:N(W),children:e.jsx(Je,{register:z,name:"reason",id:"comment"})})})]})]})};export{Zt as GroupAttendance,Qt as GroupCreatePage,Xt as GroupsPage};
