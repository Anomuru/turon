import{aa as x,h as g,A as C,i as j,ab as X,j as e,z as Z,F as K,I as M,B as U,r as _,n as Q,u as F,ba as Y,a as $,d as ss,T as es,e as D,o as V,g as as}from"./index-DJEj1NQv.js";import"./seq-D4fLl93z.js";import{Z as ls}from"./index-BHqgiX3-.js";import{C as rs}from"./confirmModal-DZpNvp7H.js";const B=x("classSlice/createClassType",async l=>{const{request:s}=g();return await s(`${C}Class/class_types/`,"POST",JSON.stringify(l),j())}),O=x("classSlice/getClassTypes",async l=>{const{request:s}=g();return await s(`${C}Class/class_types/?branch=${l}`,"GET",null,j())}),L=x("classSlice/updateClassType",async({id:l,data:s})=>{const{request:a}=g();return await a(`${C}Class/class_types/${l}/`,"PATCH",JSON.stringify(s),j())}),P=x("classSlice/getClassTypeNumber",async l=>{const{request:s}=g();return await s(`${C}Class/class_number_list/`,"GET",null,j())}),R=x("classSlice/classItem",async({id:l,branchId:s})=>{const{request:a}=g();return await a(`${C}Class/class_number/${l}/?branch=${s}`,"GET",null,j())}),k=x("classSlice/updateClassItem",async({idClass:l,res:s})=>{const{request:a}=g();return await a(`${C}Class/class_number_update/${l}/`,"PUT",JSON.stringify(s),j())}),z=x("classSlice/createColor",async l=>{const{request:s}=g();return await s(`${C}Class/class_colors/`,"POST",JSON.stringify(l),j())}),G=x("classSlice/getColor",async()=>{const{request:l}=g();return await l(`${C}Class/class_colors/`,"GET",null,j())}),E=x("classSlice/updateColor",async({id:l,res:s})=>{const{request:a}=g();return await a(`${C}Class/class_colors/${l}/`,"PATCH",JSON.stringify(s),j())}),H=x("classSlice/fetchClassSubjects",async()=>{const{request:l}=g();return await l(`${C}Subjects/subject/`,"GET",null,j())}),q=x("classSlice/getClassNewNumberList",async({branchId:l,id:s})=>{const{request:a}=g();return await a(`${C}Class/class_number_subject_list?branch=${l}&id=${s}`,"GET",null,j())}),cs={loading:!1,typeLoading:!1,error:!1,classData:[],classTypeNumber:[],classItems:[],color:[],subjects:[],classNewItems:[]},W=X({name:"classSlice",initialState:cs,reducers:{onDelete:(l,s)=>{l.color=l.color.filter(a=>a.id!==s.payload.id)},onDeleteTypes:(l,s)=>{l.classData=l.classData.filter(a=>a.id!==s.payload.id)},onChangeClassStatus:(l,s)=>{l.classNewItems=l.classNewItems.map(a=>a.id===s.payload.id?{...a,status:!a.status}:a)},onUpdateClass:(l,s)=>{l.classItems=l.classItems.map(a=>a.id===s.payload.id?{...a,price:s.payload.price,curriculum_hours:s.payload.curriculum_hours,subjects:s.payload.subjects}:a)}},extraReducers:l=>l.addCase(O.pending,s=>{s.typeLoading=!0,s.error=!1}).addCase(O.fulfilled,(s,a)=>{s.classData=a.payload,s.typeLoading=!1,s.error=!1}).addCase(O.rejected,s=>{s.error=!0,s.typeLoading=!1}).addCase(B.pending,s=>{s.loading=!0,s.error=!1}).addCase(B.fulfilled,(s,a)=>{s.classData=[...s.classData,a.payload],s.loading=!1,s.error=!1}).addCase(B.rejected,s=>{s.error=!0,s.loading=!1}).addCase(L.pending,s=>{s.loading=!0,s.error=!1}).addCase(L.fulfilled,(s,a)=>{s.classData=[...s.classData.filter(o=>o.id!==a.payload.id),a.payload],s.loading=!1,s.error=!1}).addCase(L.rejected,s=>{s.error=!0,s.loading=!1}).addCase(P.pending,s=>{s.loading=!0,s.error=!1}).addCase(P.fulfilled,(s,a)=>{s.classTypeNumber=a.payload,s.loading=!1,s.error=!1}).addCase(P.rejected,s=>{s.error=!0,s.loading=!1}).addCase(R.pending,s=>{s.loading=!0,s.error=!1}).addCase(R.fulfilled,(s,a)=>{s.loading=!1,s.error=!1,s.classItems=a.payload}).addCase(R.rejected,s=>{s.loading=!1,s.error=!0}).addCase(k.pending,s=>{s.loading=!0,s.error=!1}).addCase(k.fulfilled,(s,a)=>{s.loading=!1,s.error=!1,s.classNewItems=s.classNewItems.map(o=>o.id===a.payload.id?{...o,price:a.payload.price,subjects:a.payload.subjects}:o)}).addCase(k.rejected,s=>{s.loading=!1,s.error=!0}).addCase(z.pending,s=>{s.loading=!0,s.error=!1}).addCase(z.fulfilled,(s,a)=>{s.loading=!1,s.error=!1,s.color=[...s.color,a.payload]}).addCase(z.rejected,s=>{s.loading=!1,s.error=!0}).addCase(G.pending,s=>{s.loading=!0,s.error=!1}).addCase(G.fulfilled,(s,a)=>{s.loading=!1,s.error=!1,s.color=a.payload}).addCase(G.rejected,s=>{s.loading=!1,s.error=!0}).addCase(E.pending,s=>{s.loading=!0,s.error=!1}).addCase(E.fulfilled,(s,a)=>{s.loading=!1,s.error=!1,s.color=[...s.color.filter(o=>o.id!==a.payload.id),a.payload]}).addCase(E.rejected,s=>{s.loading=!1,s.error=!0}).addCase(H.pending,s=>{s.loading=!0,s.error=!1}).addCase(H.fulfilled,(s,a)=>{s.subjects=a.payload,s.loading=!1,s.error=!1}).addCase(H.rejected,s=>{s.loading=!1,s.error=!0}).addCase(q.pending,s=>{s.loading=!0,s.error=!1}).addCase(q.fulfilled,(s,a)=>{s.classNewItems=a.payload,s.loading=!1,s.error=!1}).addCase(q.rejected,s=>{s.loading=!1,s.error=!0})}),{onDelete:ns,onDeleteTypes:Js,onChangeClassStatus:ts,onUpdateClass:Ms}=W.actions,{reducer:Us}=W,os="_modalBtn_1d7c7_10",ds="_extraClassForm_1d7c7_15",is="_modalHeader_1d7c7_57",us="_items_1d7c7_65",ps="_checkbox__minus_1d7c7_70",fs="_active_1d7c7_79",_s="_changeColorItem_1d7c7_89",hs="_color_1d7c7_100",gs="_subject__main_1d7c7_107",Cs="_subject_1d7c7_107",N={modalBtn:os,extraClassForm:ds,modalHeader:is,items:us,checkbox__minus:ps,active:fs,changeColorItem:_s,color:hs,subject__main:gs,subject:Cs},js=({handleSubmit:l,register:s,setActive:a,active:o,changeName:u,setChangeName:i,changeColor:d,setColorChange:n,colorChange:p,deleteColor:c,edit:f})=>e.jsxs(Z,{active:u,setActive:i,children:[e.jsx("h2",{children:"Rangni oz'gartirish yoki O'chirish"}),e.jsx("div",{children:e.jsxs(K,{extraClassname:N.extraClassForm,typeSubmit:"",children:[e.jsx(M,{name:"name",register:s}),e.jsxs("div",{className:N.changeColorItem,children:[e.jsxs("div",{className:N.color,children:[e.jsx("h2",{children:"Tanlangan rang :"}),e.jsx("div",{style:{fontSize:"2rem"},children:p||f?.value})]}),e.jsx(ls,{style:{width:"30rem",height:"15rem"},color:f?.value,onChange:n})]}),e.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[e.jsx(U,{onClick:l(d),children:"Rangni o'zgartirish"}),f?.status?e.jsx(U,{onClick:l(()=>a(!o)),type:"danger",children:"Rangni O'chirish"}):null]}),e.jsx(rs,{setActive:a,active:o,onClick:l(c),type:"danger"})]})})]}),ms="_select_1d7c7_1",xs="_extraClassForm_1d7c7_15",bs="_container_1d7c7_21",ys="_input_1d7c7_26",Ss="_selectBox_1d7c7_34",w={select:ms,extraClassForm:xs,container:bs,input:ys,selectBox:Ss},vs=({selectOptions:l,editClass:s,setEditClass:a,edit:o,changedItem:u})=>{const[i,d]=_.useState([]),{register:n,handleSubmit:p,setValue:c}=Q(),{request:f}=g(),S=F(),v=t=>{const r={subjects:i,...t},h=s;c("price",i.price),S(k({idClass:h,res:r})),a(!s)},[b,T]=_.useState([]);_.useEffect(()=>{u?.id&&(d(u.subjects.map(t=>({value:t.id,label:t.name}))),c("curriculum_hours",u.curriculum_hours),c("price",u.price))},[u?.id]),_.useEffect(()=>{l?.length&&T(l?.map(t=>({value:t.id,label:t.name})))},[l]),_.useEffect(()=>{s&&f(`${C}Class/class_subjects?id=${s}`,"GET",null,j()).then(t=>{d(t.hours.map(r=>({value:r.id,label:r.name,hours:r.hours})))})},[s]);const y=(t,r)=>{d(h=>h.map(m=>m.value===t&&r!==m?.hours?{...m,hours:r}:m))};return e.jsx(e.Fragment,{children:e.jsxs(Z,{active:s,setActive:a,children:[e.jsx("h2",{children:"Ma’lumotlarni o’zgartirish "}),e.jsxs(K,{extraClassname:w.extraClassForm,typeSubmit:"",onSubmit:p(v),children:[e.jsxs("div",{className:w.container,children:[e.jsxs("div",{children:[e.jsx(M,{name:"price",register:n,value:i.price,type:"number",placeholder:"narxi"}),e.jsx("div",{className:w.selectBox,children:e.jsx(Y,{extraClass:w.select,value:i,options:b,onChange:d})})]}),e.jsx("div",{className:w.input,children:i.map(t=>e.jsx(M,{value:t.hours,type:"number",title:t.label,onChange:r=>y(t.value,r.target.value)}))})]}),e.jsx(U,{children:"Tastiqlash"})]})]})})},Ns=l=>l.classSlice?.loading,Ts=l=>l.classSlice?.typeLoading,Vs=l=>l.classSlice?.classData,Zs=l=>l.classSlice?.color,Is=l=>l.classSlice?.subjects,ws=l=>l.classSlice?.classNewItems,$s=({edit:l})=>{const[s,a]=_.useState(!1),[o,u]=_.useState({}),i=$(Is),d=$(ws),n=$(Ns),{request:p}=g(),c=F(),[f,S]=_.useState([]),[v,b]=_.useState(null);_.useEffect(()=>{if(s){const r=d.find(h=>h.id===s);b(r)}},[s,d]);const T=({id:r,type:h})=>{const m={status:!h,class_type_id:l.id,class_number_id:r};p(`${C}Class/class_number_update_status/`,"POST",JSON.stringify(m),j()).then(A=>{c(ts({id:r})),c(V({type:"success",status:!0,msg:A.msg}))}).catch(A=>{console.log(A)})},t=d?.map((r,h)=>e.jsxs("tr",{children:[e.jsx("td",{children:h+1}),e.jsx("td",{children:r?.number}),e.jsx("td",{children:e.jsx("div",{className:N.subject__main,children:r?.subjects.map(m=>e.jsxs("span",{className:N.subject,children:[" ",m.name,"-",m.hours]}))})}),e.jsx("td",{children:r.price}),e.jsx("td",{style:{width:"3rem"},children:e.jsxs("div",{className:N.items,children:[e.jsx("div",{onClick:()=>T({id:r.id,type:r.status}),className:D(N.checkbox__minus,{[N.active]:r.status}),children:r.status?e.jsx("i",{className:"fa fa-check "}):e.jsx("i",{className:"fa fa-minus"})}),e.jsx("i",{onClick:()=>{a(r.id),u(r)},className:"fa fa-pen"})]})})]}));return e.jsxs("div",{children:[n?e.jsx(ss,{}):e.jsxs(es,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Sinf Raqami"}),e.jsx("th",{children:"Fanlari"}),e.jsx("th",{children:"Narxi"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t})]}),e.jsx(vs,{setEditClass:a,selectOptions:i,editClass:s,changedItem:o,edit:l})]})},Fs="_classFilter_1gofp_1",ks="_classFilter__wrapper_1gofp_4",Es="_active_1gofp_7",qs="_loader_1gofp_12",Ds="_loader__circle_1gofp_16",I={classFilter:Fs,classFilter__wrapper:ks,active:Es,loader:qs,loader__circle:Ds},As=({classesType:l,active:s,setActive:a,setEdit:o})=>{const u=F(),i=$(as),d=$(Ts),n=_.useCallback(c=>{u(q({branchId:i,id:c}))},[i]);function p(c,f){return c.id-f.id}return e.jsx("div",{className:I.classFilter,children:e.jsx("div",{className:D(I.classFilter__wrapper,{[I.active]:d}),children:d?e.jsx("div",{className:I.loader,children:e.jsx("div",{className:I.loader__circle,children:e.jsx("div",{})})}):e.jsx("ul",{children:[...l].sort(p)?.map((c,f)=>e.jsxs("li",{className:D(I.classFilter_li,{[I.active]:s===c?.id}),onClick:()=>{n(c.id),a(c.id),o({id:c.id,name:c.name})},children:[c?.name,e.jsx("div",{children:c.class_numbers?.map(S=>e.jsx("span",{children:S?.number}))})]},f))})})})},Bs="_filter__wrapper_1opxw_1",J={filter__wrapper:Bs},Os=({color:l,setEdit:s,setChangeName:a,changeName:o,setValue:u})=>{const d=l.map((n,p)=>{function c(b){var T=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;b=b.replace(T,function(t,r,h,m){return r+r+h+h+m+m});var y=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return y?{r:parseInt(y[1],16),g:parseInt(y[2],16),b:parseInt(y[3],16)}:null}const f=c(n?.value?n?.value:"#ffffff"),S=Math.round((parseInt(f?.r)*299+parseInt(f?.g)*587+parseInt(f?.b)*114)/1e3),v={backgroundColor:n?.value?n?.value:"white",color:S>125?"black":"white"};return e.jsxs("li",{style:v,className:D(J.classFilter_li),onClick:()=>{s(n),u("name",n.name),a(!o)},children:[n.name,e.jsx("span",{children:n.class})]},p)});return e.jsx("div",{className:J.filter,children:e.jsx("div",{className:J.filter__wrapper,children:e.jsx("ul",{children:d})})})},Ls=({color:l,setEdit:s,edit:a})=>{const{register:o,handleSubmit:u,setValue:i}=Q(),[d,n]=_.useState(!1),p=F(),[c,f]=_.useState(!1),{request:S}=g(),[v,b]=_.useState(""),T=t=>{const r=a.id,h={value:v||a.value,...t};p(E({id:r,res:h})),i("name",""),n(!d),p(V({msg:"rang muvaffaqiyatli o'zgartirildi",status:!0,type:"success"}))},y=()=>{const t=a.id;S(`${C}Class/class_colors-delete/${t}/`,"DELETE",null,j()).then(r=>{p(ns({id:t})),n(!d),f(!1),p(V({msg:r.msg,status:!0,type:"success"}))}).catch(r=>{console.log(r)})};return e.jsxs(e.Fragment,{children:[e.jsx(Os,{color:l,edit:a,setEdit:s,changeName:d,setChangeName:n,setValue:i}),e.jsx(js,{setActive:f,active:c,edit:a,changeName:d,setChangeName:n,changeColor:T,handleSubmit:u,register:o,colorChange:v,setColorChange:b,deleteColor:y})]})},Ps=({setEdit:l,edit:s,setActiveEdit:a,activeMenu:o,setActiveMenu:u,classes:i,branch:d})=>{const[n,p]=_.useState([]);F();const c=s.id;return e.jsxs(e.Fragment,{children:[e.jsx(As,{classesType:i,setActiveEdit:a,edit:s,setEdit:l,active:o,setActive:u,branch:d}),e.jsx($s,{id:c,active:o,selectBox:n,setSelectBox:p,edit:s})]})},Ks=Object.freeze(Object.defineProperty({__proto__:null,ClassAddColorPage:Ls,ClassPage:Ps},Symbol.toStringTag,{value:"Module"}));export{Ps as C,z as a,B as b,N as c,Vs as d,Zs as e,G as f,O as g,H as h,Us as i,Ls as j,Ks as k,Js as o,L as u};
