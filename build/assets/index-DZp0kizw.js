import{r as s,j as e,B as k,e as S,bc as te,T as R,n as W,z as G,F as X,I,S as J,ba as Z,M as ee,bF as F,bG as ae,bH as ne,bI as re,C as N,u as ie,bJ as ce,bK as le,a as E,bL as oe,D as de,bM as me,o as V,bN as ue,h as _e,A as he,i as pe,bO as je}from"./index-BsgSvAdU.js";import{g as xe}from"./searchSelector-B3qtoac4.js";import{P as be}from"./pagination-BKwMBOPR.js";import{a as ve,C as fe}from"./confirmModal-UuIEyXZr.js";const ge="_header_lodna_1",Le="_header__container_lodna_6",ye="_inner__btn_lodna_15",Te="_active_lodna_18",$={header:ge,header__container:Le,inner__btn:ye,active:Te},Ce=s.memo(o=>{const{isCreate:t,setIsCreate:u,setIsFilter:_,setStatus:m}=o;return e.jsx("div",{className:$.header,children:e.jsx("div",{className:$.header__container,children:e.jsx(k,{onClick:()=>{u(!t),m(!1)},type:t?"simple":"simple-add",extraClass:S($.inner__btn,t?"":$.active),children:"Create Time"})})})}),Ne="_timeTableList_oowao_1",De="_timeTableList__icon_oowao_18",K={timeTableList:Ne,timeTableList__icon:De},Se=s.memo(o=>{const{data:t,setIsChange:u,loading:_,setStatus:m}=o,j=s.useCallback(()=>t?.sort(h).map((x,y)=>e.jsxs("tr",{children:[e.jsx("td",{children:y+1}),e.jsxs("td",{children:[x.order,"-dars"]}),e.jsx("td",{children:x.start_time?.slice(0,5)}),e.jsx("td",{children:x.end_time?.slice(0,5)}),e.jsx("td",{children:x.name}),e.jsx("td",{}),e.jsx("td",{children:e.jsx("i",{onClick:()=>{u(x),m(!1)},className:S("fas fa-pen",K.timeTableList__icon)})})]})),[t,_])();function h(x,y){return x.order-y.order}return _?e.jsx(te,{}):e.jsx("div",{className:K.timeTableList,children:e.jsxs(R,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Soatlar roâ€™yxati"}),e.jsx("th",{children:"Boshlanish vaqt"}),e.jsx("th",{children:"Tugash vaqti"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Sinf"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:j})]})})}),Ie="_create_dnjzo_1",we="_create__input_dnjzo_6",ke="_create__btn_dnjzo_21",M={create:Ie,create__input:we,create__btn:ke},Me=s.memo(o=>{const{classInput:t,active:u,setActive:_,onSubmit:m,loading:d}=o,j=[{name:"Yuqori",value:"high"},{name:"Boshlang'ich",value:"initial"}],{register:h,handleSubmit:x,reset:y}=W(),[p,b]=s.useState(null),[T,g]=s.useState([]);return s.useEffect(()=>{g(t.map(L=>({value:L.id,label:L.name})))},[t]),e.jsx(G,{active:u,setActive:_,children:e.jsx(X,{onSubmit:x(L=>{m({...L,types:p?.map(r=>r.value)}),y()}),typeSubmit:"",children:e.jsxs("div",{className:M.create,children:[e.jsx("h1",{children:"Soat yaratish"}),e.jsx(I,{extraClassName:M.create__input,placeholder:"Boshlanish vaqti",register:h,name:"start_time",type:"time",required:!0}),e.jsx(I,{extraClassName:M.create__input,placeholder:"Tugash vaqti",register:h,name:"end_time",type:"time",required:!0}),e.jsx(I,{extraClassName:M.create__input,placeholder:"Soati",register:h,name:"order",type:"number",required:!0}),e.jsx(I,{extraClassName:M.create__input,placeholder:"Name",register:h,name:"name",required:!0}),e.jsx(J,{name:"type",register:h,required:!0,options:j}),e.jsx(Z,{options:T,onChange:b,value:p,fontSize:15}),d?e.jsx(ee,{}):e.jsx(k,{extraClass:M.create__btn,type:"simple",children:"Yaratish"})]})})})}),Ae="_change_1uf17_1",qe="_change__input_1uf17_6",Ee="_change__btn_1uf17_21",w={change:Ae,change__input:qe,change__btn:Ee},$e=s.memo(o=>{const{register:t,handleSubmit:u,setValue:_}=W(),{classInput:m,active:d,setActive:j,onSubmit:h,loading:x,onDelete:y}=o;let p=s.useMemo(()=>d?.start_time,[d]),b=s.useMemo(()=>d?.end_time,[d]),T=s.useMemo(()=>d?.order,[d]),g=s.useMemo(()=>d?.name,[d]),L=s.useMemo(()=>d?.type,[d]);const[r,c]=s.useState([]),[a,n]=s.useState([]);s.useEffect(()=>{_("start_time",p),_("end_time",b),_("order",T),_("name",g),_("type",L)},[d]);const i=[{name:"Yuqori",value:"high"},{name:"Boshlang'ich",value:"initial"}];return s.useEffect(()=>{c(d?.types.map(D=>({value:D.id,label:D.name})))},[d?.types]),s.useEffect(()=>{n(m.map(D=>({value:D.id,label:D.name})))},[]),e.jsx(G,{active:d,setActive:j,children:e.jsx(X,{typeSubmit:"",children:e.jsxs("div",{className:w.change,children:[e.jsx("h1",{children:"Change time"}),e.jsx(I,{extraClassName:w.change__input,placeholder:"Boshlanish vaqti",register:t,name:"start_time",type:"time",required:!0}),e.jsx(I,{extraClassName:w.change__input,placeholder:"Tugash vaqti",register:t,name:"end_time",type:"time",required:!0}),e.jsx(I,{extraClassName:w.change__input,placeholder:"Order",register:t,name:"order",type:"number",required:!0}),e.jsx(I,{extraClassName:w.change__input,placeholder:"Name",register:t,name:"name",required:!0}),e.jsx(Z,{options:a,onChange:c,value:r,fontSize:15}),e.jsx(J,{name:"type",register:t,required:!0,options:i,defaultValue:L}),x?e.jsx(ee,{}):e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx(k,{onClick:u(h),extraClass:w.change__btn,type:"simple",children:"O'zgartirish"}),e.jsx(k,{onClick:u(y),extraClass:w.change__btn,type:"danger",children:"O'chirish"})]})]})})})}),Fe="_timeTableFilters_mw11o_1",ze="_navigators_mw11o_6",Ye="_navigators__inner_mw11o_11",Be="_timeTableFilters__icon_mw11o_15",Ue="_classList_mw11o_26",Pe="_classList__inner_mw11o_31",Oe="_active_mw11o_40",He="_colorList_mw11o_47",Ve="_colorList__inner_mw11o_50",Re="_typesList_mw11o_62",Ge="_typesList__inner_mw11o_69",Je="_typesList__active_mw11o_77",Ke="_subjectsList_mw11o_86",Qe="_subjectsList__inner_mw11o_94",f={timeTableFilters:Fe,navigators:ze,navigators__inner:Ye,timeTableFilters__icon:Be,classList:Ue,classList__inner:Pe,active:Oe,colorList:He,colorList__inner:Ve,typesList:Re,typesList__inner:Ge,typesList__active:Je,subjectsList:Ke,subjectsList__inner:Qe},We=[{id:1,value:"Subjects"},{id:2,value:"Teacher"},{id:3,value:"Room"}],Xe=[15.55,48.5,80.7];s.memo(o=>{const{activeDrag:t,setData:u,setActiveModal:_,setActive:m,setActiveDrop:d,setActiveDrag:j,classData:h,colorData:x,branchData:y,roomData:p,subjectData:b,teacherData:T}=o,[g,L]=s.useState([]),[r,c]=s.useState(1),[a,n]=s.useState(1),[i,D]=s.useState([]);s.useEffect(()=>{m(g),d(null),j(null)},[g]),s.useEffect(()=>{D(a===1&&b?b:a===2&&T?T:p),u(null)},[a,T,b,p]),s.useEffect(()=>{i&&u(a===2?{name:i.filter(l=>l.id===t)[0]?.user?.name,surname:i.filter(l=>l.id===t)[0]?.user?.surname,value:"teacher",id:i.filter(l=>l.id===t)[0]?.id}:{name:i.filter(l=>l.id===t)[0]?.name,value:a===1?"subject":"room",id:i.filter(l=>l.id===t)[0]?.id})},[t]);const z=()=>h?.map(l=>e.jsxs("div",{className:S(f.classList__inner,{[f.active]:g.includes(l.id)}),onClick:()=>L(H=>g.includes(l.id)?[...H.filter(se=>se!==l.id)]:[...H,l.id]),children:[g.includes(l.id)?e.jsx("img",{src:ae,alt:""}):null,l.name]})),Y=()=>x?.map(l=>e.jsx("div",{className:S(f.colorList__inner,{[f.active]:r===l.id}),onClick:()=>c(l.id),children:l.value})),B=()=>We.map(l=>e.jsx("div",{className:S(f.typesList__inner,{[f.active]:a===l.id}),onClick:()=>n(l.id),children:l.value})),U=s.useCallback(()=>i.map((l,H)=>e.jsx(F,{extraClass:f.subjectsList__inner,id:l.id,data:{hello:1},children:a===2?`${l?.user?.name} ${l?.user?.surname}`:l.name})),[a,i]),P=z(),C=Y(),A=B(),O=U();return e.jsxs("div",{className:f.timeTableFilters,children:[e.jsxs("div",{className:f.navigators,children:[e.jsxs("div",{id:"unique-id",className:f.navigators__inner,children:[e.jsx(k,{type:"simple",children:"Class"}),e.jsx(k,{type:"simple-add",children:"Patok"})]}),e.jsx(J,{title:"Branch",options:y})]}),e.jsx("div",{onClick:()=>_(!0),className:f.timeTableFilters__icon,children:e.jsx("i",{className:"fas fa-cog"})}),e.jsx("div",{className:f.classList,children:P}),e.jsx("div",{className:f.colorList,children:C}),e.jsxs("div",{className:f.typesList,children:[A,e.jsx("div",{className:f.typesList__active,style:{left:`${Xe[a-1]}%`}})]}),e.jsx("div",{className:f.subjectsList,children:O})]})});const Ze="_schedule_9m7ae_1",es="_schedule__inner_9m7ae_4",ss="_index_9m7ae_7",ts="_subject_9m7ae_45",as="_notActive_9m7ae_48",ns="_teacher_9m7ae_51",rs="_room_9m7ae_60",is="_schedule__time_9m7ae_66",v={schedule:Ze,schedule__inner:es,index:ss,subject:ts,notActive:as,teacher:ns,room:rs,schedule__time:is},cs=s.memo(o=>{const{subjectData:t,activeDrop:u,uid:_,data:m,index:d,onSubmit:j,onDelete:h,classId:x,userBranchId:y}=o,[p,b]=s.useState([]);s.useEffect(()=>{b(m?.time_tables.map((r,c)=>({weekday:{name:r.weekday.name,id:r.weekday.id,lessons:r.weekday.lessons.map((a,n)=>{let i=_+(r.weekday.id+(n+1))*(a.hour.id+(c+1));return{id:a.id,hour:a.hour,status:a.status,uid:i,subject:{id:a?.subject?.id,name:a?.subject?.name,itemUID:a?.subject?.id?i+"subject":null},room:{id:a?.room?.id,name:a?.room?.name,itemUID:a?.room?.id?i+"room":null},teacher:{id:a?.teacher?.id,name:a?.teacher?.name,surname:a?.teacher?.surname,itemUID:a?.teacher?.id?i+"teacher":null}}})}})))},[m]),s.useEffect(()=>{t&&p?.length&&b(p.map(r=>({weekday:{name:r.weekday.name,id:r.weekday.id,lessons:r.weekday.lessons.map(c=>c.uid===u?{hour:c.hour,status:c.status,uid:c.uid,subject:t.value==="subject"?t:c.subject,teacher:t.value==="teacher"?t:c.teacher,room:t.value==="room"?t:c.room}:c)}})))},[m,u,t]),s.useEffect(()=>{if(u){let r,c;p.filter(a=>a.weekday.lessons.map(n=>{n.uid===u&&(r=n,c=a.weekday.id)})),r?.room.id&&r?.teacher.id&&r?.subject.id&&j({group:x,week:c,room:r?.room?.id,hours:r?.hour?.id,branch:y,teacher:r?.teacher?.id,subject:r?.subject?.id})}},[u,p]);const g=s.useCallback(()=>p?.map((r,c)=>{const a=e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"3rem 1.5rem"},children:r?.weekday?.name?.slice(0,3)}),r?.weekday?.lessons?.map((n,i)=>(n.status,e.jsx("td",{className:v.days__item,children:e.jsxs(ne,{id:n.uid,children:[n.subject?.name?e.jsx(F,{id:n.subject.itemUID,children:e.jsx("p",{className:S(v.subject,{[v.notActive]:!n.subject?.name}),children:n?.subject?.name})}):e.jsx("p",{className:S(v.subject,{[v.notActive]:!n.subject?.name}),children:n?.subject?.name}),n.teacher?.name?e.jsx(F,{id:n.teacher.itemUID,children:e.jsxs("p",{className:S(v.teacher,{[v.notActive]:!n.teacher?.name}),children:[e.jsx("span",{children:n?.teacher?.name}),e.jsx("span",{children:n?.teacher?.surname})]})}):e.jsxs("p",{className:S(v.teacher,{[v.notActive]:!n.teacher?.name}),children:[e.jsx("span",{children:n?.teacher?.name}),e.jsx("span",{children:n?.teacher?.surname})]}),n.room?.name?e.jsx(F,{id:n.room.itemUID,children:e.jsx("p",{className:S(v.room,{[v.notActive]:!n.room?.name}),children:n?.room?.name})}):e.jsx("p",{className:S(v.room,{[v.notActive]:!n.room?.name}),children:n?.room?.name})]},n.uid)})))]});return e.jsx(re,{onDragEnd:L,children:a})}),[p,_])();function L(r){const{active:c,over:a}=r;p.map(n=>{n.weekday.lessons.map(i=>{c.id.includes("subject")?i.uid===c.id.slice(0,i.uid.length)&&i.uid!==a.id&&h({id:i.id,res:{item_type:"subject"}}):c.id.includes("room")?i.uid===c.id.slice(0,i.uid.length)&&i.uid!==a.id&&h({id:i.id,res:{item_type:"room"}}):i.uid===c.id.slice(0,i.uid.length)&&i.uid!==a.id&&h({id:i.id,res:{item_type:"teacher"}})})})}return e.jsx("div",{className:v.schedule,children:e.jsxs(R,{extraClass:v.schedule__inner,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),m?.hours_list?.map((r,c)=>e.jsxs("th",{children:[e.jsx("p",{className:v.index,children:c+1}),e.jsxs("div",{className:v.schedule__time,children:[e.jsx("p",{children:r?.start_time.slice(0,5)}),"-",e.jsx("p",{children:r?.end_time.slice(0,5)})]})]}))]})}),e.jsx("tbody",{children:g})]})})}),ls="_error_1y39z_1",os="_error__header_1y39z_6",ds="_inner_1y39z_11",ms="_error__btn_1y39z_22",us="_error__list_1y39z_25",q={error:ls,error__header:os,inner:ds,error__btn:ms,error__list:us},_s=[{img:N,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:N,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:N,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:N,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:N,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:N,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:N,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:N,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:N,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:N,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:N,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:N,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"}];s.memo(({setActive:o,active:t})=>{const _=_s.map(m=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:m.img,alt:""})}),e.jsx("td",{children:m.fullName}),e.jsx("td",{children:m.phone}),e.jsx("td",{children:m.comment})]}));return e.jsx(G,{setActive:o,active:t,children:e.jsxs("div",{className:q.error,children:[e.jsxs("div",{className:q.error__header,children:[e.jsx("img",{src:ve,alt:""}),e.jsxs("div",{className:q.inner,children:[e.jsx("h1",{children:"Error"}),e.jsx("span",{children:"1 blueda hato chiqdi"})]})]}),e.jsx(k,{type:"danger",extraClass:q.error__btn,children:e.jsx("i",{className:"far fa-check-circle"})}),e.jsx("div",{className:q.error__list,children:e.jsxs(R,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism Familiya"}),e.jsx("th",{children:"Tel"}),e.jsx("th",{children:"Comment"})]})}),e.jsx("tbody",{children:_})]})})]})})});const hs="_scheduleList_mfdk0_1",ps={scheduleList:hs};s.memo(o=>{const{data:t,subjectData:u,activeDrop:_,length:m,onSubmit:d,onDelete:j,userBranchId:h,handleDragEndInner:x}=o,p=s.useCallback(()=>t?.map((b,T)=>e.jsx(cs,{uid:`${m[T]}class`,subjectData:u,activeDrop:_,data:b.data,index:T+1,onSubmit:d,onDelete:j,classId:m[T],userBranchId:h,handleDragEndInner:x})),[m,_,t,u,d,j])();return e.jsx("div",{className:ps.scheduleList,children:p})});const js=o=>o.TimeTableSlice?.data,xs=o=>o.TimeTableSlice?.loading,bs="_timeTable_nfy34_1",vs="_timeTable__table_nfy34_7",Q={timeTable:bs,timeTable__table:vs},fs={},Cs=()=>{s.useEffect(()=>{o(ce()),o(le())},[]);const o=ie(),t=E(js),u=E(oe),_=E(xs),[m,d]=s.useState(!1),[j,h]=s.useState(null),[x,y]=s.useState(!1),[p,b]=s.useState(!1),[T,g]=s.useState(!1),L=E(xe);let r=s.useMemo(()=>10,[]);const[c,a]=s.useState([]),[n,i]=s.useState(1),D=s.useMemo(()=>{const C=t?.slice();return i(1),L?C.filter(A=>A.name?.toLowerCase().includes(L.toLowerCase())):C},[t,i,L]),z=C=>{o(me(C)),o(V({type:"success",status:!0,msg:"Vaqt qo'shildi"})),d(!1),b(!0)},Y=C=>{const A=t?.filter(O=>O.id===j?.id)[0];o(ue({id:j?.id,obj:C})),o(V({type:"success",status:!0,msg:`${A?.name}ni malumotlari o'zgardi`})),b(!0)},{request:B}=_e(),U=()=>{B(`${he}SchoolTimeTable/hours-list-update/${j.id}`,"DELETE",null,pe()).then(C=>{o(je(j.id)),g(!1),o(V({status:!0,type:"success",msg:C.msg})),h(!1)}).catch(C=>{console.log(C)})},P=()=>{g(!0)};return e.jsx(de,{reducers:fs,children:e.jsxs("div",{className:Q.timeTable,children:[e.jsx(Ce,{isCreate:m,setIsCreate:d,setIsFilter:y,setStatus:b}),e.jsxs("div",{className:Q.timeTable__table,children:[e.jsx(Se,{data:c,setIsChange:h,loading:_,setStatus:b}),e.jsx(be,{setCurrentTableData:a,users:D,currentPage:n,pageSize:r,onPageChange:C=>{i(C)}})]}),e.jsx(Me,{classInput:u,active:p?!1:m,setActive:d,onSubmit:z,loading:_}),e.jsx($e,{classInput:u,active:p?!1:j,setActive:h,onSubmit:Y,loading:_,onDelete:P}),e.jsx(fe,{type:"danger",active:T,setActive:g,onClick:U})]})})};export{Cs as TimeTableListPage};
