import{r as t,j as e,B as k,i as D,O as oe,T as W,I,p as X,M as ae,a8 as de,a as Z,u as B,A as U,c as me,l as ue,n as E,h as he}from"./index-Cux8sda1.js";import"./index-CO9axSa1.js";import{s as _e,t as pe}from"./oftenUsedSelector-B4R2CTqR.js";import{o as Q}from"./alertSlice-XeBTN8B3.js";import{getSearchValue as je}from"./index-Dvh1lTlU.js";import{P as xe}from"./pagination-Cj0p_t2O.js";import{A as re}from"./workerSelect-N9ju4zO7.js";import{u as ne}from"./index.esm-DQmSsb0O.js";import{M as ee}from"./modal-BR27MEf1.js";import{F as ie}from"./form-C3mZZqBW.js";import{D as F,a as be}from"./droppable-CvZqsj53.js";import{D as fe}from"./core.esm-Crx2h5Ym.js";import{a as ve,C as ge}from"./confirmModal-DiNALKc8.js";import{d as S}from"./user_image-CruVt77w.js";import"./Transition-CosWKtpf.js";import"./cross-BXlnQeE0.js";const Te="_header_lodna_1",ye="_header__container_lodna_6",Le="_inner__btn_lodna_15",Ce="_active_lodna_18",$={header:Te,header__container:ye,inner__btn:Le,active:Ce},Se=t.memo(r=>{const{isCreate:s,setIsCreate:a,setIsFilter:m,setStatus:h}=r;return e.jsx("div",{className:$.header,children:e.jsx("div",{className:$.header__container,children:e.jsx(k,{onClick:()=>{a(!s),h(!1)},type:s?"simple":"simple-add",extraClass:D($.inner__btn,s?"":$.active),children:"Create Time"})})})}),Ne="_timeTableList_oowao_1",De="_timeTableList__icon_oowao_18",se={timeTableList:Ne,timeTableList__icon:De},Ie=t.memo(r=>{const{data:s,setIsChange:a,loading:m,setStatus:h}=r,j=t.useCallback(()=>s.sort(_).map((x,T)=>e.jsxs("tr",{children:[e.jsx("td",{children:T+1}),e.jsxs("td",{children:[x.order,"-dars"]}),e.jsx("td",{children:x.start_time?.slice(0,5)}),e.jsx("td",{children:x.end_time?.slice(0,5)}),e.jsx("td",{children:x.name}),e.jsx("td",{}),e.jsx("td",{children:e.jsx("i",{onClick:()=>{a(x),h(!1)},className:D("fas fa-pen",se.timeTableList__icon)})})]})),[s,m])();function _(x,T){return x.order-T.order}return m?e.jsx(oe,{}):e.jsx("div",{className:se.timeTableList,children:e.jsxs(W,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Soatlar roâ€™yxati"}),e.jsx("th",{children:"Boshlanish vaqt"}),e.jsx("th",{children:"Tugash vaqti"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Sinf"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:j})]})})}),we="_create_dnjzo_1",ke="_create__input_dnjzo_6",Ae="_create__btn_dnjzo_21",A={create:we,create__input:ke,create__btn:Ae},qe=t.memo(r=>{const{classInput:s,active:a,setActive:m,onSubmit:h,loading:u}=r,j=[{name:"Yuqori",value:"high"},{name:"Boshlang'ich",value:"initial"}],{register:_,handleSubmit:x,reset:T}=ne(),[p,b]=t.useState(null),[y,L]=t.useState([]);return t.useEffect(()=>{L(s.map(g=>({value:g.id,label:g.name})))},[s]),e.jsx(ee,{active:a,setActive:m,children:e.jsx(ie,{onSubmit:x(g=>{h({...g,types:p.map(l=>l.value)}),T()}),typeSubmit:"",children:e.jsxs("div",{className:A.create,children:[e.jsx("h1",{children:"Soat yaratish"}),e.jsx(I,{extraClassName:A.create__input,placeholder:"Boshlanish vaqti",register:_,name:"start_time",type:"time",required:!0}),e.jsx(I,{extraClassName:A.create__input,placeholder:"Tugash vaqti",register:_,name:"end_time",type:"time",required:!0}),e.jsx(I,{extraClassName:A.create__input,placeholder:"Soati",register:_,name:"order",type:"number",required:!0}),e.jsx(I,{extraClassName:A.create__input,placeholder:"Name",register:_,name:"name",required:!0}),e.jsx(X,{name:"type",register:_,required:!0,options:j}),e.jsx(re,{options:y,onChange:b,value:p,fontSize:15}),u?e.jsx(ae,{}):e.jsx(k,{extraClass:A.create__btn,type:"simple",children:"Yaratish"})]})})})}),Me="_change_1uf17_1",Ee="_change__input_1uf17_6",$e="_change__btn_1uf17_21",w={change:Me,change__input:Ee,change__btn:$e},Fe=t.memo(r=>{const{register:s,handleSubmit:a,setValue:m}=ne(),{classInput:h,active:u,setActive:j,onSubmit:_,loading:x,onDelete:T}=r;let p=t.useMemo(()=>u?.start_time,[u]),b=t.useMemo(()=>u?.end_time,[u]),y=t.useMemo(()=>u?.order,[u]),L=t.useMemo(()=>u?.name,[u]),g=t.useMemo(()=>u?.type,[u]);const[l,o]=t.useState([]),[n,i]=t.useState([]);t.useEffect(()=>{m("start_time",p),m("end_time",b),m("order",y),m("name",L),m("type",g)},[u]);const c=[{name:"Yuqori",value:"high"},{name:"Boshlang'ich",value:"initial"}];return t.useEffect(()=>{o(u?.types.map(N=>({value:N.id,label:N.name})))},[u?.types]),t.useEffect(()=>{i(h.map(N=>({value:N.id,label:N.name})))},[]),e.jsx(ee,{active:u,setActive:j,children:e.jsx(ie,{typeSubmit:"",children:e.jsxs("div",{className:w.change,children:[e.jsx("h1",{children:"Change time"}),e.jsx(I,{extraClassName:w.change__input,placeholder:"Boshlanish vaqti",register:s,name:"start_time",type:"time",required:!0}),e.jsx(I,{extraClassName:w.change__input,placeholder:"Tugash vaqti",register:s,name:"end_time",type:"time",required:!0}),e.jsx(I,{extraClassName:w.change__input,placeholder:"Order",register:s,name:"order",type:"number",required:!0}),e.jsx(I,{extraClassName:w.change__input,placeholder:"Name",register:s,name:"name",required:!0}),e.jsx(re,{options:n,onChange:o,value:l,fontSize:15}),e.jsx(X,{name:"type",register:s,required:!0,options:c,defaultValue:g}),x?e.jsx(ae,{}):e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx(k,{onClick:a(_),extraClass:w.change__btn,type:"simple",children:"O'zgartirish"}),e.jsx(k,{onClick:a(T),extraClass:w.change__btn,type:"danger",children:"O'chirish"})]})]})})})}),Ye="_timeTableFilters_mw11o_1",ze="_navigators_mw11o_6",Pe="_navigators__inner_mw11o_11",Be="_timeTableFilters__icon_mw11o_15",Ue="_classList_mw11o_26",Oe="_classList__inner_mw11o_31",He="_active_mw11o_40",Re="_colorList_mw11o_47",Ve="_colorList__inner_mw11o_50",Je="_typesList_mw11o_62",Ge="_typesList__inner_mw11o_69",Ke="_typesList__active_mw11o_77",Qe="_subjectsList_mw11o_86",We="_subjectsList__inner_mw11o_94",v={timeTableFilters:Ye,navigators:ze,navigators__inner:Pe,timeTableFilters__icon:Be,classList:Ue,classList__inner:Oe,active:He,colorList:Re,colorList__inner:Ve,typesList:Je,typesList__inner:Ge,typesList__active:Ke,subjectsList:Qe,subjectsList__inner:We},Xe=[{id:1,value:"Subjects"},{id:2,value:"Teacher"},{id:3,value:"Room"}],Ze=[15.55,48.5,80.7];t.memo(r=>{const{activeDrag:s,setData:a,setActiveModal:m,setActive:h,setActiveDrop:u,setActiveDrag:j,classData:_,colorData:x,branchData:T,roomData:p,subjectData:b,teacherData:y}=r,[L,g]=t.useState([]),[l,o]=t.useState(1),[n,i]=t.useState(1),[c,N]=t.useState([]);t.useEffect(()=>{h(L),u(null),j(null)},[L]),t.useEffect(()=>{N(n===1&&b?b:n===2&&y?y:p),a(null)},[n,y,b,p]),t.useEffect(()=>{c&&a(n===2?{name:c.filter(d=>d.id===s)[0]?.user?.name,surname:c.filter(d=>d.id===s)[0]?.user?.surname,value:"teacher",id:c.filter(d=>d.id===s)[0]?.id}:{name:c.filter(d=>d.id===s)[0]?.name,value:n===1?"subject":"room",id:c.filter(d=>d.id===s)[0]?.id})},[s]);const O=()=>_?.map(d=>e.jsxs("div",{className:D(v.classList__inner,{[v.active]:L.includes(d.id)}),onClick:()=>g(K=>L.includes(d.id)?[...K.filter(ce=>ce!==d.id)]:[...K,d.id]),children:[L.includes(d.id)?e.jsx("img",{src:de,alt:""}):null,d.name]})),H=()=>x?.map(d=>e.jsx("div",{className:D(v.colorList__inner,{[v.active]:l===d.id}),onClick:()=>o(d.id),children:d.value})),R=()=>Xe.map(d=>e.jsx("div",{className:D(v.typesList__inner,{[v.active]:n===d.id}),onClick:()=>i(d.id),children:d.value})),V=t.useCallback(()=>c.map((d,K)=>e.jsx(F,{extraClass:v.subjectsList__inner,id:d.id,data:{hello:1},children:n===2?`${d?.user?.name} ${d?.user?.surname}`:d.name})),[n,c]),J=O(),C=H(),q=R(),G=V();return e.jsxs("div",{className:v.timeTableFilters,children:[e.jsxs("div",{className:v.navigators,children:[e.jsxs("div",{id:"unique-id",className:v.navigators__inner,children:[e.jsx(k,{type:"simple",children:"Class"}),e.jsx(k,{type:"simple-add",children:"Patok"})]}),e.jsx(X,{title:"Branch",options:T})]}),e.jsx("div",{onClick:()=>m(!0),className:v.timeTableFilters__icon,children:e.jsx("i",{className:"fas fa-cog"})}),e.jsx("div",{className:v.classList,children:J}),e.jsx("div",{className:v.colorList,children:C}),e.jsxs("div",{className:v.typesList,children:[q,e.jsx("div",{className:v.typesList__active,style:{left:`${Ze[n-1]}%`}})]}),e.jsx("div",{className:v.subjectsList,children:G})]})});const es="_schedule_9m7ae_1",ss="_schedule__inner_9m7ae_4",ts="_index_9m7ae_7",as="_subject_9m7ae_45",rs="_notActive_9m7ae_48",ns="_teacher_9m7ae_51",is="_room_9m7ae_60",ls="_schedule__time_9m7ae_66",f={schedule:es,schedule__inner:ss,index:ts,subject:as,notActive:rs,teacher:ns,room:is,schedule__time:ls},cs=t.memo(r=>{const{subjectData:s,activeDrop:a,uid:m,data:h,index:u,onSubmit:j,onDelete:_,classId:x,userBranchId:T}=r,[p,b]=t.useState([]);t.useEffect(()=>{b(h?.time_tables.map((l,o)=>({weekday:{name:l.weekday.name,id:l.weekday.id,lessons:l.weekday.lessons.map((n,i)=>{let c=m+(l.weekday.id+(i+1))*(n.hour.id+(o+1));return{id:n.id,hour:n.hour,status:n.status,uid:c,subject:{id:n?.subject?.id,name:n?.subject?.name,itemUID:n?.subject?.id?c+"subject":null},room:{id:n?.room?.id,name:n?.room?.name,itemUID:n?.room?.id?c+"room":null},teacher:{id:n?.teacher?.id,name:n?.teacher?.name,surname:n?.teacher?.surname,itemUID:n?.teacher?.id?c+"teacher":null}}})}})))},[h]),t.useEffect(()=>{s&&p?.length&&b(p.map(l=>({weekday:{name:l.weekday.name,id:l.weekday.id,lessons:l.weekday.lessons.map(o=>o.uid===a?{hour:o.hour,status:o.status,uid:o.uid,subject:s.value==="subject"?s:o.subject,teacher:s.value==="teacher"?s:o.teacher,room:s.value==="room"?s:o.room}:o)}})))},[h,a,s]),t.useEffect(()=>{if(a){let l,o;p.filter(n=>n.weekday.lessons.map(i=>{i.uid===a&&(l=i,o=n.weekday.id)})),l?.room.id&&l?.teacher.id&&l?.subject.id&&j({group:x,week:o,room:l?.room?.id,hours:l?.hour?.id,branch:T,teacher:l?.teacher?.id,subject:l?.subject?.id})}},[a,p]);const L=t.useCallback(()=>p?.map((l,o)=>{const n=e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"3rem 1.5rem"},children:l?.weekday?.name?.slice(0,3)}),l?.weekday?.lessons?.map((i,c)=>(i.status,e.jsx("td",{className:f.days__item,children:e.jsxs(be,{id:i.uid,children:[i.subject?.name?e.jsx(F,{id:i.subject.itemUID,children:e.jsx("p",{className:D(f.subject,{[f.notActive]:!i.subject?.name}),children:i?.subject?.name})}):e.jsx("p",{className:D(f.subject,{[f.notActive]:!i.subject?.name}),children:i?.subject?.name}),i.teacher?.name?e.jsx(F,{id:i.teacher.itemUID,children:e.jsxs("p",{className:D(f.teacher,{[f.notActive]:!i.teacher?.name}),children:[e.jsx("span",{children:i?.teacher?.name}),e.jsx("span",{children:i?.teacher?.surname})]})}):e.jsxs("p",{className:D(f.teacher,{[f.notActive]:!i.teacher?.name}),children:[e.jsx("span",{children:i?.teacher?.name}),e.jsx("span",{children:i?.teacher?.surname})]}),i.room?.name?e.jsx(F,{id:i.room.itemUID,children:e.jsx("p",{className:D(f.room,{[f.notActive]:!i.room?.name}),children:i?.room?.name})}):e.jsx("p",{className:D(f.room,{[f.notActive]:!i.room?.name}),children:i?.room?.name})]},i.uid)})))]});return e.jsx(fe,{onDragEnd:g,children:n})}),[p,m])();function g(l){const{active:o,over:n}=l;p.map(i=>{i.weekday.lessons.map(c=>{o.id.includes("subject")?c.uid===o.id.slice(0,c.uid.length)&&c.uid!==n.id&&_({id:c.id,res:{item_type:"subject"}}):o.id.includes("room")?c.uid===o.id.slice(0,c.uid.length)&&c.uid!==n.id&&_({id:c.id,res:{item_type:"room"}}):c.uid===o.id.slice(0,c.uid.length)&&c.uid!==n.id&&_({id:c.id,res:{item_type:"teacher"}})})})}return e.jsx("div",{className:f.schedule,children:e.jsxs(W,{extraClass:f.schedule__inner,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),h?.hours_list?.map((l,o)=>e.jsxs("th",{children:[e.jsx("p",{className:f.index,children:o+1}),e.jsxs("div",{className:f.schedule__time,children:[e.jsx("p",{children:l?.start_time.slice(0,5)}),"-",e.jsx("p",{children:l?.end_time.slice(0,5)})]})]}))]})}),e.jsx("tbody",{children:L})]})})}),os="_error_1y39z_1",ds="_error__header_1y39z_6",ms="_inner_1y39z_11",us="_error__btn_1y39z_22",hs="_error__list_1y39z_25",M={error:os,error__header:ds,inner:ms,error__btn:us,error__list:hs},_s=[{img:S,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:S,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:S,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:S,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:S,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:S,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:S,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:S,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:S,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:S,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:S,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"},{img:S,fullName:"Mahmud Yo`Ldoshev",phone:"+998909773176",comment:"Lorem ipsum"}];t.memo(({setActive:r,active:s})=>{const m=_s.map(h=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:h.img,alt:""})}),e.jsx("td",{children:h.fullName}),e.jsx("td",{children:h.phone}),e.jsx("td",{children:h.comment})]}));return e.jsx(ee,{setActive:r,active:s,children:e.jsxs("div",{className:M.error,children:[e.jsxs("div",{className:M.error__header,children:[e.jsx("img",{src:ve,alt:""}),e.jsxs("div",{className:M.inner,children:[e.jsx("h1",{children:"Error"}),e.jsx("span",{children:"1 blueda hato chiqdi"})]})]}),e.jsx(k,{type:"danger",extraClass:M.error__btn,children:e.jsx("i",{className:"far fa-check-circle"})}),e.jsx("div",{className:M.error__list,children:e.jsxs(W,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism Familiya"}),e.jsx("th",{children:"Tel"}),e.jsx("th",{children:"Comment"})]})}),e.jsx("tbody",{children:m})]})})]})})});const ps="_scheduleList_mfdk0_1",js={scheduleList:ps};t.memo(r=>{const{data:s,subjectData:a,activeDrop:m,length:h,onSubmit:u,onDelete:j,userBranchId:_,handleDragEndInner:x}=r,p=t.useCallback(()=>s?.map((b,y)=>e.jsx(cs,{uid:`${h[y]}class`,subjectData:a,activeDrop:m,data:b.data,index:y+1,onSubmit:u,onDelete:j,classId:h[y],userBranchId:_,handleDragEndInner:x})),[h,m,s,a,u,j])();return e.jsx("div",{className:js.scheduleList,children:p})});const xs=r=>r.timeTableListSlice.data,bs=r=>r.timeTableListSlice.loading,Y=Z("timeTable/fetchTimeTableListData",async()=>{const{request:r}=B();return r(`${U}SchoolTimeTable/hours-list-create/`,"GET",null)}),z=Z("timeTable/createTimeTable",async r=>{const{request:s}=B();return s(`${U}SchoolTimeTable/hours-list-create/`,"POST",JSON.stringify(r))}),P=Z("timeTable/updateTimeTable",async({id:r,obj:s})=>{const{request:a}=B();return a(`${U}SchoolTimeTable/hours-list-update/${r}`,"PATCH",JSON.stringify(s))}),fs={data:[],loading:!1,error:null},le=me({name:"timeTable",initialState:fs,reducers:{onDelete:(r,s)=>{r.data=r.data.filter(a=>a.id!==s.payload)}},extraReducers:r=>r.addCase(Y.pending,s=>{s.loading=!0,s.error=null}).addCase(Y.fulfilled,(s,a)=>{s.data=a.payload,s.loading=!1,s.error=null}).addCase(Y.rejected,(s,a)=>{s.loading=!1,s.error=a.payload??null}).addCase(z.pending,s=>{s.loading=!0,s.error=null}).addCase(z.fulfilled,(s,a)=>{s.data=[...s.data,a.payload],s.loading=!1,s.error=null}).addCase(z.rejected,(s,a)=>{s.loading=!1,s.error=a.payload??null}).addCase(P.pending,s=>{s.loading=!0,s.error=null}).addCase(P.fulfilled,(s,a)=>{s.data=[...s.data.filter(m=>m.id!==a.payload.id),a.payload],s.loading=!1,s.error=null}).addCase(P.rejected,(s,a)=>{s.loading=!1,s.error=a.payload??null})}),zs=le.reducer,{changeTime:Ps,onDelete:vs}=le.actions,gs="_timeTable_nfy34_1",Ts="_timeTable__table_nfy34_7",te={timeTable:gs,timeTable__table:Ts},Bs=()=>{t.useEffect(()=>{r(Y()),r(_e())},[]);const r=ue(),s=E(xs),a=E(pe),m=E(bs),[h,u]=t.useState(!1),[j,_]=t.useState(null),[x,T]=t.useState(!1),[p,b]=t.useState(!1),[y,L]=t.useState(!1),g=E(je);let l=t.useMemo(()=>10,[]);const[o,n]=t.useState([]),[i,c]=t.useState(1),N=t.useMemo(()=>{const C=s?.slice();return c(1),g?C.filter(q=>q.name?.toLowerCase().includes(g.toLowerCase())):C},[s,c,g]),O=C=>{r(z(C)),r(Q({type:"success",status:!0,msg:"Vaqt qo'shildi"})),u(!1),b(!0)},H=C=>{const q=s?.filter(G=>G.id===j?.id)[0];r(P({id:j?.id,obj:C})),r(Q({type:"success",status:!0,msg:`${q?.name}ni malumotlari o'zgardi`})),b(!0)},{request:R}=B(),V=()=>{R(`${U}SchoolTimeTable/hours-list-update/${j.id}`,"DELETE",null,he()).then(C=>{r(vs(j.id)),r(Q({status:!0,type:"success",msg:C.msg})),_(!1)}).catch(C=>{console.log(C)})},J=()=>{L(!0)};return e.jsxs("div",{className:te.timeTable,children:[e.jsx(Se,{isCreate:h,setIsCreate:u,setIsFilter:T,setStatus:b}),e.jsxs("div",{className:te.timeTable__table,children:[e.jsx(Ie,{data:o,setIsChange:_,loading:m,setStatus:b}),e.jsx(xe,{setCurrentTableData:n,users:N,currentPage:i,pageSize:l,onPageChange:C=>{c(C)}})]}),e.jsx(qe,{classInput:a,active:p?!1:h,setActive:u,onSubmit:O,loading:m}),e.jsx(Fe,{classInput:a,active:p?!1:j,setActive:_,onSubmit:H,loading:m,onDelete:J}),e.jsx(ge,{type:"danger",active:y,setActive:L,onClick:V})]})};export{Bs as TimeTableListPage,zs as timeTableListSlice};
