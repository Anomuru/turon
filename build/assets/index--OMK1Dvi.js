import{l as w,n as o,o as V,K as Z,r as n,j as e,B as F,D as z,p as B,T as R,m as ee,u as te,A as O,h as E}from"./index-Cux8sda1.js";import"./userProfileSlice-BflEK4KO.js";import{g as se,b as ne,a as ae,f as ce,G as re}from"./groupsAttendanceSlice-DmRNDpcI.js";import{getDeletedGroupsData as de,DeletedGroups as oe}from"./index-DZw0Rq80.js";import{getSearchValue as le}from"./index-Dvh1lTlU.js";import{GroupsFilter as ie}from"./index-B2N1RcrZ.js";import{P as ue}from"./pagination-Cj0p_t2O.js";import{M as he}from"./MultiPage-CgDPt1S_.js";import{G as It}from"./groupCreatePage-CCiIRi8f.js";import{M as I}from"./modal-BR27MEf1.js";import{f as _e,g as me}from"./groupsAttendanceThunk-Do8hgWLE.js";import{F as pe}from"./form-C3mZZqBW.js";import{T as je}from"./textArea-1604NtUh.js";import{u as xe}from"./index.esm-DQmSsb0O.js";import"./user_image-CruVt77w.js";import"./switch-sjHY-EbU.js";import"./index-B-IQsIPc.js";import"./teacherParseSlice-z7KSx3F7.js";import"./teacherThunk-qU_2Y3xX.js";import"./index-CO9axSa1.js";import"./oftenUsedSelector-B4R2CTqR.js";import"./filters.module-C8GjSCwu.js";import"./link-B95gzaLk.js";import"./multiPageSlice-CecU3CKU.js";import"./index-sxu4Z6A5.js";import"./studentsSelector-TVQxHXsm.js";import"./alertSlice-XeBTN8B3.js";import"./index-Dyh4sQR2.js";import"./editableCard-BNSd-vHU.js";import"./cross-BXlnQeE0.js";import"./studentsSlice-JQcNq_2O.js";import"./confirmModal-DiNALKc8.js";import"./workerSelect-N9ju4zO7.js";import"./Transition-CosWKtpf.js";import"./roomsSelectors-Dutms6Wd.js";import"./filterRoomsSlice-ClpK4_Fa.js";import"./room_image-CsXp1EfD.js";import"./radio-c1ywR2KC.js";const fe=l=>l.groupAttendanceSlice.attendance,ge=l=>l.groupAttendanceSlice.attendanceList,be=l=>l.groupAttendanceSlice.loading,Se="_deletedGroups_1wcfg_1",ve="_mainContainer_filterPanelBox_1wcfg_4",Ce="_table_1wcfg_9",D={deletedGroups:Se,mainContainer_filterPanelBox:ve,table:Ce},Tt=()=>{const l=w(),k=o(se),h=o(ne),j=o(de),y=o(ae),{id:N}=o(V),i=N,G=o(Z),[_,M]=n.useState([]),[m,x]=n.useState(!1),[f,P]=n.useState(!1),[S,r]=n.useState(!1),a=o(le);let p=n.useMemo(()=>50,[]);const[A,g]=n.useState([]),[b,v]=n.useState(1),T=n.useMemo(()=>{const C=S?h?.slice():k?.slice();return v(1),a?C.filter(L=>L.name?.toLowerCase().includes(a.toLowerCase())):C},[k,v,a,S,h]);n.useEffect(()=>{M(j)},[j]),n.useEffect(()=>{i&&l(ce({userBranchId:i}))},[i]);const $=[{name:"Guruhlar",type:"groups"}];return e.jsx(he,{types:$,page:"groups",children:e.jsxs("div",{className:D.deletedGroups,children:[e.jsxs("div",{className:D.mainContainer_filterPanelBox,children:[e.jsx(F,{status:"filter",extraClass:D.extraCutClassFilter,onClick:()=>x(!m),type:"filter",children:"Filter"}),e.jsx(F,{type:"login",status:"timeTable",extraClass:D.extraCutClassFilter,onClick:()=>x(!0),children:"Time Table"})]}),y?e.jsx(z,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:D.table,children:[e.jsx("h2",{children:f?G.name==="center"?"Deleted Groups":"Deleted Classes":G.name==="center"?"Groups":"Classes"}),f?e.jsx(oe,{currentTableData:A}):e.jsx(re,{currentTableData:A})]}),e.jsx(ue,{setCurrentTableData:g,users:T,setCurrentPage:v,currentPage:b,pageSize:p,onPageChange:C=>{v(C)},type:"custom"})]}),e.jsx(ie,{setIsFilter:r,activeSwitch:f,setActiveSwitch:P,setActive:x,active:m})]})})},ke="_attendance_1jo1b_1",ye="_attendance_end_1jo1b_4",Ne="_attendance_end_select_1jo1b_8",Ge="_attendance_header_1jo1b_15",Me="_attendance_icon_1jo1b_28",Ae="_attendance_check_1jo1b_31",De="_attendance_times_1jo1b_35",Pe="_attendance_plus_1jo1b_62",Fe="_attendanceModal_1jo1b_89",Te="_attendanceModal_header_1jo1b_92",$e="_select_1jo1b_98",Le="_attendedModal_1jo1b_102",qe="_checkedStudents__item_1jo1b_108",Ie="_infoStudent_1jo1b_113",Be="_typeChecked_1jo1b_119",we="_green_1jo1b_129",Oe="_red_1jo1b_132",Ee="_info_1jo1b_113",Ve="_button_1jo1b_140",ze="_absent_1jo1b_144",Re="_text_1jo1b_151",He="_reason_1jo1b_161",Je="_check_1jo1b_108",Ke="_th_1jo1b_174",Ue="_popup_1jo1b_177",s={attendance:ke,attendance_end:ye,attendance_end_select:Ne,attendance_header:Ge,attendance_icon:Me,attendance_check:Ae,attendance_times:De,attendance_plus:Pe,attendanceModal:Fe,attendanceModal_header:Te,select:$e,attendedModal:Le,checkedStudents__item:qe,infoStudent:Ie,typeChecked:Be,green:we,red:Oe,info:Ee,button:Ve,absent:ze,text:Re,reason:He,check:Je,th:Ke,popup:Ue},$t=()=>{const[l,k]=n.useState(!1),[h,j]=n.useState(!1),[y,N]=n.useState(null),[i,G]=n.useState(null),_=o(ge),M=o(be),{id:m}=o(V),x=w();n.useEffect(()=>{x(_e(m))},[]);const f=r=>{if(r)return r?.map(a=>{if(a.status===!0)return e.jsx("td",{className:"date true",children:e.jsx("i",{style:{color:"green",fontSize:"3rem"},className:" fas fa-check"})});if(a.status===!1)return e.jsx("td",{children:e.jsxs("div",{className:s.th,children:[e.jsx("i",{className:`fas fa-times ${s.check}`}),a.reason?e.jsx("div",{className:s.popup,children:a.reason}):null]})});if(a.status==="")return e.jsx("td",{className:"date true"})})},S=_?.students?.students?.map((r,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:a+1}),e.jsxs("td",{children:[r?.name," ",r?.surname]}),f(r.days)]}));return e.jsxs("div",{className:s.attendance,children:[e.jsxs("div",{className:s.attendance_header,children:[e.jsx("h2",{children:"Davomat "}),e.jsxs("div",{className:s.attendance_end,children:[e.jsxs("div",{className:s.attendance_end_select,children:[e.jsx(B,{extraClass:s.select,options:_?.students?.years?.map(r=>r?.year),onChangeOption:G,defaultValue:_?.students?.years[0]?.year}),i?e.jsx(B,{extraClass:s.select,options:_?.students?.years?.filter(r=>r?.year===+i)[0]?.month,onChangeOption:N,defaultValue:_?.students?.years[0]?.month}):null]}),e.jsx("div",{onClick:()=>j(!h),className:`${s.attendance_plus} fa fa-plus`})]})]}),e.jsx("div",{children:e.jsxs(R,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism Familya"}),_?.students?.days.map(r=>e.jsx("th",{children:r}))]})}),e.jsx("tbody",{children:M?e.jsx(z,{}):S})]})}),e.jsx(Ye,{active:h,setActive:j})]})},Ye=({active:l,setActive:k})=>{const{id:h}=ee(),j=w(),{request:y}=te(),[N,i]=n.useState(!1),[G,_]=n.useState(""),[M,m]=n.useState(!1),[x,f]=n.useState(),{register:P,handleSubmit:S,setValue:r}=xe(),[a,p]=n.useState([]);n.useEffect(()=>{j(me(h))},[]);const A=h,g=o(fe),[b,v]=n.useState(null),T=t=>{v(t);const d={date:`${g.month_number}-${t}`};y(`${O}Attendance/school-to-attend-days/${A}/`,"POST",JSON.stringify(d),E()).then(c=>{p(c.students)}).catch(c=>{console.log(c)})},$=t=>{p(d=>d.map(c=>c.id===t?{...c,attended:!0,typeChecked:"yes",reason:"",scores:{}}:c))},C=()=>a?.length>0?a?.map((t,d)=>{if(!t.attended)return e.jsxs("tr",{children:[e.jsx("td",{children:d+1}),e.jsxs("td",{children:[t?.name," ",t?.surname]}),e.jsx("td",{children:e.jsxs("div",{className:s.attendance_icon,children:[e.jsx("i",{onClick:()=>$(t?.id),className:`${s.attendance_check} fa fa-check`}),e.jsx("div",{onClick:()=>{m(!0),f(t.id)},className:"check__btn no",children:e.jsx("i",{className:`${s.attendance_times} fa fa-times`})})]})})]})}):e.jsxs(e.Fragment,{children:[e.jsx("td",{}),e.jsxs("td",{children:[" ",b?"Bu kunda hamma studentlar davomat qilingan":"Studentlar yo'q (kun tanlang)"]})]}),L=t=>{p(d=>d.map(c=>c.id===t?{...c,attended:!1}:c))},H=n.useCallback(()=>a?.length>=0?a.map(t=>{if(t.attended)return e.jsxs("div",{className:s.checkedStudents__item,onClick:()=>L(t.id),children:[e.jsxs("div",{className:s.infoStudent,children:[e.jsxs("div",{className:s.info,children:[e.jsx("span",{children:t.name}),e.jsx("span",{children:t.surname})]}),e.jsx("div",{className:s.typeChecked,children:t.typeChecked==="yes"?e.jsx("i",{className:`fas fa-plus-circle ${s.green} `}):e.jsx("i",{className:`fas fa-minus-circle ${s.red}`})})]}),t.reason?e.jsx("div",{className:s.reason,children:t.reason}):null]})}):e.jsx("h1",{children:"Studentlar yoq"}),[a]),J=({id:t,requestType:d,requestMsg:c})=>{p(q=>q.map(u=>t===u.id?{...u,requestType:d,requestMsg:c}:u))},K=t=>{r("reason",""),p(d=>d.map(c=>c.id===x?{...c,attended:!0,typeChecked:"no",reason:t.reason,date:{day:b},scores:{}}:c)),m(!1)},U=t=>{t.preventDefault(),a.map(d=>{if(d.attended){const c={date:`${g.month_number}-${b}`,students:[{...d,status:!d.reason}],group:Number(A),teacher:g.teachers},q=c?.students?.map(u=>u.id);J({id:d.id,requestType:"loading"}),y(`${O}Attendance/to_attend_school/${q}/`,"POST",JSON.stringify(c),E()).then(u=>{p(Q=>Q.filter(X=>X.id!==u.id)),i(!1)}).catch(u=>{console.log(u,"err")})}})},Y=C(),W=H();return e.jsxs(e.Fragment,{children:[e.jsxs(I,{active:l,setActive:k,children:[e.jsxs("div",{className:s.attendanceModal,children:[e.jsx("h2",{children:g?.month}),e.jsxs("div",{className:s.attendanceModal_header,children:[e.jsx(B,{extraClass:s.select,options:g?.weekdays,onChangeOption:T,defaultValue:b}),e.jsx(F,{onClick:()=>i(!0),children:"Davomat qilinganlar"})]})]}),e.jsx("div",{children:e.jsxs(R,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Ism Familiya"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:Y})]})})]}),e.jsxs(I,{active:N,setActive:i,children:[e.jsx("h2",{className:s.attended_title,children:"Davomat qilinganlar"}),e.jsxs("div",{className:s.attendedModal,children:[e.jsx("div",{className:"checkedStudents",children:a?.filter(t=>t?.attended)?.length===0?e.jsx("h1",{children:"Studentlar davomat qilinmagan"}):null}),W,a?.filter(t=>t?.attended)?.length===0?null:e.jsx(F,{extraClass:s.button,type:b?"":"disabled",onClick:U,children:"Kritish"})]})]}),e.jsxs(I,{id:"1",active:M,setActive:m,children:[e.jsxs("div",{className:s.text,children:["Izoh qoldirish ",e.jsx("br",{})," ",e.jsx("div",{children:"( student kemaganligi haqida )"})," "]}),e.jsx("div",{className:s.absent,children:e.jsx(pe,{onSubmit:S(K),children:e.jsx(je,{register:P,name:"reason",id:"comment"})})})]})]})};export{$t as GroupAttendance,It as GroupCreatePage,Tt as GroupsPage};
