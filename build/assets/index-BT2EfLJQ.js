import{j as e,d as de,T as q,r as t,u as O,be as fe,Q as ee,b as ge,n as oe,a as u,g as ie,h as te,A as M,i as $,ag as Se,bf as Ce,bg as ve,a7 as Te,B as D,z as R,bh as ye,I as Ne,R as ke,a4 as Be,f as Ge,L as Fe,a6 as Ae,bi as Ie,a8 as W,S as U,a9 as Pe,aa as De,ab as ze,bj as Me,bk as $e,F as we,ad as Le}from"./index-DOfOZKEd.js";import{b as Ee,g as Re,c as qe,a as Oe,d as He,G as Ve}from"./groupsList-CzBMRQI3.js";import{g as ue}from"./searchSelector-B3qtoac4.js";import{T as We,a as Ue}from"./teachers-D35-71qq.js";import{P as he}from"./pagination-ajK0EmM0.js";import{a as Je,b as Ke,c as Ye,d as Qe,G as Xe,e as Ze,f as et}from"./groupTimeTableForm-DLjSuQGR.js";import{a as tt}from"./roomsSelectors-BrI_i2qA.js";import{R as st}from"./radio-D8KPMsXX.js";import"./editableCard-CFY1EtAX.js";import"./groupProfileRating-BPTvnUHy.js";import"./confirmModal-ARekbj1x.js";import"./alert-DpBPv_wf.js";const X={},at=({currentTableData:a,loadingWithFilter:n})=>e.jsx("div",{className:X.deletedGroups,children:n?e.jsx(de,{}):e.jsx("div",{className:X.table,children:e.jsxs(q,{extraClass:X.table__head,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Guruh Nomi"}),e.jsx("th",{children:"Full name"}),e.jsx("th",{children:"Kurs Turi"}),e.jsx("th",{children:"Guruh narxi"})]})}),e.jsx("tbody",{children:a.map((o,p)=>e.jsxs("tr",{onClick:()=>navigate(`groupInfo/${o?.id}`),children:[e.jsx("td",{children:p+1}),e.jsx("td",{children:o?.name}),e.jsx("td",{children:o?.teacher}),e.jsx("td",{children:o?.students?.length}),e.jsx("td",{children:o?.price?o.price:"Sinfga hali narx belgilanmagan"})]}))})]})})}),nt=a=>a.deletedGroupsSlice?.data,rt="_mainContainer_1bjz4_1",ct="_mainContainer__container_1bjz4_4",lt="_mainContainer_buttonPanelBox_1bjz4_7",dt="_mainContainer_buttonPanelBox_leftCreateButton_1bjz4_10",ot="_mainContainer_filterPanelBox_1bjz4_13",it="_timeTable_1bjz4_17",ut="_mainContainer_filterPanelBox_leftFilterRadioGroupBox_1bjz4_20",ht="_activeFilter_1bjz4_25",_t="_mainError_1bjz4_29",xt="_table_1bjz4_37",jt="_table__box_1bjz4_48",mt="_table__container_1bjz4_59",pt="_table__inner_1bjz4_79",bt="_wrapper_1bjz4_83",ft="_studentBoxHeader_1bjz4_90",gt="_studentBoxTable_1bjz4_97",St="_studentBoxTable__inner_1bjz4_116",Ct="_studentBoxTable__input_1bjz4_121",vt="_status_1bjz4_129",Tt="_status__inner_1bjz4_138",d={mainContainer:rt,mainContainer__container:ct,mainContainer_buttonPanelBox:lt,mainContainer_buttonPanelBox_leftCreateButton:dt,mainContainer_filterPanelBox:ot,timeTable:it,mainContainer_filterPanelBox_leftFilterRadioGroupBox:ut,activeFilter:ht,mainError:_t,table:xt,table__box:jt,table__container:mt,table__inner:pt,wrapper:bt,studentBoxHeader:ft,studentBoxTable:gt,studentBoxTable__inner:St,studentBoxTable__input:Ct,status:vt,status__inner:Tt},le=[{name:"studying",label:"Students"},{name:"teachers",label:"Teachers"}],bs=()=>{t.useEffect(()=>{P(fe())},[]);const{request:a}=te(),{"*":n}=ee();localStorage.getItem("theme"),ge();const{register:o,handleSubmit:p}=oe();u(ie),u(tt);const C=u(Je),y=u(Ke),f=u(Ye);u(Qe);const g=u(ue),[b,S]=t.useState(),[j,A]=t.useState(),[I,F]=t.useState([]),[B,h]=t.useState([]),[l,T]=t.useState(null),[N,G]=t.useState([]),[m,k]=t.useState(""),J=(s,_)=>{if(!l)T(_);else if(l!==_)return T(_),null;F(L=>L.filter(Q=>Q===s)[0]?L.filter(Q=>Q!==s):[...L,s])};t.useEffect(()=>{l&&a(`${M}Subjects/level-for-subject/${l}/`,"GET",null,$()).then(s=>{P(Se(s))}).catch(s=>console.log(s))},[l]);const[se,ae]=t.useState(!1),[ne,re]=t.useState([]),[z,K]=t.useState(le[0].name),[H,V]=t.useState(!1),[ce,r]=t.useState(!1),[x,i]=t.useState([]),[w,v]=t.useState(1);let Y=t.useMemo(()=>20,[]);const P=O(),_e=s=>{K(s)},xe=t.useMemo(()=>{const s=y?.slice();return v(1),g?s.filter(_=>_?.user?.name?.toLowerCase().includes(g.toLowerCase())||_?.user?.surname?.toLowerCase().includes(g.toLowerCase())):s},[y,g]);t.useEffect(()=>{n&&P(Ce({id:n})),a(`${M}TimeTable/week_days/`,"GET",null,$()).then(s=>{S(s?.days?.map(_=>({..._,name:_.name_uz})))}).catch(s=>console.log(s)),a(`${M}Group/course_types/`,"GET",null,$()).then(s=>{P(ve(s))}).catch(s=>console.log(s)),P(Te())},[n]);const je=s=>s.map((_,L)=>e.jsx(e.Fragment,{children:e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{children:L+1}),e.jsxs("td",{children:[_.user.surname," ",_.user.name]}),e.jsx("td",{children:_.user.age})]})})})),me=()=>C[j]?.students.map((s,_)=>e.jsxs("tr",{children:[e.jsx("td",{children:_+1}),e.jsxs("td",{children:[s.user.surname," ",s.user.name]}),e.jsx("td",{children:s.user.age}),e.jsx("td",{children:s.user.registered_date}),e.jsx("td",{children:s.user.comment}),e.jsx("td",{children:s.extra_info.status?e.jsxs("div",{className:d.studentBoxTable__inner,children:[e.jsx("div",{className:d.status,children:e.jsx("div",{className:d.status__inner})}),e.jsx(Ne,{type:"checkbox",extraClassName:d.studentBoxTable__input,onChange:()=>J(s.id,C[j]?.id)})]}):null})]})),pe=()=>C.map((s,_)=>s.subject_status?e.jsxs("div",{onClick:()=>{V(!H),A(_)},className:d.table__box,children:[e.jsx("h2",{className:d.table__title,children:s.name??"Ingliz tili"}),e.jsx("div",{className:d.table__container,children:e.jsxs(q,{extraClass:d.table__inner,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"№"}),e.jsx("th",{children:"Full name"}),e.jsx("th",{children:"Age"})]})}),je(s.students)]})})]}):null),be=t.useCallback(s=>{h([s])},[B]);return e.jsxs("div",{children:[e.jsxs("div",{className:d.mainContainer,children:[e.jsx("div",{className:d.mainContainer_buttonPanelBox,children:e.jsxs("div",{className:d.mainContainer_buttonPanelBox_leftCreateButton,children:[e.jsx(D,{onClick:()=>k("groupCreate"),type:z==="studying"?m==="groupAdd"?"filter":"btn":"filter",extraClass:d.extraCutClass,children:"Create group"}),e.jsx(D,{onClick:()=>k("groupAdd"),type:m==="groupAdd"?"btn":"filter",extraClass:d.noneBackground,children:"Add group"})]})}),e.jsx("div",{className:d.mainContainer_filterPanelBox,children:e.jsx(D,{extraClass:d.timeTable,onClick:()=>k("timeTable"),status:"timeTable",type:"login",children:"Time Table"})}),e.jsx("div",{className:d.mainContainer_filterPanelBox_leftFilterRadioGroupBox,children:le.map((s,_)=>e.jsx(st,{onChange:()=>_e(s.name),checked:z===s.name,extraClasses:z===s.name?d.activeFilter:null,children:s.label},_))})]}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:d.mainError,children:f?.rooms&&f.rooms[0]?e.jsx("h1",{children:f.rooms[0]}):null}),e.jsx("div",{className:d.mainContainer,children:z==="studying"?e.jsx("div",{className:d.table,children:pe()}):e.jsxs("div",{className:d.mainContainer__container,children:[e.jsx(We,{data:x,setSelect:be,select:B}),e.jsx(he,{setCurrentTableData:i,users:xe,setCurrentPage:v,currentPage:w,pageSize:Y,onPageChange:s=>{v(s)},type:"custom"})]})})]}),e.jsx(R,{setActive:V,active:H,children:e.jsxs("div",{className:d.wrapper,children:[e.jsx("div",{className:d.studentBox,children:e.jsxs("div",{className:d.studentBoxHeader,children:[e.jsx("h1",{children:C[j]?.name}),e.jsx(ye,{})]})}),e.jsx("div",{className:d.studentBoxTable,children:e.jsxs(q,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Ism Familiya"}),e.jsx("th",{children:"Yosh"}),e.jsx("th",{children:"Reg.sana"}),e.jsx("th",{children:"Koment"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:me()})]})})]})}),e.jsx(Xe,{setActive:k,active:m==="timeTable",selectTime:N,setSelectTime:G,weekDays:b}),e.jsx(Ze,{setActive:k,active:m==="groupAdd"}),e.jsx(et,{setActive:k,active:m==="groupCreate",selectedStudents:I,selectedTeachers:B,selectedSubjectId:l,selectedTime:N})]})},yt=ke.memo(({active:a,setActive:n,setIsFilter:o,activeSwitch:p,setActiveSwitch:C})=>{const y=localStorage.getItem("selectedTeacher");u(Be);const f=u(Ue),[g,b]=t.useState(y),S=O(),j=localStorage.getItem("branchId");return u(Ee),localStorage.setItem("selectedTeacher",g),localStorage.setItem("selectedSwitch",`${p}`),t.useEffect(()=>{S(Ge({teacherId:g,userBranchId:j,deleted:p})),o(!0)},[g,p]),t.useEffect(()=>{j&&S(Fe({userBranchId:j}))},[j]),t.useEffect(()=>{S(Ae()),S(Ie())},[]),e.jsx(R,{active:a,setActive:n,children:e.jsxs("div",{className:W.filter,children:[e.jsx("h1",{children:"Filter"}),e.jsxs("div",{className:W.filter__container,children:[e.jsx(U,{title:"Teacher",options:[{name:"Hamma",id:"all"},...f],extraClass:W.filter__select,onChangeOption:b,defaultValue:y}),e.jsxs("div",{className:W.filter__switch,children:[e.jsx("p",{children:"O’chirilgan"}),e.jsx(Pe,{activeSwitch:p,onChangeSwitch:C})]})]})]})})}),Z=De("filterGroups/fetchFilteredGroups",async a=>{const{request:n}=te();return await n(`${M}`,"POST",JSON.stringify(a),$())}),Nt={groups:null,teacherId:null,subjectId:null,typeId:null,isDelete:!1,loading:!1,error:null},kt=ze({name:"filterGroups",initialState:Nt,reducers:{getTeacherId:(a,n)=>{a.teacherId=n.payload},getSubjectId:(a,n)=>{a.subjectId=n.payload},getTypeId:(a,n)=>{a.typeId=n.payload},getIsDelete:(a,n)=>{a.isDelete=n.payload}},extraReducers:a=>a.addCase(Z.pending,n=>{n.loading=!0,n.error=null}).addCase(Z.fulfilled,(n,o)=>{n.groups=o.payload,n.loading=!1,n.error=null}).addCase(Z.rejected,(n,o)=>{n.loading=!1,n.error=o.payload??null})}),{getTeacherId:fs,getSubjectId:gs,getTypeId:Ss,getIsDelete:Cs}=kt.actions,Bt="_deletedGroups_1wcfg_1",Gt="_mainContainer_filterPanelBox_1wcfg_4",Ft="_table_1wcfg_9",E={deletedGroups:Bt,mainContainer_filterPanelBox:Gt,table:Ft},vs=()=>{const a=localStorage.getItem("selectedSwitch");O();const n=u(Re),o=u(qe),p=u(nt);u(Oe);const C=u(He);u(ie);const[y,f]=t.useState([]),[g,b]=t.useState(!1),[S,j]=t.useState(a==="true"),[A,I]=t.useState(!1),F=u(ue);let B=t.useMemo(()=>50,[]);const[h,l]=t.useState([]),[T,N]=t.useState(1),G=t.useMemo(()=>{const m=o?.slice();return N(1),F?m.filter(k=>k.name?.toLowerCase().includes(F.toLowerCase())):m},[n,N,F,A,o]);return t.useEffect(()=>{f(p)},[p]),e.jsxs("div",{className:E.deletedGroups,children:[e.jsxs("div",{className:E.mainContainer_filterPanelBox,children:[e.jsx(D,{status:"filter",extraClass:E.extraCutClassFilter,onClick:()=>b(!g),type:"filter",children:"Filter"}),e.jsx(D,{type:"login",status:"timeTable",extraClass:E.extraCutClassFilter,onClick:()=>b(!0),children:"Time Table"})]}),e.jsxs("div",{className:E.table,children:[e.jsx("h2",{children:S?"Deleted Classes":"Classes"}),S?e.jsx(at,{loadingWithFilter:C,currentTableData:h}):e.jsx(Ve,{loadingWithFilter:C,currentTableData:h})]}),e.jsx(he,{setCurrentTableData:l,users:G,setCurrentPage:N,currentPage:T,pageSize:B,onPageChange:m=>{N(m)},type:"custom"}),e.jsx(yt,{setIsFilter:I,activeSwitch:S,setActiveSwitch:j,setActive:b,active:g})]})},At=a=>a.groupAttendance?.attendance,It=a=>a.groupAttendance?.attendanceList,Pt=a=>a.groupAttendance?.loading,Dt="_attendance_1jo1b_1",zt="_attendance_end_1jo1b_4",Mt="_attendance_end_select_1jo1b_8",$t="_attendance_header_1jo1b_15",wt="_attendance_icon_1jo1b_28",Lt="_attendance_check_1jo1b_31",Et="_attendance_times_1jo1b_35",Rt="_attendance_plus_1jo1b_62",qt="_attendanceModal_1jo1b_89",Ot="_attendanceModal_header_1jo1b_92",Ht="_select_1jo1b_98",Vt="_attendedModal_1jo1b_102",Wt="_checkedStudents__item_1jo1b_108",Ut="_infoStudent_1jo1b_113",Jt="_typeChecked_1jo1b_119",Kt="_green_1jo1b_129",Yt="_red_1jo1b_132",Qt="_info_1jo1b_113",Xt="_button_1jo1b_140",Zt="_absent_1jo1b_144",es="_text_1jo1b_151",ts="_reason_1jo1b_161",ss="_check_1jo1b_108",as="_th_1jo1b_174",ns="_popup_1jo1b_177",c={attendance:Dt,attendance_end:zt,attendance_end_select:Mt,attendance_header:$t,attendance_icon:wt,attendance_check:Lt,attendance_times:Et,attendance_plus:Rt,attendanceModal:qt,attendanceModal_header:Ot,select:Ht,attendedModal:Vt,checkedStudents__item:Wt,infoStudent:Ut,typeChecked:Jt,green:Kt,red:Yt,info:Qt,button:Xt,absent:Zt,text:es,reason:ts,check:ss,th:as,popup:ns},Ts=()=>{const[a,n]=t.useState(!1),[o,p]=t.useState(!1),[C,y]=t.useState(null),[f,g]=t.useState(null),b=u(It),S=u(Pt),{id:j}=ee(),A=O();t.useEffect(()=>{A(Me(j))},[]);const I=h=>{if(h)return h?.map(l=>{if(l.status===!0)return e.jsx("td",{className:"date true",children:e.jsx("i",{style:{color:"green",fontSize:"3rem"},className:" fas fa-check"})});if(l.status===!1)return e.jsx("td",{children:e.jsxs("div",{className:c.th,children:[e.jsx("i",{className:`fas fa-times ${c.check}`}),l.reason?e.jsx("div",{className:c.popup,children:l.reason}):null]})});if(l.status==="")return e.jsx("td",{className:"date true"})})},B=b?.students?.students?.map((h,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsxs("td",{children:[h?.name," ",h?.surname]}),I(h.days)]}));return e.jsxs("div",{className:c.attendance,children:[e.jsxs("div",{className:c.attendance_header,children:[e.jsx("h2",{children:"Davomat "}),e.jsxs("div",{className:c.attendance_end,children:[e.jsxs("div",{className:c.attendance_end_select,children:[e.jsx(U,{extraClass:c.select,options:b?.students?.years?.map(h=>h?.year),onChangeOption:g,defaultValue:b?.students?.years[0]?.year}),f?e.jsx(U,{extraClass:c.select,options:b?.students?.years?.filter(h=>h?.year===+f)[0]?.month,onChangeOption:y,defaultValue:b?.students?.years[0]?.month}):null]}),e.jsx("div",{onClick:()=>p(!o),className:`${c.attendance_plus} fa fa-plus`})]})]}),e.jsx("div",{children:e.jsxs(q,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism Familya"}),b?.students?.days.map(h=>e.jsx("th",{children:h}))]})}),e.jsx("tbody",{children:S?e.jsx(de,{}):B})]})}),e.jsx(rs,{active:o,setActive:p})]})},rs=({active:a,setActive:n})=>{const{id:o}=ee(),p=O(),{request:C}=te(),[y,f]=t.useState(!1),[g,b]=t.useState(""),[S,j]=t.useState(!1),[A,I]=t.useState(),{register:F,handleSubmit:B,setValue:h}=oe(),[l,T]=t.useState([]);t.useEffect(()=>{p($e(o))},[]);const N=o,G=u(At),[m,k]=t.useState(null),J=r=>{k(r);const x={date:`${G.month_number}-${r}`};C(`${M}Attendance/school-to-attend-days/${N}/`,"POST",JSON.stringify(x),$()).then(i=>{T(i.students)}).catch(i=>{console.log(i)})},se=r=>{T(x=>x.map(i=>i.id===r?{...i,attended:!0,typeChecked:"yes",reason:"",scores:{}}:i))},ae=()=>l?.length>0?l?.map((r,x)=>{if(!r.attended)return e.jsxs("tr",{children:[e.jsx("td",{children:x+1}),e.jsxs("td",{children:[r?.name," ",r?.surname]}),e.jsx("td",{children:e.jsxs("div",{className:c.attendance_icon,children:[e.jsx("i",{onClick:()=>se(r?.id),className:`${c.attendance_check} fa fa-check`}),e.jsx("div",{onClick:()=>{j(!0),I(r.id)},className:"check__btn no",children:e.jsx("i",{className:`${c.attendance_times} fa fa-times`})})]})})]})}):e.jsxs(e.Fragment,{children:[e.jsx("td",{}),e.jsxs("td",{children:[" ",m?"Bu kunda hamma studentlar davomat qilingan":"Studentlar yo'q (kun tanlang)"]})]}),ne=r=>{T(x=>x.map(i=>i.id===r?{...i,attended:!1}:i))},re=t.useCallback(()=>l?.length>=0?l.map(r=>{if(r.attended)return e.jsxs("div",{className:c.checkedStudents__item,onClick:()=>ne(r.id),children:[e.jsxs("div",{className:c.infoStudent,children:[e.jsxs("div",{className:c.info,children:[e.jsx("span",{children:r.name}),e.jsx("span",{children:r.surname})]}),e.jsx("div",{className:c.typeChecked,children:r.typeChecked==="yes"?e.jsx("i",{className:`fas fa-plus-circle ${c.green} `}):e.jsx("i",{className:`fas fa-minus-circle ${c.red}`})})]}),r.reason?e.jsx("div",{className:c.reason,children:r.reason}):null]})}):e.jsx("h1",{children:"Studentlar yoq"}),[l]),z=({id:r,requestType:x,requestMsg:i})=>{T(w=>w.map(v=>r===v.id?{...v,requestType:x,requestMsg:i}:v))},K=r=>{h("reason",""),T(x=>x.map(i=>i.id===A?{...i,attended:!0,typeChecked:"no",reason:r.reason,date:{day:m},scores:{}}:i)),j(!1)},H=r=>{r.preventDefault(),l.map(x=>{if(x.attended){const i={date:`${G.month_number}-${m}`,students:[{...x,status:!x.reason}],group:Number(N),teacher:G.teachers},w=i?.students?.map(v=>v.id);z({id:x.id,requestType:"loading"}),C(`${M}Attendance/to_attend_school/${w}/`,"POST",JSON.stringify(i),$()).then(v=>{T(Y=>Y.filter(P=>P.id!==v.id)),f(!1)}).catch(v=>{console.log(v,"err")})}})},V=ae(),ce=re();return e.jsxs(e.Fragment,{children:[e.jsxs(R,{active:a,setActive:n,children:[e.jsxs("div",{className:c.attendanceModal,children:[e.jsx("h2",{children:G?.month}),e.jsxs("div",{className:c.attendanceModal_header,children:[e.jsx(U,{extraClass:c.select,options:G?.weekdays,onChangeOption:J,defaultValue:m}),e.jsx(D,{onClick:()=>f(!0),children:"Davomat qilinganlar"})]})]}),e.jsx("div",{children:e.jsxs(q,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Ism Familiya"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:V})]})})]}),e.jsxs(R,{active:y,setActive:f,children:[e.jsx("h2",{className:c.attended_title,children:"Davomat qilinganlar"}),e.jsxs("div",{className:c.attendedModal,children:[e.jsx("div",{className:"checkedStudents",children:l?.filter(r=>r?.attended)?.length===0?e.jsx("h1",{children:"Studentlar davomat qilinmagan"}):null}),ce,l?.filter(r=>r?.attended)?.length===0?null:e.jsx(D,{extraClass:c.button,type:m?"":"disabled",onClick:H,children:"Kritish"})]})]}),e.jsxs(R,{id:"1",active:S,setActive:j,children:[e.jsxs("div",{className:c.text,children:["Izoh qoldirish ",e.jsx("br",{})," ",e.jsx("div",{children:"( student kemaganligi haqida )"})," "]}),e.jsx("div",{className:c.absent,children:e.jsx(we,{onSubmit:B(K),children:e.jsx(Le,{register:F,name:"reason",id:"comment"})})})]})]})};export{Ts as GroupAttendance,bs as GroupCreatePage,vs as GroupsPage};
