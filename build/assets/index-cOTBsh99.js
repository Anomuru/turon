import{a as b,r as t,V as T,n as F,u as L,h as M,A as N,i as A,j as e,d as R,T as D,W as q,X as B,Y as V,Z as H,o as Y,_ as G,$ as K,a0 as U,a1 as W,D as X,a2 as Z,B as z,S as J}from"./index-Dts_nlzx.js";import{g as Q,a as ee,b as te,c as se,p as ae,d as oe,e as re,y as ce,f as de,T as ne}from"./taskManagerRight-D91V-vBt.js";import{C as le}from"./confirmModal-BY7I8EU1.js";const _e="_container_e3kfj_2",ie="_box_e3kfj_7",he="_box__header_e3kfj_16",xe="_select_e3kfj_23",ue="_box__header_title_e3kfj_26",fe="_box__sides_e3kfj_34",u={container:_e,box:ie,box__header:he,select:xe,box__header_title:ue,box__sides:fe},je="_taskLeft_14ud8_1",be="_taskLeft__header_14ud8_20",ke="_taskLeft__header_box_14ud8_24",me="_taskLeft__header_box_top_14ud8_33",ge="_taskLeft__header_box_count_14ud8_41",Le="_taskLeft__body_14ud8_46",pe="_taskLeft__body_table_14ud8_52",ye="_taskLeft__body_main_14ud8_58",Ce="_taskLeft__body_title_14ud8_66",ve="_taskLeft__body_card_14ud8_69",Se="_taskLeft__body_card_cotainer_14ud8_74",o={taskLeft:je,taskLeft__header:be,taskLeft__header_box:ke,taskLeft__header_box_top:me,taskLeft__header_box_count:ge,taskLeft__body:Le,taskLeft__body_table:pe,taskLeft__body_main:ye,taskLeft__body_title:Ce,taskLeft__body_card:ve,taskLeft__body_card_cotainer:Se},E=t.createContext(null),S=["Tel ko'tardi","Tel ko'tarmadi"],Te=({formatted:s,setTaskType:l,taskType:c})=>{const _=b(Q),i=b(ee),[f,k]=t.useState(null),[h,j]=t.useState(null),d=b(te),[x,m]=t.useState(null),r=T(new Date),[I,y]=t.useState(!1),[w,C]=t.useState(null),{register:De,handleSubmit:Ee,setValue:Ie}=F(),v=b(se),{request:O}=M();L(),t.useEffect(()=>{d&&y(!1)},[d]);const g={red:[],yellow:[],green:[]};v?.forEach(a=>{g[a?.color]&&g[a?.color].push(a)}),t.useEffect(()=>{k(S[0])},[S]);const P=t.useCallback(a=>{y(!0),C(a),O(`${N}Lead/lead_call/${a.id}`,"GET",null,A()).then(n=>{m(n.history)}).catch(n=>{console.log(n)})}),$=t.useMemo(()=>({activeModal:I,setActiveModal:a=>P(a),activeModalItem:w,setActiveModalItem:C,taskType:c}),[]);return e.jsxs("div",{className:o.taskLeft,children:[e.jsxs("div",{className:o.taskLeft__header,children:[r===s&&e.jsxs("div",{onClick:()=>l("progress"),className:o.taskLeft__header_box,style:{background:"rgba(249, 145, 75, 1)"},children:[e.jsxs("div",{className:o.taskLeft__header_box_top,children:[e.jsx("img",{src:ae,alt:""}),e.jsxs("h2",{style:{whiteSpace:"pre-line"},children:["Task ",e.jsx("br",{}),"in Progress"]})]}),e.jsx("div",{className:o.taskLeft__header_box_count,children:i})]}),e.jsxs("div",{className:o.taskLeft__header_box,onClick:()=>l("completed"),style:{background:"rgba(26, 174, 204, 1)"},children:[e.jsxs("div",{className:o.taskLeft__header_box_top,children:[e.jsx("img",{src:oe,alt:""}),e.jsxs("h2",{style:{whiteSpace:"pre-line"},children:["Project",e.jsx("br",{}),"Completed"]})]}),e.jsx("div",{className:o.taskLeft__header_box_count,children:_})]})]}),e.jsx(E.Provider,{value:$,children:e.jsxs("div",{className:o.taskLeft__body,children:[e.jsx("h1",{className:o.taskLeft__body_title,children:c==="completed"?"Completed leads":"Leads"}),d?e.jsx(R,{}):s===r?e.jsx(e.Fragment,{children:e.jsx("div",{className:o.taskLeft__body_main,children:e.jsx("div",{className:o.taskLeft__body_card,children:Object.entries(g).map(([a,n])=>n.length?e.jsx(Me,{taskType:c,items:n,className:o.taskLeft__body_card_cotainer},a+c):null)})})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:o.taskLeft__body_table,children:e.jsxs(D,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism"}),e.jsx("th",{children:"Familiya"}),e.jsx("th",{children:"Kament"}),e.jsx("th",{children:"Tel raqami"}),e.jsx("th",{children:"Tel statusi"}),e.jsx("th",{children:"Yaratilgan sana"})]})}),e.jsx("tbody",{children:v?.map((a,n)=>e.jsxs("tr",{children:[e.jsx("td",{children:n+1}),e.jsx("td",{children:a?.lead?.name}),e.jsx("td",{children:a?.lead?.surname}),e.jsx("td",{children:a?.comment}),e.jsx("td",{children:a?.lead?.phone}),e.jsx("td",{children:a.status===!0?"Tel ko'tardi":"Tel ko'tarilmadi"}),e.jsx("td",{children:a?.lead?.created})]},n))})]})})})]})})]})},Me=({items:s=[],className:l="",taskType:c})=>e.jsxs(D,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"â„–"}),e.jsx("th",{children:"Ism"}),e.jsx("th",{children:"Familiya"}),e.jsx("th",{children:"Telefon nomer"})]})}),e.jsx("tbody",{children:s.map((_,i)=>e.jsx(Ne,{item:_,i},i))})]}),Ne=({item:s,i:l})=>{const[c,_]=t.useState({}),{setActiveModal:i,setActiveModalItem:f,taskType:k}=t.useContext(E),[h,j]=t.useState(!1),{request:d}=M(),x=L(),m=r=>{switch(r){case"red":return`url(${de})`;case"yellow":return`url(${ce})`;case"green":return`url(${re})`;default:return""}},p=()=>{d(`${N}Lead/lead_delete/${s.id}`,"DELETE",null,A()).then(r=>{j(!1),x(q(s.id)),x(B(r.accepted_percentage)),x(V(r.completed)),x(H(r.progressing)),x(Y({type:"success",status:!0,msg:"Muvaffaqiyatli o'chirildi"}))}).catch(r=>{console.log(r)})};return t.useEffect(()=>{_({backImage:m(s?.color),color:s?.color==="green"?"rgba(220, 252, 231, 1)":s.color==="yellow"?"rgba(254, 249, 195, 1)":"rgba(255, 228, 230, 1)"})},[s?.color]),e.jsxs(e.Fragment,{children:[e.jsxs("tr",{style:{background:c.color},children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.surname}),e.jsx("td",{children:s.phone})]}),e.jsx(le,{active:h,setActive:j,onClick:p})]})},Ae={},$e=()=>{const s=L(),l=localStorage.getItem("branchId"),c=b(G),[_,i]=t.useState(new Date),[f,k]=t.useState("all"),[h,j]=t.useState("progress"),d=T(_);return t.useEffect(()=>{s(K({operator_id:f,date:d,branch:l,taskType:h}))},[f,d,h]),t.useEffect(()=>{s(U()),s(W(l))},[]),e.jsx(X,{reducers:Ae,children:e.jsx("div",{className:u.container,children:e.jsxs("div",{className:u.box,children:[e.jsxs("div",{className:u.box__header,children:[e.jsx("h1",{className:u.box__header_title,children:"My Projects"}),e.jsx(Z,{to:"../filteredLeadsList",children:e.jsx(z,{children:"New Leads"})}),e.jsx(J,{defaultValue:f,onChangeOption:k,extraClass:u.select,title:"Operators",options:[...c,{name:"Hammasi",id:"all"}]})]}),e.jsxs("div",{className:u.box__sides,children:[e.jsx(Te,{setTaskType:j,taskType:h,formatted:d}),e.jsx(ne,{selectedDate:_,setSelectedDate:i})]})]})})})};export{$e as AdminTaskManager};
